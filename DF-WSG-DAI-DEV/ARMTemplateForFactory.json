{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "DF-WSG-DAI-DEV"
		},
		"AzureSqlDatabase1_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureSqlDatabase1'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=sql-wsg-dai-dev.database.windows.net;Initial Catalog=SQLDB-WSG-DAI-DEV"
		},
		"Customer_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'Customer'"
		},
		"RestAPI_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'RestAPI'"
		},
		"RestAPI_Date_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'RestAPI_Date'"
		},
		"RestService_Wastedge_WFLEX_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'RestService_Wastedge_WFLEX'"
		},
		"RestService_Wastedge_WSGNSW_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'RestService_Wastedge_WSGNSW'"
		},
		"RestService_Wastedge_WSGVIC_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'RestService_Wastedge_WSGVIC'"
		},
		"WFLEX_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'WFLEX'"
		},
		"WSGNSW_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'WSGNSW'"
		},
		"WSGVIC_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'WSGVIC'"
		},
		"gjrblob_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'gjrblob'"
		},
		"sqltest_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'sqltest'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=sql-wsg-dai-dev.database.windows.net;Initial Catalog=SQLDB-WSG-DAI-DEV"
		},
		"AzureBlobStorage_sawsgdaidev_properties_typeProperties_serviceEndpoint": {
			"type": "string",
			"defaultValue": "https://sawsgdaidev.blob.core.windows.net/"
		},
		"AzureDataLakeStorage1_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://sawsgdaidev.dfs.core.windows.net/"
		},
		"Customer_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://testwww6.wastedge.com/api/rest/customer"
		},
		"Customer_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "WSG\\API"
		},
		"RestAPI_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://www6.wastedge.com/api/rest"
		},
		"RestAPI_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "WSG\\API"
		},
		"RestAPI_Date_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://www6.wastedge.com/api/rest"
		},
		"RestAPI_Date_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "WSG\\API"
		},
		"RestService_Wastedge_WFLEX_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://www6.wastedge.com/api/rest"
		},
		"RestService_Wastedge_WFLEX_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "WFLEX\\API"
		},
		"RestService_Wastedge_WSGNSW_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://www6.wastedge.com/api/rest"
		},
		"RestService_Wastedge_WSGNSW_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "WSGNSW\\API"
		},
		"RestService_Wastedge_WSGVIC_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://www6.wastedge.com/api/rest"
		},
		"RestService_Wastedge_WSGVIC_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "WSG\\API"
		},
		"WFLEX_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://www6.wastedge.com/api/rest"
		},
		"WFLEX_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "WFLEX\\API"
		},
		"WSGNSW_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://www6.wastedge.com/api/rest"
		},
		"WSGNSW_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "WSGNSW\\API"
		},
		"WSGVIC_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://www6.wastedge.com/api/rest"
		},
		"WSGVIC_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "WSG\\API"
		},
		"trigger1_properties_typeProperties_scope": {
			"type": "string",
			"defaultValue": "/subscriptions/5b3ec6fc-8a2e-445b-9899-02846ac57b46/resourceGroups/DEFAULT-EVENTGRID/providers/Microsoft.Storage/storageAccounts/stgwsgalert"
		},
		"trigger2_properties_PL_booking_parameters_pStartDate": {
			"type": "string",
			"defaultValue": "2025-01-01"
		},
		"trigger2_properties_PL_booking_parameters_pEndDate": {
			"type": "string",
			"defaultValue": "2025-01-03"
		},
		"AzureBlobStorage_sawsgdaidev_properties_privateLinkResourceId": {
			"type": "string",
			"defaultValue": "/subscriptions/5b3ec6fc-8a2e-445b-9899-02846ac57b46/resourceGroups/RG-WSG-DAI-DEV/providers/Microsoft.Storage/storageAccounts/sawsgdaidev"
		},
		"AzureBlobStorage_sawsgdaidev_properties_groupId": {
			"type": "string",
			"defaultValue": "blob"
		},
		"pe-sawsgdaidev_properties_privateLinkResourceId": {
			"type": "string",
			"defaultValue": "/subscriptions/5b3ec6fc-8a2e-445b-9899-02846ac57b46/resourceGroups/RG-WSG-DAI-DEV/providers/Microsoft.Storage/storageAccounts/sawsgdaidev"
		},
		"pe-sawsgdaidev_properties_groupId": {
			"type": "string",
			"defaultValue": "dfs"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/PL_Accounts_receivable')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set Start Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "StartDate",
							"value": {
								"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set End Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "EndDATE",
							"value": {
								"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'YYYY-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Debug",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "DEBUG",
							"value": {
								"value": "@concat('vehicle/tip_fee?$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set Start Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set End Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Debug",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI_Date",
								"type": "DatasetReference",
								"parameters": {
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "ar/accounts_receivable",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "accountsreceivable",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "accounts_receivable",
										"type": "Expression"
									},
									"Instance": "vic"
								}
							}
						]
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": true,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['a_code_1']"
										},
										"sink": {
											"name": "a_code_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['a_code_2']"
										},
										"sink": {
											"name": "a_code_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['a_code_3']"
										},
										"sink": {
											"name": "a_code_3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['a_code_4']"
										},
										"sink": {
											"name": "a_code_4",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['a_code_5']"
										},
										"sink": {
											"name": "a_code_5",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['a_code_6']"
										},
										"sink": {
											"name": "a_code_6",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['a_code_7']"
										},
										"sink": {
											"name": "a_code_7",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['a_code_8']"
										},
										"sink": {
											"name": "a_code_8",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['a_code_9']"
										},
										"sink": {
											"name": "a_code_9",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['a_code_10']"
										},
										"sink": {
											"name": "a_code_10",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['adj_org']"
										},
										"sink": {
											"name": "adj_org",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['amt_posted']"
										},
										"sink": {
											"name": "amt_posted",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['bank_name']"
										},
										"sink": {
											"name": "bank_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['BankAccountNo']"
										},
										"sink": {
											"name": "BankAccountNo",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['branch']"
										},
										"sink": {
											"name": "branch",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['check_no']"
										},
										"sink": {
											"name": "check_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['claim_id']"
										},
										"sink": {
											"name": "claim_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['create_date']"
										},
										"sink": {
											"name": "create_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['create_time']"
										},
										"sink": {
											"name": "create_time",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['credit_note_no']"
										},
										"sink": {
											"name": "credit_note_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['cust_number']"
										},
										"sink": {
											"name": "cust_number",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['DDAmount']"
										},
										"sink": {
											"name": "DDAmount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['department']"
										},
										"sink": {
											"name": "department",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['description']"
										},
										"sink": {
											"name": "description",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['drawer']"
										},
										"sink": {
											"name": "drawer",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Exported']"
										},
										"sink": {
											"name": "Exported",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['ExportedDate']"
										},
										"sink": {
											"name": "ExportedDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['ExportedTime']"
										},
										"sink": {
											"name": "ExportedTime",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['ExportedUser']"
										},
										"sink": {
											"name": "ExportedUser",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ExportSuccess']"
										},
										"sink": {
											"name": "ExportSuccess",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['ExternalRef']"
										},
										"sink": {
											"name": "ExternalRef",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['invoice_no']"
										},
										"sink": {
											"name": "invoice_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jrl_no']"
										},
										"sink": {
											"name": "jrl_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['jrnl_source']"
										},
										"sink": {
											"name": "jrnl_source",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ledger_account']"
										},
										"sink": {
											"name": "ledger_account",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['new_cust']"
										},
										"sink": {
											"name": "new_cust",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['open_flag']"
										},
										"sink": {
											"name": "open_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['org']"
										},
										"sink": {
											"name": "org",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['p_year']"
										},
										"sink": {
											"name": "p_year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['pay_code']"
										},
										"sink": {
											"name": "pay_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['period']"
										},
										"sink": {
											"name": "period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['po_number']"
										},
										"sink": {
											"name": "po_number",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['pre_paid']"
										},
										"sink": {
											"name": "pre_paid",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['price_line_no']"
										},
										"sink": {
											"name": "price_line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['print_doc']"
										},
										"sink": {
											"name": "print_doc",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['profitCentre']"
										},
										"sink": {
											"name": "profitCentre",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reason_code']"
										},
										"sink": {
											"name": "reason_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['receipt_no']"
										},
										"sink": {
											"name": "receipt_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['request_no']"
										},
										"sink": {
											"name": "request_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['Sent']"
										},
										"sink": {
											"name": "Sent",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['seq_no']"
										},
										"sink": {
											"name": "seq_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['service_line_no']"
										},
										"sink": {
											"name": "service_line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['stmt_aud_no']"
										},
										"sink": {
											"name": "stmt_aud_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['stmt_code']"
										},
										"sink": {
											"name": "stmt_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['stmt_date']"
										},
										"sink": {
											"name": "stmt_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['tax_amt_1']"
										},
										"sink": {
											"name": "tax_amt_1",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tax_pc_2']"
										},
										"sink": {
											"name": "tax_pc_2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['taxable_amt_1']"
										},
										"sink": {
											"name": "taxable_amt_1",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['trans_no']"
										},
										"sink": {
											"name": "trans_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['trans_seq_no']"
										},
										"sink": {
											"name": "trans_seq_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['UpdateProgram']"
										},
										"sink": {
											"name": "UpdateProgram",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UpdateUserID']"
										},
										"sink": {
											"name": "UpdateUserID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['user_id']"
										},
										"sink": {
											"name": "user_id",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "accountsreceivable",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "accounts_receivable",
										"type": "Expression"
									},
									"Instance": "vic"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "accounts_receivable",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"StartDate": {
						"type": "String"
					},
					"EndDATE": {
						"type": "String"
					},
					"DEBUG": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Corrections')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "For Each Instance",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('Instance')",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Copy Corrections to DB",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "ExcelSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": true,
											"tableOption": "autoCreate",
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "Instance",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "Instance",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "BookingID",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "BookingID",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "Customer No",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "CustomerNo",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "Container",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "Container",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "Waste Type",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "Waste_Type",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "Qty",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "Qty",
														"type": "Int32",
														"physicalType": "int"
													}
												},
												{
													"source": {
														"name": "Vol",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "Vol",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 2,
														"precision": 18
													}
												},
												{
													"source": {
														"name": "Weight",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "Weight",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 2,
														"precision": 18
													}
												},
												{
													"source": {
														"name": "Unit of Measure",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "UOM",
														"type": "String",
														"physicalType": "nvarchar"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Reference_Data",
											"type": "DatasetReference",
											"parameters": {
												"ContainerName": {
													"value": "referencedata",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "Corrections",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												},
												"SheetName": {
													"value": "Corrections",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('Corrections_',item())",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"Instance": {
						"type": "Array",
						"defaultValue": [
							"wflex"
						]
					}
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Reference_Data')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Customer')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set StartDate",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "StartDate",
							"value": {
								"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Debug",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "Debug",
							"value": {
								"value": "@concat('customer/customer?$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy Customer Data",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set StartDate",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Debug",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set EndDate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings",
									"filePattern": "arrayOfObjects"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI_Date",
								"type": "DatasetReference",
								"parameters": {
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "customer/customer",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "customer",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "customer",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Set EndDate",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "EndDate",
							"value": {
								"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'YYYY-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Customer to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy Customer Data",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"modifiedDatetimeStart": "2022-12-21T00:00:00.335Z",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"id"
									]
								},
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['accounting_acc_no']"
										},
										"sink": {
											"name": "accounting_acc_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['accounting_bal_due_days']"
										},
										"sink": {
											"name": "accounting_bal_due_days",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['accounting_cust_id']"
										},
										"sink": {
											"name": "accounting_cust_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['accounting_vendor_id']"
										},
										"sink": {
											"name": "accounting_vendor_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['address_1']"
										},
										"sink": {
											"name": "address_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['address_2']"
										},
										"sink": {
											"name": "address_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['alternate_id']"
										},
										"sink": {
											"name": "alternate_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['anzsic_code']"
										},
										"sink": {
											"name": "anzsic_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['approval_contact']"
										},
										"sink": {
											"name": "approval_contact",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['approval_email']"
										},
										"sink": {
											"name": "approval_email",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['approval_phone']"
										},
										"sink": {
											"name": "approval_phone",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apt_no']"
										},
										"sink": {
											"name": "apt_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['AttachmentCategories']"
										},
										"sink": {
											"name": "AttachmentCategories",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['AutoStopCreditOff']"
										},
										"sink": {
											"name": "AutoStopCreditOff",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['AutoStopCreditOn']"
										},
										"sink": {
											"name": "AutoStopCreditOn",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['bank_acct_no']"
										},
										"sink": {
											"name": "bank_acct_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bank_name']"
										},
										"sink": {
											"name": "bank_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_cycle']"
										},
										"sink": {
											"name": "bill_cycle",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_to_swt']"
										},
										"sink": {
											"name": "bill_to_swt",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['book_alt_ref1']"
										},
										"sink": {
											"name": "book_alt_ref1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['book_alt_ref2']"
										},
										"sink": {
											"name": "book_alt_ref2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['branch']"
										},
										"sink": {
											"name": "branch",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['BusinessType']"
										},
										"sink": {
											"name": "BusinessType",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cash_account']"
										},
										"sink": {
											"name": "cash_account",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cash_cardname']"
										},
										"sink": {
											"name": "cash_cardname",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cash_expiry']"
										},
										"sink": {
											"name": "cash_expiry",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cash_method']"
										},
										"sink": {
											"name": "cash_method",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['city']"
										},
										"sink": {
											"name": "city",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['classification_1']"
										},
										"sink": {
											"name": "classification_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['classification_2']"
										},
										"sink": {
											"name": "classification_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['classification_3']"
										},
										"sink": {
											"name": "classification_3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['classification_4']"
										},
										"sink": {
											"name": "classification_4",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['classification_5']"
										},
										"sink": {
											"name": "classification_5",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['classification_6']"
										},
										"sink": {
											"name": "classification_6",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['classification_7']"
										},
										"sink": {
											"name": "classification_7",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['classification_8']"
										},
										"sink": {
											"name": "classification_8",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['classification_9']"
										},
										"sink": {
											"name": "classification_9",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['classification_10']"
										},
										"sink": {
											"name": "classification_10",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['contribution_entitlement']"
										},
										"sink": {
											"name": "contribution_entitlement",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['contribution_entitlement_total']"
										},
										"sink": {
											"name": "contribution_entitlement_total",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['coord_date']"
										},
										"sink": {
											"name": "coord_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['coord_time']"
										},
										"sink": {
											"name": "coord_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['coord_type']"
										},
										"sink": {
											"name": "coord_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['country_code']"
										},
										"sink": {
											"name": "country_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['county']"
										},
										"sink": {
											"name": "county",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['create_date']"
										},
										"sink": {
											"name": "create_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['create_timestamp']"
										},
										"sink": {
											"name": "create_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['create_user_id']"
										},
										"sink": {
											"name": "create_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['credit_contact']"
										},
										"sink": {
											"name": "credit_contact",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['credit_email']"
										},
										"sink": {
											"name": "credit_email",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['credit_limit']"
										},
										"sink": {
											"name": "credit_limit",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['credit_limit_warn_amt']"
										},
										"sink": {
											"name": "credit_limit_warn_amt",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['credit_phone']"
										},
										"sink": {
											"name": "credit_phone",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['CTSName']"
										},
										"sink": {
											"name": "CTSName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['CTSNumber']"
										},
										"sink": {
											"name": "CTSNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency_code']"
										},
										"sink": {
											"name": "currency_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cust_class_1']"
										},
										"sink": {
											"name": "cust_class_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cust_class_2']"
										},
										"sink": {
											"name": "cust_class_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cust_class_3']"
										},
										"sink": {
											"name": "cust_class_3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cust_class_4']"
										},
										"sink": {
											"name": "cust_class_4",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cust_class_5']"
										},
										"sink": {
											"name": "cust_class_5",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cust_group']"
										},
										"sink": {
											"name": "cust_group",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cust_number']"
										},
										"sink": {
											"name": "cust_number",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['cust_seq_no']"
										},
										"sink": {
											"name": "cust_seq_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['cust_type']"
										},
										"sink": {
											"name": "cust_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['customer_class']"
										},
										"sink": {
											"name": "customer_class",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cut_off_swt']"
										},
										"sink": {
											"name": "cut_off_swt",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['day_closed_1']"
										},
										"sink": {
											"name": "day_closed_1",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['day_closed_2']"
										},
										"sink": {
											"name": "day_closed_2",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['day_closed_3']"
										},
										"sink": {
											"name": "day_closed_3",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['day_closed_4']"
										},
										"sink": {
											"name": "day_closed_4",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['day_closed_5']"
										},
										"sink": {
											"name": "day_closed_5",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['day_closed_6']"
										},
										"sink": {
											"name": "day_closed_6",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['day_closed_7']"
										},
										"sink": {
											"name": "day_closed_7",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['day_not_after_1']"
										},
										"sink": {
											"name": "day_not_after_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['day_not_after_2']"
										},
										"sink": {
											"name": "day_not_after_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['day_not_after_3']"
										},
										"sink": {
											"name": "day_not_after_3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['day_not_after_4']"
										},
										"sink": {
											"name": "day_not_after_4",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['day_not_after_5']"
										},
										"sink": {
											"name": "day_not_after_5",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['day_not_after_6']"
										},
										"sink": {
											"name": "day_not_after_6",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['day_not_after_7']"
										},
										"sink": {
											"name": "day_not_after_7",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['day_not_before_1']"
										},
										"sink": {
											"name": "day_not_before_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['day_not_before_2']"
										},
										"sink": {
											"name": "day_not_before_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['day_not_before_3']"
										},
										"sink": {
											"name": "day_not_before_3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['day_not_before_4']"
										},
										"sink": {
											"name": "day_not_before_4",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['day_not_before_5']"
										},
										"sink": {
											"name": "day_not_before_5",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['day_not_before_6']"
										},
										"sink": {
											"name": "day_not_before_6",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['day_not_before_7']"
										},
										"sink": {
											"name": "day_not_before_7",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['default_tax_perc']"
										},
										"sink": {
											"name": "default_tax_perc",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_site']"
										},
										"sink": {
											"name": "disposal_site",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['docket_req']"
										},
										"sink": {
											"name": "docket_req",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['drawer']"
										},
										"sink": {
											"name": "drawer",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['duty_care_accepted']"
										},
										"sink": {
											"name": "Duty_care_accepted",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['duty_care_from_date']"
										},
										"sink": {
											"name": "duty_care_from_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['duty_care_to_date']"
										},
										"sink": {
											"name": "duty_care_to_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['email_address']"
										},
										"sink": {
											"name": "email_address",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['fax_no']"
										},
										"sink": {
											"name": "fax_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['FilteredWithAttributes']"
										},
										"sink": {
											"name": "FilteredWithAttributes",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['first_dd_date']"
										},
										"sink": {
											"name": "first_dd_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['geocode_x']"
										},
										"sink": {
											"name": "geocode_x",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['geocode_y']"
										},
										"sink": {
											"name": "geocode_y",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['government_no']"
										},
										"sink": {
											"name": "government_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['historical_date']"
										},
										"sink": {
											"name": "historical_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['house_no']"
										},
										"sink": {
											"name": "house_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['house_no_text']"
										},
										"sink": {
											"name": "house_no_text",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['in_collection_area']"
										},
										"sink": {
											"name": "in_collection_area",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['internal_account']"
										},
										"sink": {
											"name": "internal_account",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['invoice_email']"
										},
										"sink": {
											"name": "invoice_email",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['invoice_send_method']"
										},
										"sink": {
											"name": "invoice_send_method",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['invoice_send_method_we']"
										},
										"sink": {
											"name": "invoice_send_method_we",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['InvoiceStyle']"
										},
										"sink": {
											"name": "InvoiceStyle",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['is_rcti']"
										},
										"sink": {
											"name": "is_rcti",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['LastPaymentDate']"
										},
										"sink": {
											"name": "LastPaymentDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['lot_no']"
										},
										"sink": {
											"name": "lot_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['map_reference']"
										},
										"sink": {
											"name": "map_reference",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['module']"
										},
										"sink": {
											"name": "module",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['MultiSiteOneEmail']"
										},
										"sink": {
											"name": "MultiSiteOneEmail",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['name']"
										},
										"sink": {
											"name": "name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['NoService']"
										},
										"sink": {
											"name": "NoService",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['par_billto_cust_number']"
										},
										"sink": {
											"name": "par_billto_cust_number",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['parcel_key']"
										},
										"sink": {
											"name": "parcel_key",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['phone']"
										},
										"sink": {
											"name": "phone",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Phone2']"
										},
										"sink": {
											"name": "Phone2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['po_no']"
										},
										"sink": {
											"name": "po_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['POChain']"
										},
										"sink": {
											"name": "POChain",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['possession_date']"
										},
										"sink": {
											"name": "possession_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['postal_address_1']"
										},
										"sink": {
											"name": "postal_address_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['postal_address_2']"
										},
										"sink": {
											"name": "postal_address_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['postal_city']"
										},
										"sink": {
											"name": "postal_city",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['postal_country_code']"
										},
										"sink": {
											"name": "postal_country_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['postal_county']"
										},
										"sink": {
											"name": "postal_county",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['postal_name']"
										},
										"sink": {
											"name": "postal_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['postal_property_name']"
										},
										"sink": {
											"name": "postal_property_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['postal_state']"
										},
										"sink": {
											"name": "postal_state",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['postal_zip']"
										},
										"sink": {
											"name": "postal_zip",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['property_name']"
										},
										"sink": {
											"name": "property_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['protected_from']"
										},
										"sink": {
											"name": "protected_from",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['protected_to']"
										},
										"sink": {
											"name": "protected_to",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['rate_account_number']"
										},
										"sink": {
											"name": "rate_account_number",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['rcti_email']"
										},
										"sink": {
											"name": "rcti_email",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['registration_date']"
										},
										"sink": {
											"name": "registration_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['renter_owner_swt']"
										},
										"sink": {
											"name": "renter_owner_swt",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['route_no']"
										},
										"sink": {
											"name": "route_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['rp_master']"
										},
										"sink": {
											"name": "rp_master",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['rp_number']"
										},
										"sink": {
											"name": "rp_number",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['sales_id']"
										},
										"sink": {
											"name": "sales_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['sales_territory']"
										},
										"sink": {
											"name": "sales_territory",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['SecondaryZones']"
										},
										"sink": {
											"name": "SecondaryZones",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['SendDocketsWithInvoice']"
										},
										"sink": {
											"name": "SendDocketsWithInvoice",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['serv_contact']"
										},
										"sink": {
											"name": "serv_contact",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['SignatureMandatoryOnMDT']"
										},
										"sink": {
											"name": "SignatureMandatoryOnMDT",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['stat']"
										},
										"sink": {
											"name": "stat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state']"
										},
										"sink": {
											"name": "state",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['statement_email']"
										},
										"sink": {
											"name": "statement_email",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['street_code']"
										},
										"sink": {
											"name": "street_code",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['street_section']"
										},
										"sink": {
											"name": "street_section",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['temp_susp_ed']"
										},
										"sink": {
											"name": "temp_susp_ed",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['temp_susp_sd']"
										},
										"sink": {
											"name": "temp_susp_sd",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['terms_code']"
										},
										"sink": {
											"name": "terms_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['town_code']"
										},
										"sink": {
											"name": "town_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['trade_name']"
										},
										"sink": {
											"name": "trade_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['update_user_id']"
										},
										"sink": {
											"name": "update_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UpdateProgram']"
										},
										"sink": {
											"name": "UpdateProgram",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UsePOChain']"
										},
										"sink": {
											"name": "UsePOChain",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['waste_precinct']"
										},
										"sink": {
											"name": "waste_precinct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['zip']"
										},
										"sink": {
											"name": "zip",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['zone_code']"
										},
										"sink": {
											"name": "zone_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['Instance']"
										},
										"sink": {
											"name": "Instance",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['result']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "customer",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "customer",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "customer_wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"StartDate": {
						"type": "String"
					},
					"EndDate": {
						"type": "String"
					},
					"Debug": {
						"type": "String"
					},
					"id": {
						"type": "String"
					}
				},
				"folder": {
					"name": "customer"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Invoice')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set Start Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "StartDate",
							"value": {
								"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set End Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "EndDATE",
							"value": {
								"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'YYYY-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Debug",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "DEBUG",
							"value": {
								"value": "@concat('invoice/invoice?$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set Start Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set End Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Debug",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI_Date",
								"type": "DatasetReference",
								"parameters": {
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "invoicing/invoice",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "Invoicing",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "invoice",
										"type": "Expression"
									},
									"Instance": "vic"
								}
							}
						]
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": true,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['alternate_id']"
										},
										"sink": {
											"name": "alternate_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['branch']"
										},
										"sink": {
											"name": "branch",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['customer']"
										},
										"sink": {
											"name": "customer",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['DateSent']"
										},
										"sink": {
											"name": "DateSent",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['debit_type']"
										},
										"sink": {
											"name": "debit_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['EFTDate']"
										},
										"sink": {
											"name": "EFTDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['EFTProvider']"
										},
										"sink": {
											"name": "EFTProvider",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['EFTReceipt']"
										},
										"sink": {
											"name": "EFTReceipt",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['EFTResult']"
										},
										"sink": {
											"name": "EFTResult",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['EFTTime']"
										},
										"sink": {
											"name": "EFTTime",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['Exported']"
										},
										"sink": {
											"name": "Exported",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['ExportedDate']"
										},
										"sink": {
											"name": "ExportedDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['ExportedResult']"
										},
										"sink": {
											"name": "ExportedResult",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ExportedTime']"
										},
										"sink": {
											"name": "ExportedTime",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['External_ref']"
										},
										"sink": {
											"name": "External_ref",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['invoice_item_total']"
										},
										"sink": {
											"name": "invoice_item_total",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['invoice_item_total_tax']"
										},
										"sink": {
											"name": "invoice_item_total_tax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['invoice_no']"
										},
										"sink": {
											"name": "invoice_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['invoice_period_total']"
										},
										"sink": {
											"name": "invoice_period_total",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['invoice_period_total_tax']"
										},
										"sink": {
											"name": "invoice_period_total_tax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['InvoiceDate']"
										},
										"sink": {
											"name": "InvoiceDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['InvoiceOrder']"
										},
										"sink": {
											"name": "InvoiceOrder",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['InvoiceTotal']"
										},
										"sink": {
											"name": "InvoiceTotal",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['InvoiceTotalTax']"
										},
										"sink": {
											"name": "InvoiceTotalTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['jrl_no']"
										},
										"sink": {
											"name": "jrl_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['p_year']"
										},
										"sink": {
											"name": "p_year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Paid']"
										},
										"sink": {
											"name": "Paid",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['PaidDate']"
										},
										"sink": {
											"name": "PaidDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['period']"
										},
										"sink": {
											"name": "period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['po_number']"
										},
										"sink": {
											"name": "po_number",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['postal_address_1']"
										},
										"sink": {
											"name": "postal_address_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['postal_address_2']"
										},
										"sink": {
											"name": "postal_address_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['postal_city']"
										},
										"sink": {
											"name": "postal_city",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['postal_country_code']"
										},
										"sink": {
											"name": "postal_country_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['postal_name']"
										},
										"sink": {
											"name": "postal_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['postal_property_name']"
										},
										"sink": {
											"name": "postal_property_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['postal_state']"
										},
										"sink": {
											"name": "postal_state",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['postal_zip']"
										},
										"sink": {
											"name": "postal_zip",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['prepaid_bookings']"
										},
										"sink": {
											"name": "prepaid_bookings",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['SendEmail']"
										},
										"sink": {
											"name": "SendEmail",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ServiceSite']"
										},
										"sink": {
											"name": "ServiceSite",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['TimeSent']"
										},
										"sink": {
											"name": "TimeSent",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "invoicing",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "invoice",
										"type": "Expression"
									},
									"Instance": "vic"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "invoice",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"StartDate": {
						"type": "String"
					},
					"EndDATE": {
						"type": "String"
					},
					"DEBUG": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Invoice"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Invoice_Item_charge')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set Start Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "StartDate",
							"value": {
								"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set End Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "EndDATE",
							"value": {
								"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'YYYY-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Debug",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "DEBUG",
							"value": {
								"value": "@concat('invoicing/invoice_item_charge?$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set Start Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set End Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Debug",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI_Date",
								"type": "DatasetReference",
								"parameters": {
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "invoicing/invoice_item_charge",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "invoiceitemcharge",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "invoice_item_charge",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"parallelCopies": 4,
							"enableSkipIncompatibleRow": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['AddChgTableName']"
										},
										"sink": {
											"name": "AddChgTableName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['branch']"
										},
										"sink": {
											"name": "branch",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Chargeable']"
										},
										"sink": {
											"name": "Chargeable",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['container_type']"
										},
										"sink": {
											"name": "container_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cust_number']"
										},
										"sink": {
											"name": "cust_number",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['department']"
										},
										"sink": {
											"name": "department",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Desc_L1']"
										},
										"sink": {
											"name": "Desc_L1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['displayOrder']"
										},
										"sink": {
											"name": "displayOrder",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['invoice_no']"
										},
										"sink": {
											"name": "invoice_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ItemChargeType']"
										},
										"sink": {
											"name": "ItemChargeType",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ItemTax']"
										},
										"sink": {
											"name": "ItemTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['ItemTaxPercent']"
										},
										"sink": {
											"name": "ItemTaxPercent",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['ItemTotal']"
										},
										"sink": {
											"name": "ItemTotal",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['ItemType']"
										},
										"sink": {
											"name": "ItemType",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jrl_no']"
										},
										"sink": {
											"name": "jrl_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['ledger_account']"
										},
										"sink": {
											"name": "ledger_account",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['line_no']"
										},
										"sink": {
											"name": "line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['p_year']"
										},
										"sink": {
											"name": "p_year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['p_year_period_jrl_no']"
										},
										"sink": {
											"name": "p_year_period_jrl_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Paid']"
										},
										"sink": {
											"name": "Paid",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['period']"
										},
										"sink": {
											"name": "period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['PO']"
										},
										"sink": {
											"name": "PO",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['price_type']"
										},
										"sink": {
											"name": "price_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['profitCentre']"
										},
										"sink": {
											"name": "profitCentre",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Qty']"
										},
										"sink": {
											"name": "Qty",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Rate']"
										},
										"sink": {
											"name": "Rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['trans_date']"
										},
										"sink": {
											"name": "trans_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['trans_no']"
										},
										"sink": {
											"name": "trans_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['trans_no_trans_seq_no']"
										},
										"sink": {
											"name": "trans_no_trans_seq_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['trans_seq_no']"
										},
										"sink": {
											"name": "trans_seq_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['waste_type']"
										},
										"sink": {
											"name": "waste_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ZeroCharge']"
										},
										"sink": {
											"name": "ZeroCharge",
											"type": "Boolean"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "invoiceitemcharge",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "invoice_item_charge",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "invoice_item_charge_wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"StartDate": {
						"type": "String"
					},
					"EndDATE": {
						"type": "String"
					},
					"DEBUG": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Invoice"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Invoice_Period_charge')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "For Each API",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('API_Instance')",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Set period",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "Period",
										"value": {
											"value": "@pipeline().parameters.Period",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set Debug",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "DEBUG",
										"value": {
											"value": "@concat(item(),'$query=period=','''',pipeline().parameters.Period,'''','and p_year=','''',pipeline().parameters.P_year,'''')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Copy route to DataLake",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set period",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Set Debug",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true",
												"EndCondition:$.has_more": "Const:false",
												"QueryParameters.$start": "$.next_result"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "Period_Query",
											"type": "DatasetReference",
											"parameters": {
												"Period": {
													"value": "@pipeline().parameters.Period",
													"type": "Expression"
												},
												"API_Instance": {
													"value": "@split(item(),'.')[1]",
													"type": "Expression"
												},
												"P_year": {
													"value": "@pipeline().parameters.P_year",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@concat('period-',pipeline().parameters.Period,' Year-',pipeline().parameters.P_year)",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "@split(item(),'.')[0]",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"Instance": {
													"value": "wflex",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Invoice  Period to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "For Each API",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"additionalColumns": [
									{
										"name": "Update Timestamp",
										"value": {
											"value": "@utcnow()",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"parallelCopies": 4,
							"enableSkipIncompatibleRow": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['branch']"
										},
										"sink": {
											"name": "branch",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['Chargeable']"
										},
										"sink": {
											"name": "Chargeable",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['cust_number']"
										},
										"sink": {
											"name": "cust_number",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['department']"
										},
										"sink": {
											"name": "department",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Desc_L1']"
										},
										"sink": {
											"name": "Desc_L1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['displayOrder']"
										},
										"sink": {
											"name": "displayOrder",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['invoice_no']"
										},
										"sink": {
											"name": "invoice_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ItemChargeType']"
										},
										"sink": {
											"name": "ItemChargeType",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jrl_no']"
										},
										"sink": {
											"name": "jrl_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['ledger_account']"
										},
										"sink": {
											"name": "ledger_account",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['line_no']"
										},
										"sink": {
											"name": "line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['p_year']"
										},
										"sink": {
											"name": "p_year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['p_year_period_jrl_no']"
										},
										"sink": {
											"name": "p_year_period_jrl_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Paid']"
										},
										"sink": {
											"name": "Paid",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['period']"
										},
										"sink": {
											"name": "period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['PeriodTax']"
										},
										"sink": {
											"name": "PeriodTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['PeriodTaxPercent']"
										},
										"sink": {
											"name": "PeriodTaxPercent",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['PeriodTotal']"
										},
										"sink": {
											"name": "PeriodTotal",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['PO']"
										},
										"sink": {
											"name": "PO",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Price']"
										},
										"sink": {
											"name": "Price",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['price_line_no']"
										},
										"sink": {
											"name": "price_line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['profitCentre']"
										},
										"sink": {
											"name": "profitCentre",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Qty']"
										},
										"sink": {
											"name": "Qty",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Rate']"
										},
										"sink": {
											"name": "Rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['SiteHeaderText']"
										},
										"sink": {
											"name": "SiteHeaderText",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ZeroCharge']"
										},
										"sink": {
											"name": "ZeroCharge",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['Update Timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@concat('period-',pipeline().parameters.Period,' Year-',pipeline().parameters.P_year)",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "invoiceperiodcharge",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "Invoice_period_charge",
										"type": "Expression"
									},
									"Instance": {
										"value": "wflex",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "invoice_period_charge_wflex",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Invoice Item Charge to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Invoice  Period to DB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"parallelCopies": 4,
							"enableSkipIncompatibleRow": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['AddChgTableName']"
										},
										"sink": {
											"name": "AddChgTableName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['branch']"
										},
										"sink": {
											"name": "branch",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['Chargeable']"
										},
										"sink": {
											"name": "Chargeable",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['container_type']"
										},
										"sink": {
											"name": "container_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cust_number']"
										},
										"sink": {
											"name": "cust_number",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['department']"
										},
										"sink": {
											"name": "department",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Desc_L1']"
										},
										"sink": {
											"name": "Desc_L1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['displayOrder']"
										},
										"sink": {
											"name": "displayOrder",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['invoice_no']"
										},
										"sink": {
											"name": "invoice_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ItemChargeType']"
										},
										"sink": {
											"name": "ItemChargeType",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ItemTax']"
										},
										"sink": {
											"name": "ItemTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['ItemTaxPercent']"
										},
										"sink": {
											"name": "ItemTaxPercent",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['ItemTotal']"
										},
										"sink": {
											"name": "ItemTotal",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['ItemType']"
										},
										"sink": {
											"name": "ItemType",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jrl_no']"
										},
										"sink": {
											"name": "jrl_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['ledger_account']"
										},
										"sink": {
											"name": "ledger_account",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['line_no']"
										},
										"sink": {
											"name": "line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['p_year']"
										},
										"sink": {
											"name": "p_year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['p_year_period_jrl_no']"
										},
										"sink": {
											"name": "p_year_period_jrl_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Paid']"
										},
										"sink": {
											"name": "Paid",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['period']"
										},
										"sink": {
											"name": "period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['PO']"
										},
										"sink": {
											"name": "PO",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['price_type']"
										},
										"sink": {
											"name": "price_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['profitCentre']"
										},
										"sink": {
											"name": "profitCentre",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Qty']"
										},
										"sink": {
											"name": "Qty",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Rate']"
										},
										"sink": {
											"name": "Rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['trans_date']"
										},
										"sink": {
											"name": "trans_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['trans_no']"
										},
										"sink": {
											"name": "trans_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['trans_no_trans_seq_no']"
										},
										"sink": {
											"name": "trans_no_trans_seq_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['trans_seq_no']"
										},
										"sink": {
											"name": "trans_seq_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['waste_type']"
										},
										"sink": {
											"name": "waste_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ZeroCharge']"
										},
										"sink": {
											"name": "ZeroCharge",
											"type": "Boolean"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@concat('period-',pipeline().parameters.Period,' Year-',pipeline().parameters.P_year)",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "invoiceitemcharge",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "Invoice_item_charge",
										"type": "Expression"
									},
									"Instance": {
										"value": "wflex",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "invoice_item_charge_wflex",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Period": {
						"type": "string"
					},
					"P_year": {
						"type": "string"
					}
				},
				"variables": {
					"DEBUG": {
						"type": "String"
					},
					"Period": {
						"type": "String"
					},
					"API_Instance": {
						"type": "Array",
						"defaultValue": [
							"invoiceitemcharge.Invoicing/Invoice_item_charge",
							"invoiceperiodcharge.Invoicing/Invoice_period_charge"
						]
					}
				},
				"folder": {
					"name": "Invoice"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]",
				"[concat(variables('factoryId'), '/datasets/Period_Query')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Invoice_batch')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set Start Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "StartDate",
							"value": {
								"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set End Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "EndDATE",
							"value": {
								"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'YYYY-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Debug",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "DEBUG",
							"value": {
								"value": "@concat('invoice/invoice?$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set Start Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set End Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Debug",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI_Date",
								"type": "DatasetReference",
								"parameters": {
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "invoicing/invoice_batch",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "invoicebatch",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "invoice_batch",
										"type": "Expression"
									},
									"Instance": "vic"
								}
							}
						]
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": true,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['BatchComplete']"
										},
										"sink": {
											"name": "BatchComplete",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['BatchStamp']"
										},
										"sink": {
											"name": "BatchStamp",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['BatchStatus']"
										},
										"sink": {
											"name": "BatchStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['BillingFrom']"
										},
										"sink": {
											"name": "BillingFrom",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['BillingTo']"
										},
										"sink": {
											"name": "BillingTo",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['CustomerTypes']"
										},
										"sink": {
											"name": "CustomerTypes",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['DateCreated']"
										},
										"sink": {
											"name": "DateCreated",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['DateFrom']"
										},
										"sink": {
											"name": "DateFrom",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['DateInvoiced']"
										},
										"sink": {
											"name": "DateInvoiced",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['DateTo']"
										},
										"sink": {
											"name": "DateTo",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['Description']"
										},
										"sink": {
											"name": "Description",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['EmpID']"
										},
										"sink": {
											"name": "EmpID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Exported']"
										},
										"sink": {
											"name": "Exported",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['ExportedDate']"
										},
										"sink": {
											"name": "ExportedDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['ExportedResult']"
										},
										"sink": {
											"name": "ExportedResult",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ExportedTime']"
										},
										"sink": {
											"name": "ExportedTime",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['id']"
										},
										"sink": {
											"name": "id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['Instructions']"
										},
										"sink": {
											"name": "Instructions",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['InvoiceCycles']"
										},
										"sink": {
											"name": "InvoiceCycles",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jrl_no']"
										},
										"sink": {
											"name": "jrl_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['p_year']"
										},
										"sink": {
											"name": "p_year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Params']"
										},
										"sink": {
											"name": "Params",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['period']"
										},
										"sink": {
											"name": "period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Summary']"
										},
										"sink": {
											"name": "Summary",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['TimeCreated']"
										},
										"sink": {
											"name": "TimeCreated",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['TotalInvoiced']"
										},
										"sink": {
											"name": "TotalInvoiced",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['TotalInvoices']"
										},
										"sink": {
											"name": "TotalInvoices",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "invoicebatch",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "invoice_batch",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "invoice_batch",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"StartDate": {
						"type": "String"
					},
					"EndDATE": {
						"type": "String"
					},
					"DEBUG": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Invoice"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Invoice_item_charge2')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set period",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "Period",
							"value": {
								"value": "@pipeline().parameters.Period",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Debug",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "DEBUG",
							"value": {
								"value": "@concat('invoicing/invoice_item_charge?$query=period=','''',pipeline().parameters.Period,'''','and p_year=','''',pipeline().parameters.P_year,'''')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set period",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Debug",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "Period_Query",
								"type": "DatasetReference",
								"parameters": {
									"Period": {
										"value": "@pipeline().parameters.Period",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "invoicing/invoice_item_charge",
										"type": "Expression"
									},
									"P_year": {
										"value": "@pipeline().parameters.P_year",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@concat('period-',pipeline().parameters.Period,' Year-',pipeline().parameters.P_year)",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "invoiceitemcharge",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "invoice_item_charge",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgnsw",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"parallelCopies": 4,
							"enableSkipIncompatibleRow": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['AddChgTableName']"
										},
										"sink": {
											"name": "AddChgTableName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['branch']"
										},
										"sink": {
											"name": "branch",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['Chargeable']"
										},
										"sink": {
											"name": "Chargeable",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['container_type']"
										},
										"sink": {
											"name": "container_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cust_number']"
										},
										"sink": {
											"name": "cust_number",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['department']"
										},
										"sink": {
											"name": "department",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Desc_L1']"
										},
										"sink": {
											"name": "Desc_L1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['displayOrder']"
										},
										"sink": {
											"name": "displayOrder",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['invoice_no']"
										},
										"sink": {
											"name": "invoice_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ItemChargeType']"
										},
										"sink": {
											"name": "ItemChargeType",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ItemTax']"
										},
										"sink": {
											"name": "ItemTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['ItemTaxPercent']"
										},
										"sink": {
											"name": "ItemTaxPercent",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['ItemTotal']"
										},
										"sink": {
											"name": "ItemTotal",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['ItemType']"
										},
										"sink": {
											"name": "ItemType",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jrl_no']"
										},
										"sink": {
											"name": "jrl_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['ledger_account']"
										},
										"sink": {
											"name": "ledger_account",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['line_no']"
										},
										"sink": {
											"name": "line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['p_year']"
										},
										"sink": {
											"name": "p_year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['p_year_period_jrl_no']"
										},
										"sink": {
											"name": "p_year_period_jrl_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Paid']"
										},
										"sink": {
											"name": "Paid",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['period']"
										},
										"sink": {
											"name": "period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['PO']"
										},
										"sink": {
											"name": "PO",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['price_type']"
										},
										"sink": {
											"name": "price_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['profitCentre']"
										},
										"sink": {
											"name": "profitCentre",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Qty']"
										},
										"sink": {
											"name": "Qty",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Rate']"
										},
										"sink": {
											"name": "Rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['trans_date']"
										},
										"sink": {
											"name": "trans_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['trans_no']"
										},
										"sink": {
											"name": "trans_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['trans_no_trans_seq_no']"
										},
										"sink": {
											"name": "trans_no_trans_seq_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['trans_seq_no']"
										},
										"sink": {
											"name": "trans_seq_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['waste_type']"
										},
										"sink": {
											"name": "waste_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ZeroCharge']"
										},
										"sink": {
											"name": "ZeroCharge",
											"type": "Boolean"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@concat('period-',pipeline().parameters.Period,' Year-',pipeline().parameters.P_year)",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "invoiceitemcharge",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "invoice_item_charge",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgnsw",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "invoice_item_charge_wsgnsw",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Period": {
						"type": "string"
					},
					"P_year": {
						"type": "string"
					}
				},
				"variables": {
					"DEBUG": {
						"type": "String"
					},
					"Period": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Invoice"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Period_Query')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Invoice_period')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI",
								"type": "DatasetReference",
								"parameters": {
									"Dataset": {
										"value": "invoicing/invoice_period",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@formatDateTime(utcNow(),'yyyy-MM-dd')",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "invoicing",
										"type": "Expression"
									},
									"DatasetName": "invoice_period",
									"Instance": "vic"
								}
							}
						]
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['ar_balances_1']"
										},
										"sink": {
											"name": "ar_balances_1",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['ar_balances_2']"
										},
										"sink": {
											"name": "ar_balances_2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['ar_balances_3']"
										},
										"sink": {
											"name": "ar_balances_3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['ar_balances_4']"
										},
										"sink": {
											"name": "ar_balances_4",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['ar_balances_5']"
										},
										"sink": {
											"name": "ar_balances_5",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['current_period']"
										},
										"sink": {
											"name": "current_period",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['org']"
										},
										"sink": {
											"name": "org",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['os_code']"
										},
										"sink": {
											"name": "os_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['period_end_date']"
										},
										"sink": {
											"name": "period_end_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['period_no']"
										},
										"sink": {
											"name": "period_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['total_revenue']"
										},
										"sink": {
											"name": "total_revenue",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['year_no']"
										},
										"sink": {
											"name": "year_no",
											"type": "Int32"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "invoicing",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "invoice_period",
										"type": "Expression"
									},
									"Instance": "vic"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "invoice_period",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Invoice"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Reference')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "For Each Instance",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('Instance')",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Copy WasteType to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Copy Runs to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "ExcelSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"preCopyScript": {
												"value": "delete from @{concat('Ref_WasteType_',item())}",
												"type": "Expression"
											},
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": true,
											"tableOption": "autoCreate",
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "System",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "System",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "WasteType",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "WasteType",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "WasteTypeDesc",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "WasteTypeDesc",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "WasteGrp",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "WasteGrp",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "WasteGrpDesc",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "WasteGrpDesc",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "WasteOutcome",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "WasteOutcome",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "Kg/m3",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "Estkgm3",
														"type": "Int32",
														"physicalType": "int"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Reference_Data",
											"type": "DatasetReference",
											"parameters": {
												"ContainerName": {
													"value": "referencedata",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "WasteType",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												},
												"SheetName": {
													"value": "tblWasteTypes",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('Ref_WasteType_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Copy ServType to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Copy WasteType to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "ExcelSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": true,
											"tableOption": "autoCreate",
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Reference_Data",
											"type": "DatasetReference",
											"parameters": {
												"ContainerName": {
													"value": "referencedata",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "ServTypes",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												},
												"SheetName": {
													"value": "tblServTypes",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('Ref_ServTypes_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Copy Containers to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Copy ServType to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "ExcelSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": true,
											"tableOption": "autoCreate",
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Reference_Data",
											"type": "DatasetReference",
											"parameters": {
												"ContainerName": {
													"value": "referencedata",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "Containers",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												},
												"SheetName": {
													"value": "tblContainers",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('Ref_Containers_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Copy Runs to DB",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "ExcelSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": true,
											"tableOption": "autoCreate",
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Reference_Data",
											"type": "DatasetReference",
											"parameters": {
												"ContainerName": {
													"value": "referencedata",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "Runs",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												},
												"SheetName": {
													"value": "tblRuns",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('Ref_Runs_',item())",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"Instance": {
						"type": "Array",
						"defaultValue": [
							"wflex"
						]
					}
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Reference_Data')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Route')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set Start Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "StartDate",
							"value": {
								"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set End Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "EndDATE",
							"value": {
								"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'YYYY-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Debug",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "DEBUG",
							"value": {
								"value": "@concat('vehicle/route?$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set Start Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set End Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Debug",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"additionalColumns": [
									{
										"name": "Instance",
										"value": "wsgvic"
									}
								],
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI_Date",
								"type": "DatasetReference",
								"parameters": {
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "vehicle/route",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "route",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "route",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"id"
									]
								},
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Active']"
										},
										"sink": {
											"name": "Active",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['area_type']"
										},
										"sink": {
											"name": "area_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['branch']"
										},
										"sink": {
											"name": "branch",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['create_timestamp']"
										},
										"sink": {
											"name": "create_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['create_user_id']"
										},
										"sink": {
											"name": "create_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['display_order']"
										},
										"sink": {
											"name": "display_order",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['driver']"
										},
										"sink": {
											"name": "driver",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['driver_list']"
										},
										"sink": {
											"name": "driver_list",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['equipment_set']"
										},
										"sink": {
											"name": "equipment_set",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Friday']"
										},
										"sink": {
											"name": "Friday",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['G_Cal_ID']"
										},
										"sink": {
											"name": "G_Cal_ID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['G_Event_ID']"
										},
										"sink": {
											"name": "G_Event_ID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['InvoiceCustomer']"
										},
										"sink": {
											"name": "InvoiceCustomer",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['InvoiceService']"
										},
										"sink": {
											"name": "InvoiceService",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['labour_rate_per_hour']"
										},
										"sink": {
											"name": "labour_rate_per_hour",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['mdt_enabled']"
										},
										"sink": {
											"name": "mdt_enabled",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['Monday']"
										},
										"sink": {
											"name": "Monday",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['next_service_date']"
										},
										"sink": {
											"name": "next_service_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['num_employees']"
										},
										"sink": {
											"name": "num_employees",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['ReSequenceType']"
										},
										"sink": {
											"name": "ReSequenceType",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_brws_desc']"
										},
										"sink": {
											"name": "route_brws_desc",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_cycle']"
										},
										"sink": {
											"name": "route_cycle",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_description']"
										},
										"sink": {
											"name": "route_description",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_inv_desc']"
										},
										"sink": {
											"name": "route_inv_desc",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_MDT_desc']"
										},
										"sink": {
											"name": "route_MDT_desc",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_no']"
										},
										"sink": {
											"name": "route_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_type']"
										},
										"sink": {
											"name": "route_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Saturday']"
										},
										"sink": {
											"name": "Saturday",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['serv_code']"
										},
										"sink": {
											"name": "serv_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['shift_no']"
										},
										"sink": {
											"name": "shift_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Sunday']"
										},
										"sink": {
											"name": "Sunday",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['supervisor_no']"
										},
										"sink": {
											"name": "supervisor_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['team_no']"
										},
										"sink": {
											"name": "team_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Thursday']"
										},
										"sink": {
											"name": "Thursday",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['truck_no']"
										},
										"sink": {
											"name": "truck_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Tuesday']"
										},
										"sink": {
											"name": "Tuesday",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['update_user_id']"
										},
										"sink": {
											"name": "update_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UpdateProgram']"
										},
										"sink": {
											"name": "UpdateProgram",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Wednesday']"
										},
										"sink": {
											"name": "Wednesday",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['Instance']"
										},
										"sink": {
											"name": "Instance",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "route",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "route",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "route",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"StartDate": {
						"type": "String"
					},
					"EndDATE": {
						"type": "String"
					},
					"DEBUG": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Vehicle"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Route_summary')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set Start Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "StartDate",
							"value": {
								"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set End Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "EndDATE",
							"value": {
								"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'YYYY-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Debug",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "DEBUG",
							"value": {
								"value": "@concat('vehicle/route_summary?$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set Start Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set End Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Debug",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI_Date",
								"type": "DatasetReference",
								"parameters": {
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "vehicle/route_summary",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "routesummary",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "route_summary",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"id"
									]
								},
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Bookings']"
										},
										"sink": {
											"name": "Bookings",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['Confirmed']"
										},
										"sink": {
											"name": "Confirmed",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['depot']"
										},
										"sink": {
											"name": "depot",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['driver']"
										},
										"sink": {
											"name": "driver",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['Failed']"
										},
										"sink": {
											"name": "Failed",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['labour_rate_per_hour']"
										},
										"sink": {
											"name": "labour_rate_per_hour",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['labour_rate_per_hour_ot']"
										},
										"sink": {
											"name": "labour_rate_per_hour_ot",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['labour_rate_per_hour_ot2']"
										},
										"sink": {
											"name": "labour_rate_per_hour_ot2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['mdt_no']"
										},
										"sink": {
											"name": "mdt_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mileage_from_tip']"
										},
										"sink": {
											"name": "mileage_from_tip",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['mileage_to_tip']"
										},
										"sink": {
											"name": "mileage_to_tip",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['normal_labour_hrs']"
										},
										"sink": {
											"name": "normal_labour_hrs",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['notes']"
										},
										"sink": {
											"name": "notes",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['odometer_finish']"
										},
										"sink": {
											"name": "odometer_finish",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['odometer_start']"
										},
										"sink": {
											"name": "odometer_start",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['org']"
										},
										"sink": {
											"name": "org",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['Outstanding']"
										},
										"sink": {
											"name": "Outstanding",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['overtime_labour_hrs']"
										},
										"sink": {
											"name": "overtime_labour_hrs",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['overtime_labour_hrs2']"
										},
										"sink": {
											"name": "overtime_labour_hrs2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['route_date']"
										},
										"sink": {
											"name": "route_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['route_no']"
										},
										"sink": {
											"name": "route_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['RouteDescription']"
										},
										"sink": {
											"name": "RouteDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['run_hours']"
										},
										"sink": {
											"name": "run_hours",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['run_meter_finish']"
										},
										"sink": {
											"name": "run_meter_finish",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['run_meter_start']"
										},
										"sink": {
											"name": "run_meter_start",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Sent']"
										},
										"sink": {
											"name": "Sent",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['serv_code']"
										},
										"sink": {
											"name": "serv_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['shift_no']"
										},
										"sink": {
											"name": "shift_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['StatusPercent']"
										},
										"sink": {
											"name": "StatusPercent",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['team_no']"
										},
										"sink": {
											"name": "team_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['time_finish']"
										},
										"sink": {
											"name": "time_finish",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['time_start']"
										},
										"sink": {
											"name": "time_start",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['time_to_tip']"
										},
										"sink": {
											"name": "time_to_tip",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tips_visited']"
										},
										"sink": {
											"name": "tips_visited",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total_additional_charge']"
										},
										"sink": {
											"name": "total_additional_charge",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_containers_scheduled']"
										},
										"sink": {
											"name": "total_containers_scheduled",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_containers_serviced']"
										},
										"sink": {
											"name": "total_containers_serviced",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_containers_serviced_old']"
										},
										"sink": {
											"name": "total_containers_serviced_old",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['total_cubic_meters']"
										},
										"sink": {
											"name": "total_cubic_meters",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_disposal_rebate_costs']"
										},
										"sink": {
											"name": "total_disposal_rebate_costs",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_down_time']"
										},
										"sink": {
											"name": "total_down_time",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_engine_hours']"
										},
										"sink": {
											"name": "total_engine_hours",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_fuel_cost']"
										},
										"sink": {
											"name": "total_fuel_cost",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_fuel_used']"
										},
										"sink": {
											"name": "total_fuel_used",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_kilometers']"
										},
										"sink": {
											"name": "total_kilometers",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_kilometers_gps']"
										},
										"sink": {
											"name": "total_kilometers_gps",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_metric_tons']"
										},
										"sink": {
											"name": "total_metric_tons",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_no_of_main_jobs']"
										},
										"sink": {
											"name": "total_no_of_main_jobs",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['total_no_of_messages']"
										},
										"sink": {
											"name": "total_no_of_messages",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['total_no_of_sections']"
										},
										"sink": {
											"name": "total_no_of_sections",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['total_normal_labour_cost']"
										},
										"sink": {
											"name": "total_normal_labour_cost",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_oil_cost']"
										},
										"sink": {
											"name": "total_oil_cost",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_oil_used']"
										},
										"sink": {
											"name": "total_oil_used",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_overtime_labour_cost']"
										},
										"sink": {
											"name": "total_overtime_labour_cost",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_overtime_labour_cost2']"
										},
										"sink": {
											"name": "total_overtime_labour_cost2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_rcti_costs']"
										},
										"sink": {
											"name": "total_rcti_costs",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_revenue']"
										},
										"sink": {
											"name": "total_revenue",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_run_mileage']"
										},
										"sink": {
											"name": "total_run_mileage",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_run_time']"
										},
										"sink": {
											"name": "total_run_time",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_stops_completed']"
										},
										"sink": {
											"name": "total_stops_completed",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['total_stops_scheduled']"
										},
										"sink": {
											"name": "total_stops_scheduled",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['total_subcontr_cost']"
										},
										"sink": {
											"name": "total_subcontr_cost",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_tip_time']"
										},
										"sink": {
											"name": "total_tip_time",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_tip_wait_time']"
										},
										"sink": {
											"name": "total_tip_wait_time",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_tipping_charges']"
										},
										"sink": {
											"name": "total_tipping_charges",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_tipping_costs']"
										},
										"sink": {
											"name": "total_tipping_costs",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_veh_cost_hour']"
										},
										"sink": {
											"name": "total_veh_cost_hour",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_veh_cost_klm']"
										},
										"sink": {
											"name": "total_veh_cost_klm",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_veh_cost_klm_gps']"
										},
										"sink": {
											"name": "total_veh_cost_klm_gps",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['truck_no']"
										},
										"sink": {
											"name": "truck_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UnSent']"
										},
										"sink": {
											"name": "UnSent",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['unused_time']"
										},
										"sink": {
											"name": "unused_time",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['UpdateProgram']"
										},
										"sink": {
											"name": "UpdateProgram",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UpdateUserID']"
										},
										"sink": {
											"name": "UpdateUserID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['veh_cost_per_hr']"
										},
										"sink": {
											"name": "veh_cost_per_hr",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['veh_cost_per_klm']"
										},
										"sink": {
											"name": "veh_cost_per_klm",
											"type": "Decimal"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "routesummary",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "route_summary",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "route_summary_wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"StartDate": {
						"type": "String"
					},
					"EndDATE": {
						"type": "String"
					},
					"DEBUG": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Vehicle"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Route_tip_Fee')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set Start Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "StartDate",
							"value": {
								"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set End Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "EndDATE",
							"value": {
								"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'YYYY-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Debug",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "DEBUG",
							"value": {
								"value": "@concat('vehicle/route_tip_fee?$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set Start Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set End Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Debug",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI_Date",
								"type": "DatasetReference",
								"parameters": {
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "vehicle/route_tip_fee",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "routetipfee",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "route_tip_fee",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"id"
									]
								},
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['alt_qty']"
										},
										"sink": {
											"name": "alt_qty",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['alt_qty_unit']"
										},
										"sink": {
											"name": "alt_qty_unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['branch']"
										},
										"sink": {
											"name": "branch",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['cont_id']"
										},
										"sink": {
											"name": "cont_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['coord_date']"
										},
										"sink": {
											"name": "coord_date",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['coord_time']"
										},
										"sink": {
											"name": "coord_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['coord_type']"
										},
										"sink": {
											"name": "coord_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['create_timestamp']"
										},
										"sink": {
											"name": "create_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['create_user_id']"
										},
										"sink": {
											"name": "create_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['customer']"
										},
										"sink": {
											"name": "customer",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['date_accrual']"
										},
										"sink": {
											"name": "date_accrual",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['date_approved']"
										},
										"sink": {
											"name": "date_approved",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['date_paid']"
										},
										"sink": {
											"name": "date_paid",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_desc']"
										},
										"sink": {
											"name": "disposal_charge_desc",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_desc2']"
										},
										"sink": {
											"name": "disposal_charge_desc2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_desc3']"
										},
										"sink": {
											"name": "disposal_charge_desc3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate']"
										},
										"sink": {
											"name": "disposal_charge_rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate2']"
										},
										"sink": {
											"name": "disposal_charge_rate2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate3']"
										},
										"sink": {
											"name": "disposal_charge_rate3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate_ex']"
										},
										"sink": {
											"name": "disposal_charge_rate_ex",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate_ex2']"
										},
										"sink": {
											"name": "disposal_charge_rate_ex2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate_ex3']"
										},
										"sink": {
											"name": "disposal_charge_rate_ex3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type']"
										},
										"sink": {
											"name": "disposal_charge_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type2']"
										},
										"sink": {
											"name": "disposal_charge_type2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type3']"
										},
										"sink": {
											"name": "disposal_charge_type3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type_ex']"
										},
										"sink": {
											"name": "disposal_charge_type_ex",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type_ex2']"
										},
										"sink": {
											"name": "disposal_charge_type_ex2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type_ex3']"
										},
										"sink": {
											"name": "disposal_charge_type_ex3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_cost_rate']"
										},
										"sink": {
											"name": "disposal_cost_rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_cost_rate2']"
										},
										"sink": {
											"name": "disposal_cost_rate2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_cost_rate3']"
										},
										"sink": {
											"name": "disposal_cost_rate3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_cost_rate_ex']"
										},
										"sink": {
											"name": "disposal_cost_rate_ex",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_cost_rate_type']"
										},
										"sink": {
											"name": "disposal_cost_rate_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_date']"
										},
										"sink": {
											"name": "disposal_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['disposal_incl_charge']"
										},
										"sink": {
											"name": "disposal_incl_charge",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['disposal_site']"
										},
										"sink": {
											"name": "disposal_site",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_weight_limit_ex']"
										},
										"sink": {
											"name": "disposal_weight_limit_ex",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_weight_limit_ex2']"
										},
										"sink": {
											"name": "disposal_weight_limit_ex2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_weight_limit_ex3']"
										},
										"sink": {
											"name": "disposal_weight_limit_ex3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['DisposalServiceFunction']"
										},
										"sink": {
											"name": "DisposalServiceFunction",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['docket_no']"
										},
										"sink": {
											"name": "docket_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['driver']"
										},
										"sink": {
											"name": "driver",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['ExternalWeight']"
										},
										"sink": {
											"name": "ExternalWeight",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['geocode_x']"
										},
										"sink": {
											"name": "geocode_x",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['geocode_y']"
										},
										"sink": {
											"name": "geocode_y",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['invoice_number']"
										},
										"sink": {
											"name": "invoice_number",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Levy1Desc']"
										},
										"sink": {
											"name": "Levy1Desc",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Levy1Rate']"
										},
										"sink": {
											"name": "Levy1Rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Levy1Type']"
										},
										"sink": {
											"name": "Levy1Type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['odometer']"
										},
										"sink": {
											"name": "odometer",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['plate_no']"
										},
										"sink": {
											"name": "plate_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route']"
										},
										"sink": {
											"name": "route",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_date']"
										},
										"sink": {
											"name": "route_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['route_summary']"
										},
										"sink": {
											"name": "route_summary",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['seq_no']"
										},
										"sink": {
											"name": "seq_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['serial_no']"
										},
										"sink": {
											"name": "serial_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['shift_no']"
										},
										"sink": {
											"name": "shift_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ticket_number']"
										},
										"sink": {
											"name": "ticket_number",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ticket_number_old']"
										},
										"sink": {
											"name": "ticket_number_old",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['tip_in_time']"
										},
										"sink": {
											"name": "tip_in_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_out_time']"
										},
										"sink": {
											"name": "tip_out_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_sub_loc_no']"
										},
										"sink": {
											"name": "tip_sub_loc_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_visit_time']"
										},
										"sink": {
											"name": "tip_visit_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total_charge']"
										},
										"sink": {
											"name": "total_charge",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_cost']"
										},
										"sink": {
											"name": "total_cost",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_cost_entered']"
										},
										"sink": {
											"name": "total_cost_entered",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['trans_no']"
										},
										"sink": {
											"name": "trans_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['trans_seq']"
										},
										"sink": {
											"name": "trans_seq",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['transmit_no']"
										},
										"sink": {
											"name": "transmit_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['truck']"
										},
										"sink": {
											"name": "truck",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['update_user_id']"
										},
										"sink": {
											"name": "update_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UpdateProgram']"
										},
										"sink": {
											"name": "UpdateProgram",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['user_approved']"
										},
										"sink": {
											"name": "user_approved",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['volume']"
										},
										"sink": {
											"name": "volume",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['volume_unit']"
										},
										"sink": {
											"name": "volume_unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['waste_type']"
										},
										"sink": {
											"name": "waste_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['weight']"
										},
										"sink": {
											"name": "weight",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['weight_max']"
										},
										"sink": {
											"name": "weight_max",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['weight_min']"
										},
										"sink": {
											"name": "weight_min",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['weight_orig']"
										},
										"sink": {
											"name": "weight_orig",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['weight_unit']"
										},
										"sink": {
											"name": "weight_unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['WeightIn']"
										},
										"sink": {
											"name": "WeightIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['WeightOut']"
										},
										"sink": {
											"name": "WeightOut",
											"type": "Decimal"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "routetipfee",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "route_tip_fee",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "route_tip_fee_wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"StartDate": {
						"type": "String"
					},
					"EndDATE": {
						"type": "String"
					},
					"DEBUG": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Vehicle"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_SaraTest_CopyBooking')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Sara's test pipeline to download Booking and Tipping Fee data from Wastedge API",
				"activities": [
					{
						"name": "Download Booking Data",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set End Date",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"QueryParameters.$start": "$.next_result",
									"EndCondition:$.has_more": "Const:false"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI_Date",
								"type": "DatasetReference",
								"parameters": {
									"pStartDate": {
										"value": "@variables('StartDate')",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@variables('EndDate')",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "@variables('varApiInstance_Booking')",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@concat(variables('StartDate'), '_', variables('EndDate'))",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "@split(variables('varApiInstance_Booking'), '/')[0]",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "@split(variables('varApiInstance_Booking'), '/')[1]",
										"type": "Expression"
									},
									"Instance": {
										"value": "@pipeline().parameters.Instance",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Set Start Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "StartDate",
							"value": {
								"value": "@formatDateTime(addDays(pipeline().TriggerTime, pipeline().parameters.queryDataDayOffset), 'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set End Date",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Start Date",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "EndDate",
							"value": {
								"value": "@formatDateTime(addDays(pipeline().TriggerTime, 1), 'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Load Booking Data to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Download Booking Data",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": false,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"trans_no",
										"trans_seq_no"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['add_chg_changed']"
										},
										"sink": {
											"name": "add_chg_changed",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['admin_status']"
										},
										"sink": {
											"name": "admin_status",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['alt_ref_1']"
										},
										"sink": {
											"name": "alt_ref_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['alt_ref_2']"
										},
										"sink": {
											"name": "alt_ref_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['alt_ref_serv_1']"
										},
										"sink": {
											"name": "alt_ref_serv_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['alt_ref_serv_2']"
										},
										"sink": {
											"name": "alt_ref_serv_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['application_id']"
										},
										"sink": {
											"name": "application_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_address_1']"
										},
										"sink": {
											"name": "bill_address_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_address_2']"
										},
										"sink": {
											"name": "bill_address_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_city']"
										},
										"sink": {
											"name": "bill_city",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_name']"
										},
										"sink": {
											"name": "bill_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_property_name']"
										},
										"sink": {
											"name": "bill_property_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_state']"
										},
										"sink": {
											"name": "bill_state",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_to_swt']"
										},
										"sink": {
											"name": "bill_to_swt",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_zip']"
										},
										"sink": {
											"name": "bill_zip",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bin_attributes']"
										},
										"sink": {
											"name": "bin_attributes",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bins_collected']"
										},
										"sink": {
											"name": "bins_collected",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['booking_custom_price']"
										},
										"sink": {
											"name": "booking_custom_price",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['booking_id']"
										},
										"sink": {
											"name": "booking_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['booking_update_flag']"
										},
										"sink": {
											"name": "booking_update_flag",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['chargeable']"
										},
										"sink": {
											"name": "chargeable",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['cont_id']"
										},
										"sink": {
											"name": "cont_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['container_id']"
										},
										"sink": {
											"name": "container_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['container_size']"
										},
										"sink": {
											"name": "container_size",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['container_type']"
										},
										"sink": {
											"name": "container_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['container_weight']"
										},
										"sink": {
											"name": "container_weight",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['containers']"
										},
										"sink": {
											"name": "containers",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['coord_date']"
										},
										"sink": {
											"name": "coord_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['coord_time']"
										},
										"sink": {
											"name": "coord_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['coord_type']"
										},
										"sink": {
											"name": "coord_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['create_timestamp']"
										},
										"sink": {
											"name": "create_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['create_user_id']"
										},
										"sink": {
											"name": "create_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency_code']"
										},
										"sink": {
											"name": "currency_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cust_cust_ref']"
										},
										"sink": {
											"name": "cust_cust_ref",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['customer']"
										},
										"sink": {
											"name": "customer",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['customer_class']"
										},
										"sink": {
											"name": "customer_class",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['customer_service_line_no']"
										},
										"sink": {
											"name": "customer_service_line_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['default_weight']"
										},
										"sink": {
											"name": "default_weight",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['delivery_serial_no']"
										},
										"sink": {
											"name": "delivery_serial_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['delivery_site_number']"
										},
										"sink": {
											"name": "delivery_site_number",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['delivery_site_type']"
										},
										"sink": {
											"name": "delivery_site_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Department']"
										},
										"sink": {
											"name": "Department",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['destruction_batch_no']"
										},
										"sink": {
											"name": "destruction_batch_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['destruction_certificate_required']"
										},
										"sink": {
											"name": "destruction_certificate_required",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type']"
										},
										"sink": {
											"name": "disposal_charge_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_incl_charge']"
										},
										"sink": {
											"name": "disposal_incl_charge",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['disposal_ticket']"
										},
										"sink": {
											"name": "disposal_ticket",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['driver']"
										},
										"sink": {
											"name": "driver",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['driver_comments']"
										},
										"sink": {
											"name": "driver_comments",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['driver_docket_no']"
										},
										"sink": {
											"name": "driver_docket_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['driver_seq_no']"
										},
										"sink": {
											"name": "driver_seq_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['email_address']"
										},
										"sink": {
											"name": "email_address",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Exported']"
										},
										"sink": {
											"name": "Exported",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['geocode_x']"
										},
										"sink": {
											"name": "geocode_x",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['geocode_y']"
										},
										"sink": {
											"name": "geocode_y",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['GetLastestPrice']"
										},
										"sink": {
											"name": "GetLastestPrice",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['HasAttachment']"
										},
										"sink": {
											"name": "HasAttachment",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['invoice_no']"
										},
										"sink": {
											"name": "invoice_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['InvoiceDescription']"
										},
										"sink": {
											"name": "InvoiceDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['job_end_time']"
										},
										"sink": {
											"name": "job_end_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['job_hours']"
										},
										"sink": {
											"name": "job_hours",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['job_serviced_date']"
										},
										"sink": {
											"name": "job_serviced_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['job_start_time']"
										},
										"sink": {
											"name": "job_start_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jrl_no']"
										},
										"sink": {
											"name": "jrl_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['ledger_account']"
										},
										"sink": {
											"name": "ledger_account",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['linked_trans_no']"
										},
										"sink": {
											"name": "linked_trans_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['linked_trans_seq_no']"
										},
										"sink": {
											"name": "linked_trans_seq_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['map_reference']"
										},
										"sink": {
											"name": "map_reference",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mdt_cash_payment']"
										},
										"sink": {
											"name": "mdt_cash_payment",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['meters_collected']"
										},
										"sink": {
											"name": "meters_collected",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['multi_total_price']"
										},
										"sink": {
											"name": "multi_total_price",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['multi_total_price_ex_tax']"
										},
										"sink": {
											"name": "multi_total_price_ex_tax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['multi_total_tax']"
										},
										"sink": {
											"name": "multi_total_tax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['OldServType']"
										},
										"sink": {
											"name": "OldServType",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['open_flag']"
										},
										"sink": {
											"name": "open_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['order_no']"
										},
										"sink": {
											"name": "order_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['org']"
										},
										"sink": {
											"name": "org",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['p_year']"
										},
										"sink": {
											"name": "p_year",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['paid']"
										},
										"sink": {
											"name": "paid",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['period']"
										},
										"sink": {
											"name": "period",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['phone_2']"
										},
										"sink": {
											"name": "phone_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['PlannedEndTime']"
										},
										"sink": {
											"name": "PlannedEndTime",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['PlannedStartTime']"
										},
										"sink": {
											"name": "PlannedStartTime",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['po_no']"
										},
										"sink": {
											"name": "po_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['prev_trans_status']"
										},
										"sink": {
											"name": "prev_trans_status",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['price_line_no']"
										},
										"sink": {
											"name": "price_line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['price_rate']"
										},
										"sink": {
											"name": "price_rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Priority']"
										},
										"sink": {
											"name": "Priority",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['ProfitCentre']"
										},
										"sink": {
											"name": "ProfitCentre",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['prorated_tip_cost']"
										},
										"sink": {
											"name": "prorated_tip_cost",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['rcti_batch']"
										},
										"sink": {
											"name": "rcti_batch",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['rcti_no']"
										},
										"sink": {
											"name": "rcti_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reason_code']"
										},
										"sink": {
											"name": "reason_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['removal_serial_no']"
										},
										"sink": {
											"name": "removal_serial_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['removal_site_number']"
										},
										"sink": {
											"name": "removal_site_number",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['removal_site_type']"
										},
										"sink": {
											"name": "removal_site_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_directions_1']"
										},
										"sink": {
											"name": "route_directions_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_directions_2']"
										},
										"sink": {
											"name": "route_directions_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_directions_3']"
										},
										"sink": {
											"name": "route_directions_3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_directions_4']"
										},
										"sink": {
											"name": "route_directions_4",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_no']"
										},
										"sink": {
											"name": "route_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['run_gen_batch']"
										},
										"sink": {
											"name": "run_gen_batch",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['SendTipFeeAttachments']"
										},
										"sink": {
											"name": "SendTipFeeAttachments",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['sent_flag']"
										},
										"sink": {
											"name": "sent_flag",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_addr_1']"
										},
										"sink": {
											"name": "serv_addr_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_addr_2']"
										},
										"sink": {
											"name": "serv_addr_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_city']"
										},
										"sink": {
											"name": "serv_city",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_code']"
										},
										"sink": {
											"name": "serv_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_contact']"
										},
										"sink": {
											"name": "serv_contact",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_country']"
										},
										"sink": {
											"name": "serv_country",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_desc_1']"
										},
										"sink": {
											"name": "serv_desc_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_desc_2']"
										},
										"sink": {
											"name": "serv_desc_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_desc_3']"
										},
										"sink": {
											"name": "serv_desc_3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_desc_4']"
										},
										"sink": {
											"name": "serv_desc_4",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_name']"
										},
										"sink": {
											"name": "serv_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_no']"
										},
										"sink": {
											"name": "serv_no",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['serv_phone']"
										},
										"sink": {
											"name": "serv_phone",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_property_name']"
										},
										"sink": {
											"name": "serv_property_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_state']"
										},
										"sink": {
											"name": "serv_state",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_time_code']"
										},
										"sink": {
											"name": "serv_time_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_type']"
										},
										"sink": {
											"name": "serv_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_zip']"
										},
										"sink": {
											"name": "serv_zip",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['service_line_no']"
										},
										"sink": {
											"name": "service_line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['service_version']"
										},
										"sink": {
											"name": "service_version"
										}
									},
									{
										"source": {
											"path": "[['site_number']"
										},
										"sink": {
											"name": "site_number",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['status']"
										},
										"sink": {
											"name": "status",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['temp_code']"
										},
										"sink": {
											"name": "temp_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['TempLedgerAccount']"
										},
										"sink": {
											"name": "TempLedgerAccount",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ticket_required']"
										},
										"sink": {
											"name": "ticket_required",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['tip_fee']"
										},
										"sink": {
											"name": "tip_fee",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total_price']"
										},
										"sink": {
											"name": "total_price",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_price_ex_tax']"
										},
										"sink": {
											"name": "total_price_ex_tax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['trans_date']"
										},
										"sink": {
											"name": "trans_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['trans_entry_date']"
										},
										"sink": {
											"name": "trans_entry_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['trans_entry_id']"
										},
										"sink": {
											"name": "trans_entry_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['trans_entry_time']"
										},
										"sink": {
											"name": "trans_entry_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['trans_no']"
										},
										"sink": {
											"name": "trans_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['trans_seq_no']"
										},
										"sink": {
											"name": "trans_seq_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['trans_update_date']"
										},
										"sink": {
											"name": "trans_update_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['trans_update_id']"
										},
										"sink": {
											"name": "trans_update_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['trans_update_time']"
										},
										"sink": {
											"name": "trans_update_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['truck_no']"
										},
										"sink": {
											"name": "truck_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['update_user_id']"
										},
										"sink": {
											"name": "update_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['updated']"
										},
										"sink": {
											"name": "updated",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['UpdateProgram']"
										},
										"sink": {
											"name": "UpdateProgram",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['usePriceCode']"
										},
										"sink": {
											"name": "usePriceCode",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['user_id']"
										},
										"sink": {
											"name": "user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['vehicle_class']"
										},
										"sink": {
											"name": "vehicle_class",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['waste_type']"
										},
										"sink": {
											"name": "waste_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['WasteOutcome']"
										},
										"sink": {
											"name": "WasteOutcome",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['we_equip_codes']"
										},
										"sink": {
											"name": "we_equip_codes",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['we_helpers']"
										},
										"sink": {
											"name": "we_helpers",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['we_price']"
										},
										"sink": {
											"name": "we_price",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['we_price_code']"
										},
										"sink": {
											"name": "we_price_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['we_price_discount_label']"
										},
										"sink": {
											"name": "we_price_discount_label",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['we_tax']"
										},
										"sink": {
											"name": "we_tax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['zone_no']"
										},
										"sink": {
											"name": "zone_no",
											"type": "Int32"
										}
									}
								],
								"collectionReference": "$['result']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@concat(variables('StartDate'), '_', variables('EndDate'))",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "@split(variables('varApiInstance_Booking'), '/')[0]",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "@split(variables('varApiInstance_Booking'), '/')[1]",
										"type": "Expression"
									},
									"Instance": {
										"value": "@pipeline().parameters.Instance",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSqlTable1",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "@concat(split(variables('varApiInstance_Booking'), '/')[1], '_', pipeline().parameters.Instance)",
										"type": "Expression"
									},
									"SchemaName": "sarahe"
								}
							}
						]
					},
					{
						"name": "Script Check Things",
						"type": "Script",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "select current_user as [currentUser]"
								}
							],
							"scriptBlockExecutionTimeout": "02:00:00",
							"logSettings": {
								"logDestination": "ActivityOutput"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"queryDataDayOffset": {
						"type": "int",
						"defaultValue": 0
					},
					"Instance": {
						"type": "string",
						"defaultValue": "wsgvic"
					}
				},
				"variables": {
					"StartDate": {
						"type": "String"
					},
					"EndDate": {
						"type": "String"
					},
					"varApiInstance_Booking": {
						"type": "String",
						"defaultValue": "booking/booking"
					}
				},
				"folder": {
					"name": "SaraHe"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:59:26Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/AzureSqlTable1')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabase1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_SaraTest_CopyInvoiceLedger')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Sara's test pipeline to download Invoice Ledger data from Wastedge API",
				"activities": [
					{
						"name": "ForEach Invoice Period",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@pipeline().parameters.queryInvoiceMonthOffset",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Download InvoicePeriodCharge",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set API Query Year",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true",
												"QueryParameters.$start": "$.next_result",
												"EndCondition:$.has_more": "Const:false"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "RestResource_WastedgeAPI_WSGVIC",
											"type": "DatasetReference",
											"parameters": {
												"restRelativeUrl": {
													"value": "@concat(variables('varApiInstance'),'?$query=p_year=','''', variables('varApiQueryYear'),'''',' and period=','''', variables('varApiQueryPeriod'), '''')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@concat('year-', variables('varApiQueryYear'), '-period-', variables('varApiQueryPeriod'))",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "@split(variables('varApiInstance'), '/')[0]",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "@split(variables('varApiInstance'), '/')[1]",
													"type": "Expression"
												},
												"Instance": {
													"value": "@pipeline().parameters.Instance",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Set Invoice Month",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "varInvoiceMonth",
										"value": {
											"value": "@addToTime(pipeline().TriggerTime, item(), 'Month')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set API Query Period",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set Invoice Month",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "varApiQueryPeriod",
										"value": {
											"value": "@formatDateTime(addToTime(variables('varInvoiceMonth'), -6, 'Month'), '%M')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Load InvoicePeriodCharge Data to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Download InvoicePeriodCharge",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": false,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"p_year",
													"period"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Chargeable']"
													},
													"sink": {
														"name": "Chargeable",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['cust_number']"
													},
													"sink": {
														"name": "cust_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['department']"
													},
													"sink": {
														"name": "department",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Desc_L1']"
													},
													"sink": {
														"name": "Desc_L1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['displayOrder']"
													},
													"sink": {
														"name": "displayOrder",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['invoice_no']"
													},
													"sink": {
														"name": "invoice_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ItemChargeType']"
													},
													"sink": {
														"name": "ItemChargeType",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['jrl_no']"
													},
													"sink": {
														"name": "jrl_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_no']"
													},
													"sink": {
														"name": "line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['p_year']"
													},
													"sink": {
														"name": "p_year",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['p_year_period_jrl_no']"
													},
													"sink": {
														"name": "p_year_period_jrl_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Paid']"
													},
													"sink": {
														"name": "Paid",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['period']"
													},
													"sink": {
														"name": "period",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PeriodTax']"
													},
													"sink": {
														"name": "PeriodTax",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['PeriodTaxPercent']"
													},
													"sink": {
														"name": "PeriodTaxPercent",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['PeriodTotal']"
													},
													"sink": {
														"name": "PeriodTotal",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['PO']"
													},
													"sink": {
														"name": "PO",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Price']"
													},
													"sink": {
														"name": "Price",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['price_line_no']"
													},
													"sink": {
														"name": "price_line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['profitCentre']"
													},
													"sink": {
														"name": "profitCentre",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Qty']"
													},
													"sink": {
														"name": "Qty",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Rate']"
													},
													"sink": {
														"name": "Rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['SiteHeaderText']"
													},
													"sink": {
														"name": "SiteHeaderText",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ZeroCharge']"
													},
													"sink": {
														"name": "ZeroCharge",
														"type": "Boolean"
													}
												}
											],
											"collectionReference": "$['result']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@concat('year-', variables('varApiQueryYear'), '-period-', variables('varApiQueryPeriod'))",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "@split(variables('varApiInstance'), '/')[0]",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "@split(variables('varApiInstance'), '/')[1]",
													"type": "Expression"
												},
												"Instance": {
													"value": "@pipeline().parameters.Instance",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "AzureSqlTable1",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat(split(variables('varApiInstance'), '/')[1], '_', pipeline().parameters.Instance)",
													"type": "Expression"
												},
												"SchemaName": "sarahe"
											}
										}
									]
								},
								{
									"name": "Set API Query Year",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set API Query Period",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "varApiQueryYear",
										"value": {
											"value": "@formatDateTime(\n\taddToTime(\n\t\tvariables('varInvoiceMonth')\n\t\t, if(\n\t\t\t\tlessOrEquals(\n\t\t\t\t\tint(variables('varApiQueryPeriod')), 6)\n\t\t\t\t, 1, 0\n\t\t\t)\n\t\t, 'year', 'yyyy-MM-dd')\n, 'yyyy')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set Debug Msg",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set API Query Year",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "debugMsg",
										"value": {
											"value": "@concat(variables('varApiInstance'),'?$query=period=','''', variables('varApiQueryPeriod'),'''','and p_year =','''', variables('varApiQueryYear'), '''')\n",
											"type": "Expression"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"queryInvoiceMonthOffset": {
						"type": "array",
						"defaultValue": [
							-2,
							-1
						]
					},
					"Instance": {
						"type": "string",
						"defaultValue": "wsgvic"
					}
				},
				"variables": {
					"varApiQueryPeriod": {
						"type": "String"
					},
					"varInvoiceMonth": {
						"type": "String"
					},
					"varApiInstance": {
						"type": "String",
						"defaultValue": "invoicing/invoice_period_charge"
					},
					"varApiQueryYear": {
						"type": "String"
					},
					"debugMsg": {
						"type": "String"
					},
					"varInvoiceMonthOffset": {
						"type": "Integer"
					}
				},
				"folder": {
					"name": "SaraHe"
				},
				"annotations": [],
				"lastPublishTime": "2024-03-01T04:03:13Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestResource_WastedgeAPI_WSGVIC')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/AzureSqlTable1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_SystemAPI')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Vendor Disposal Rate to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy to DataLake WSG VIC_copy1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['ledger_account']"
										},
										"sink": {
											"name": "ledger_account",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ledger_account_RI']"
										},
										"sink": {
											"name": "ledger_account_RI",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Levy1Desc']"
										},
										"sink": {
											"name": "Levy1Desc",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Levy1Rate']"
										},
										"sink": {
											"name": "Levy1Rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Levy1Type']"
										},
										"sink": {
											"name": "Levy1Type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_rate']"
										},
										"sink": {
											"name": "tip_rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tip_rate2']"
										},
										"sink": {
											"name": "tip_rate2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tip_rate3']"
										},
										"sink": {
											"name": "tip_rate3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tip_rate_charge']"
										},
										"sink": {
											"name": "tip_rate_charge",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tip_rate_charge2']"
										},
										"sink": {
											"name": "tip_rate_charge2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tip_rate_charge3']"
										},
										"sink": {
											"name": "tip_rate_charge3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tip_rate_charge_ex']"
										},
										"sink": {
											"name": "tip_rate_charge_ex",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tip_rate_desc']"
										},
										"sink": {
											"name": "tip_rate_desc",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_rate_desc2']"
										},
										"sink": {
											"name": "tip_rate_desc2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_rate_desc3']"
										},
										"sink": {
											"name": "tip_rate_desc3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_rate_type']"
										},
										"sink": {
											"name": "tip_rate_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_rate_type2']"
										},
										"sink": {
											"name": "tip_rate_type2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_rate_type3']"
										},
										"sink": {
											"name": "tip_rate_type3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_rate_type_ex']"
										},
										"sink": {
											"name": "tip_rate_type_ex",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_rate_uom']"
										},
										"sink": {
											"name": "tip_rate_uom",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UpdateProgram']"
										},
										"sink": {
											"name": "UpdateProgram",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UpdateUserID']"
										},
										"sink": {
											"name": "UpdateUserID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['vendor_no']"
										},
										"sink": {
											"name": "vendor_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['waste_type']"
										},
										"sink": {
											"name": "waste_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['weight_limit_ex']"
										},
										"sink": {
											"name": "weight_limit_ex",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['weight_limit_ex2']"
										},
										"sink": {
											"name": "weight_limit_ex2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['weight_limit_ex3']"
										},
										"sink": {
											"name": "weight_limit_ex3",
											"type": "Decimal"
										}
									}
								],
								"collectionReference": "$['result']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "system",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "vendor_disposal_rate",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgnsw",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "vendor_disposal_rate_wsgnsw",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy to DataLake WSG VIC_copy1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "WSGNSW",
								"type": "DatasetReference",
								"parameters": {
									"Dataset": {
										"value": "system/vendor_disposal_rate?$query=tip_rate3 = 0",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "system",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "vendor_disposal_rate",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgnsw",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]",
				"[concat(variables('factoryId'), '/datasets/WSGNSW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Tip_Fee')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set Start Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "StartDate",
							"value": {
								"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set End Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "EndDATE",
							"value": {
								"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'YYYY-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Debug",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "DEBUG",
							"value": {
								"value": "@concat('vehicle/tip_fee?$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set Start Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set End Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Debug",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI_Date",
								"type": "DatasetReference",
								"parameters": {
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "vehicle/tip_fee",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "tipfee",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "tip_fee",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"ID"
									]
								},
								"sqlWriterUseTableLock": true,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['alt_qty']"
										},
										"sink": {
											"name": "alt_qty",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['alt_qty_unit']"
										},
										"sink": {
											"name": "alt_qty_unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['booking']"
										},
										"sink": {
											"name": "booking",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['branch']"
										},
										"sink": {
											"name": "branch",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cont_id']"
										},
										"sink": {
											"name": "cont_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['coord_date']"
										},
										"sink": {
											"name": "coord_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['coord_time']"
										},
										"sink": {
											"name": "coord_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['coord_type']"
										},
										"sink": {
											"name": "coord_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['create_timestamp']"
										},
										"sink": {
											"name": "create_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['create_user_id']"
										},
										"sink": {
											"name": "create_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['customer']"
										},
										"sink": {
											"name": "customer",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['date_accrual']"
										},
										"sink": {
											"name": "date_accrual",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['date_approved']"
										},
										"sink": {
											"name": "date_approved",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['date_paid']"
										},
										"sink": {
											"name": "date_paid",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_desc']"
										},
										"sink": {
											"name": "disposal_charge_desc",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_desc2']"
										},
										"sink": {
											"name": "disposal_charge_desc2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_desc3']"
										},
										"sink": {
											"name": "disposal_charge_desc3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate']"
										},
										"sink": {
											"name": "disposal_charge_rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate2']"
										},
										"sink": {
											"name": "disposal_charge_rate2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate3']"
										},
										"sink": {
											"name": "disposal_charge_rate3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate_ex']"
										},
										"sink": {
											"name": "disposal_charge_rate_ex",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate_ex2']"
										},
										"sink": {
											"name": "disposal_charge_rate_ex2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate_ex3']"
										},
										"sink": {
											"name": "disposal_charge_rate_ex3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type']"
										},
										"sink": {
											"name": "disposal_charge_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type2']"
										},
										"sink": {
											"name": "disposal_charge_type2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type3']"
										},
										"sink": {
											"name": "disposal_charge_type3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type_ex']"
										},
										"sink": {
											"name": "disposal_charge_type_ex",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type_ex2']"
										},
										"sink": {
											"name": "disposal_charge_type_ex2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type_ex3']"
										},
										"sink": {
											"name": "disposal_charge_type_ex3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_cost_rate']"
										},
										"sink": {
											"name": "disposal_cost_rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_cost_rate2']"
										},
										"sink": {
											"name": "disposal_cost_rate2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_cost_rate3']"
										},
										"sink": {
											"name": "disposal_cost_rate3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_cost_rate_ex']"
										},
										"sink": {
											"name": "disposal_cost_rate_ex",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_cost_rate_type']"
										},
										"sink": {
											"name": "disposal_cost_rate_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_date']"
										},
										"sink": {
											"name": "disposal_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['disposal_incl_charge']"
										},
										"sink": {
											"name": "disposal_incl_charge",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['disposal_site']"
										},
										"sink": {
											"name": "disposal_site",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_weight_limit_ex']"
										},
										"sink": {
											"name": "disposal_weight_limit_ex",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_weight_limit_ex2']"
										},
										"sink": {
											"name": "disposal_weight_limit_ex2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_weight_limit_ex3']"
										},
										"sink": {
											"name": "disposal_weight_limit_ex3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['DisposalServiceFunction']"
										},
										"sink": {
											"name": "DisposalServiceFunction",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['docket_no']"
										},
										"sink": {
											"name": "docket_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['driver']"
										},
										"sink": {
											"name": "driver",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ExternalWeight']"
										},
										"sink": {
											"name": "ExternalWeight",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['geocode_x']"
										},
										"sink": {
											"name": "geocode_x",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['geocode_y']"
										},
										"sink": {
											"name": "geocode_y",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['invoice_number']"
										},
										"sink": {
											"name": "invoice_number",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Levy1Desc']"
										},
										"sink": {
											"name": "Levy1Desc",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Levy1Rate']"
										},
										"sink": {
											"name": "Levy1Rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Levy1Type']"
										},
										"sink": {
											"name": "Levy1Type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['odometer']"
										},
										"sink": {
											"name": "odometer",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['plate_no']"
										},
										"sink": {
											"name": "plate_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route']"
										},
										"sink": {
											"name": "route",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_date']"
										},
										"sink": {
											"name": "route_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['route_summary']"
										},
										"sink": {
											"name": "route_summary",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['seq_no']"
										},
										"sink": {
											"name": "seq_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['serial_no']"
										},
										"sink": {
											"name": "serial_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['shift_no']"
										},
										"sink": {
											"name": "shift_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ticket_number']"
										},
										"sink": {
											"name": "ticket_number",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ticket_number_old']"
										},
										"sink": {
											"name": "ticket_number_old",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['tip_in_time']"
										},
										"sink": {
											"name": "tip_in_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_out_time']"
										},
										"sink": {
											"name": "tip_out_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_sub_loc_no']"
										},
										"sink": {
											"name": "tip_sub_loc_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_visit_time']"
										},
										"sink": {
											"name": "tip_visit_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total_charge']"
										},
										"sink": {
											"name": "total_charge",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_cost']"
										},
										"sink": {
											"name": "total_cost",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_cost_entered']"
										},
										"sink": {
											"name": "total_cost_entered",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['trans_no']"
										},
										"sink": {
											"name": "trans_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['trans_seq']"
										},
										"sink": {
											"name": "trans_seq",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['transmit_no']"
										},
										"sink": {
											"name": "transmit_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['truck']"
										},
										"sink": {
											"name": "truck",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['update_user_id']"
										},
										"sink": {
											"name": "update_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UpdateProgram']"
										},
										"sink": {
											"name": "UpdateProgram",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['user_approved']"
										},
										"sink": {
											"name": "user_approved",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['volume']"
										},
										"sink": {
											"name": "volume",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['volume_unit']"
										},
										"sink": {
											"name": "volume_unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['waste_type']"
										},
										"sink": {
											"name": "waste_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['weight']"
										},
										"sink": {
											"name": "weight",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['weight_max']"
										},
										"sink": {
											"name": "weight_max",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['weight_min']"
										},
										"sink": {
											"name": "weight_min",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['weight_orig']"
										},
										"sink": {
											"name": "weight_orig",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['weight_unit']"
										},
										"sink": {
											"name": "weight_unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['WeightIn']"
										},
										"sink": {
											"name": "WeightIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['WeightOut']"
										},
										"sink": {
											"name": "WeightOut",
											"type": "Decimal"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "tipfee",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "tip_fee",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "tip_fee_wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"StartDate": {
						"type": "String"
					},
					"EndDATE": {
						"type": "String"
					},
					"DEBUG": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Vehicle"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Tip_Fee_test')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set Start Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "StartDate",
							"value": {
								"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set End Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "EndDATE",
							"value": {
								"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'YYYY-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Debug",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "DEBUG",
							"value": {
								"value": "@concat('vehicle/tip_fee?$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set Start Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set End Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Debug",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"ID"
									]
								},
								"sqlWriterUseTableLock": true,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['alt_qty']"
										},
										"sink": {
											"name": "alt_qty",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['alt_qty_unit']"
										},
										"sink": {
											"name": "alt_qty_unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['booking']"
										},
										"sink": {
											"name": "booking",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['branch']"
										},
										"sink": {
											"name": "branch",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cont_id']"
										},
										"sink": {
											"name": "cont_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['coord_date']"
										},
										"sink": {
											"name": "coord_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['coord_time']"
										},
										"sink": {
											"name": "coord_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['coord_type']"
										},
										"sink": {
											"name": "coord_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['create_timestamp']"
										},
										"sink": {
											"name": "create_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['create_user_id']"
										},
										"sink": {
											"name": "create_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['customer']"
										},
										"sink": {
											"name": "customer",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['date_accrual']"
										},
										"sink": {
											"name": "date_accrual",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['date_approved']"
										},
										"sink": {
											"name": "date_approved",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['date_paid']"
										},
										"sink": {
											"name": "date_paid",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_desc']"
										},
										"sink": {
											"name": "disposal_charge_desc",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_desc2']"
										},
										"sink": {
											"name": "disposal_charge_desc2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_desc3']"
										},
										"sink": {
											"name": "disposal_charge_desc3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate']"
										},
										"sink": {
											"name": "disposal_charge_rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate2']"
										},
										"sink": {
											"name": "disposal_charge_rate2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate3']"
										},
										"sink": {
											"name": "disposal_charge_rate3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate_ex']"
										},
										"sink": {
											"name": "disposal_charge_rate_ex",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate_ex2']"
										},
										"sink": {
											"name": "disposal_charge_rate_ex2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate_ex3']"
										},
										"sink": {
											"name": "disposal_charge_rate_ex3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type']"
										},
										"sink": {
											"name": "disposal_charge_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type2']"
										},
										"sink": {
											"name": "disposal_charge_type2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type3']"
										},
										"sink": {
											"name": "disposal_charge_type3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type_ex']"
										},
										"sink": {
											"name": "disposal_charge_type_ex",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type_ex2']"
										},
										"sink": {
											"name": "disposal_charge_type_ex2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type_ex3']"
										},
										"sink": {
											"name": "disposal_charge_type_ex3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_cost_rate']"
										},
										"sink": {
											"name": "disposal_cost_rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_cost_rate2']"
										},
										"sink": {
											"name": "disposal_cost_rate2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_cost_rate3']"
										},
										"sink": {
											"name": "disposal_cost_rate3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_cost_rate_ex']"
										},
										"sink": {
											"name": "disposal_cost_rate_ex",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_cost_rate_type']"
										},
										"sink": {
											"name": "disposal_cost_rate_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_date']"
										},
										"sink": {
											"name": "disposal_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['disposal_incl_charge']"
										},
										"sink": {
											"name": "disposal_incl_charge",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['disposal_site']"
										},
										"sink": {
											"name": "disposal_site",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_weight_limit_ex']"
										},
										"sink": {
											"name": "disposal_weight_limit_ex",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_weight_limit_ex2']"
										},
										"sink": {
											"name": "disposal_weight_limit_ex2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_weight_limit_ex3']"
										},
										"sink": {
											"name": "disposal_weight_limit_ex3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['DisposalServiceFunction']"
										},
										"sink": {
											"name": "DisposalServiceFunction",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['docket_no']"
										},
										"sink": {
											"name": "docket_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['driver']"
										},
										"sink": {
											"name": "driver",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ExternalWeight']"
										},
										"sink": {
											"name": "ExternalWeight",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['geocode_x']"
										},
										"sink": {
											"name": "geocode_x",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['geocode_y']"
										},
										"sink": {
											"name": "geocode_y",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['invoice_number']"
										},
										"sink": {
											"name": "invoice_number",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Levy1Desc']"
										},
										"sink": {
											"name": "Levy1Desc",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Levy1Rate']"
										},
										"sink": {
											"name": "Levy1Rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Levy1Type']"
										},
										"sink": {
											"name": "Levy1Type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['odometer']"
										},
										"sink": {
											"name": "odometer",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['plate_no']"
										},
										"sink": {
											"name": "plate_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route']"
										},
										"sink": {
											"name": "route",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_date']"
										},
										"sink": {
											"name": "route_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['route_summary']"
										},
										"sink": {
											"name": "route_summary",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['seq_no']"
										},
										"sink": {
											"name": "seq_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['serial_no']"
										},
										"sink": {
											"name": "serial_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['shift_no']"
										},
										"sink": {
											"name": "shift_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ticket_number']"
										},
										"sink": {
											"name": "ticket_number",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ticket_number_old']"
										},
										"sink": {
											"name": "ticket_number_old",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['tip_in_time']"
										},
										"sink": {
											"name": "tip_in_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_out_time']"
										},
										"sink": {
											"name": "tip_out_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_sub_loc_no']"
										},
										"sink": {
											"name": "tip_sub_loc_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['tip_visit_time']"
										},
										"sink": {
											"name": "tip_visit_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total_charge']"
										},
										"sink": {
											"name": "total_charge",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_cost']"
										},
										"sink": {
											"name": "total_cost",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_cost_entered']"
										},
										"sink": {
											"name": "total_cost_entered",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['trans_no']"
										},
										"sink": {
											"name": "trans_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['trans_seq']"
										},
										"sink": {
											"name": "trans_seq",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['transmit_no']"
										},
										"sink": {
											"name": "transmit_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['truck']"
										},
										"sink": {
											"name": "truck",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['update_user_id']"
										},
										"sink": {
											"name": "update_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UpdateProgram']"
										},
										"sink": {
											"name": "UpdateProgram",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['user_approved']"
										},
										"sink": {
											"name": "user_approved",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['volume']"
										},
										"sink": {
											"name": "volume",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['volume_unit']"
										},
										"sink": {
											"name": "volume_unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['waste_type']"
										},
										"sink": {
											"name": "waste_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['weight']"
										},
										"sink": {
											"name": "weight",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['weight_max']"
										},
										"sink": {
											"name": "weight_max",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['weight_min']"
										},
										"sink": {
											"name": "weight_min",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['weight_orig']"
										},
										"sink": {
											"name": "weight_orig",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['weight_unit']"
										},
										"sink": {
											"name": "weight_unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['WeightIn']"
										},
										"sink": {
											"name": "WeightIn",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['WeightOut']"
										},
										"sink": {
											"name": "WeightOut",
											"type": "Decimal"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "tipfee",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "tip_fee",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "tip_fee_wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"StartDate": {
						"type": "String"
					},
					"EndDATE": {
						"type": "String"
					},
					"DEBUG": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Vehicle"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Vehicle')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI",
								"type": "DatasetReference",
								"parameters": {
									"Dataset": {
										"value": "vehicle/vehicle",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@formatDateTime(utcNow(),'yyyy-MM-dd')",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "vehicle",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "vehicle",
										"type": "Expression"
									},
									"Instance": "vic"
								}
							}
						]
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['authoristation_no']"
										},
										"sink": {
											"name": "authoristation_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['branch']"
										},
										"sink": {
											"name": "branch",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['CallSign']"
										},
										"sink": {
											"name": "CallSign",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cert_waste_type']"
										},
										"sink": {
											"name": "cert_waste_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['class']"
										},
										"sink": {
											"name": "class",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['container_type']"
										},
										"sink": {
											"name": "container_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['current_hour_meter']"
										},
										"sink": {
											"name": "current_hour_meter",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['current_odometer']"
										},
										"sink": {
											"name": "current_odometer",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['current_reading_date']"
										},
										"sink": {
											"name": "current_reading_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['cust_number']"
										},
										"sink": {
											"name": "cust_number",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['customer_truck']"
										},
										"sink": {
											"name": "customer_truck",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['Disabled']"
										},
										"sink": {
											"name": "Disabled",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['last_pm_code']"
										},
										"sink": {
											"name": "last_pm_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['last_pm_date']"
										},
										"sink": {
											"name": "last_pm_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['last_pm_hour_meter']"
										},
										"sink": {
											"name": "last_pm_hour_meter",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['last_pm_odometer']"
										},
										"sink": {
											"name": "last_pm_odometer",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['last_pm_order_no']"
										},
										"sink": {
											"name": "last_pm_order_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['last_waste_type']"
										},
										"sink": {
											"name": "last_waste_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ledger_account']"
										},
										"sink": {
											"name": "ledger_account",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ledger_account_RI']"
										},
										"sink": {
											"name": "ledger_account_RI",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['MaximumWeight']"
										},
										"sink": {
											"name": "MaximumWeight",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['MDTserial']"
										},
										"sink": {
											"name": "MDTserial",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['min_tonnage']"
										},
										"sink": {
											"name": "min_tonnage",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['plate_no']"
										},
										"sink": {
											"name": "plate_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['registered_gross_mass']"
										},
										"sink": {
											"name": "registered_gross_mass",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tare_average']"
										},
										"sink": {
											"name": "tare_average",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tare_date_1']"
										},
										"sink": {
											"name": "tare_date_1",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['tare_date_2']"
										},
										"sink": {
											"name": "tare_date_2",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['tare_date_3']"
										},
										"sink": {
											"name": "tare_date_3",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['tare_date_4']"
										},
										"sink": {
											"name": "tare_date_4",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['tare_date_5']"
										},
										"sink": {
											"name": "tare_date_5",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['tare_date_6']"
										},
										"sink": {
											"name": "tare_date_6",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['tare_date_7']"
										},
										"sink": {
											"name": "tare_date_7",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['tare_date_8']"
										},
										"sink": {
											"name": "tare_date_8",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['tare_date_9']"
										},
										"sink": {
											"name": "tare_date_9",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['tare_date_10']"
										},
										"sink": {
											"name": "tare_date_10",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['tare_expiry']"
										},
										"sink": {
											"name": "tare_expiry",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['tare_wgt_1']"
										},
										"sink": {
											"name": "tare_wgt_1",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tare_wgt_2']"
										},
										"sink": {
											"name": "tare_wgt_2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tare_wgt_3']"
										},
										"sink": {
											"name": "tare_wgt_3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tare_wgt_4']"
										},
										"sink": {
											"name": "tare_wgt_4",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tare_wgt_5']"
										},
										"sink": {
											"name": "tare_wgt_5",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tare_wgt_6']"
										},
										"sink": {
											"name": "tare_wgt_6",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tare_wgt_7']"
										},
										"sink": {
											"name": "tare_wgt_7",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tare_wgt_8']"
										},
										"sink": {
											"name": "tare_wgt_8",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tare_wgt_9']"
										},
										"sink": {
											"name": "tare_wgt_9",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['tare_wgt_10']"
										},
										"sink": {
											"name": "tare_wgt_10",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['truck_no']"
										},
										"sink": {
											"name": "truck_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['valid_from_date']"
										},
										"sink": {
											"name": "valid_from_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['valid_to_date']"
										},
										"sink": {
											"name": "valid_to_date",
											"type": "DateTime"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "vehicle",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "vehicle",
										"type": "Expression"
									},
									"Instance": "vic"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "vehicle",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Vehicle"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_WSG_DateQuery')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "For Each Entity",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('Entity')",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Copy WSG VIC to Data Lake",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set StartDate",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Set End Date",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Set Debug",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"additionalColumns": [
												{
													"name": "Instance",
													"value": "wsgvic"
												}
											],
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true",
												"EndCondition:$.has_more": "Const:false",
												"QueryParameters.$start": "$.next_result"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "RestAPI_Date",
											"type": "DatasetReference",
											"parameters": {
												"pStartDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"pEndDate": {
													"value": "@pipeline().parameters.pEndDate",
													"type": "Expression"
												},
												"API_Instance": {
													"value": "@split(item(),'.')[1]",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "@split(item(),'.')[0]",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"Instance": {
													"value": "wsgvic",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Set StartDate",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "StartDate",
										"value": {
											"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set End Date",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "EndDate",
										"value": {
											"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'yyyy-MM-dd')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set Debug",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "Debug",
										"value": {
											"value": "@concat(item(),'$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Copy WFLEX to Data Lake",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Copy WSG VIC to Data Lake",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"additionalColumns": [
												{
													"name": "Instance",
													"value": "wflex"
												}
											],
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true",
												"EndCondition:$.has_more": "Const:false",
												"QueryParameters.$start": "$.next_result"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "WFLEX_date",
											"type": "DatasetReference",
											"parameters": {
												"API_Instance": {
													"value": "@split(item(),'.')[1]",
													"type": "Expression"
												},
												"pStartDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"pEndDate": {
													"value": "@pipeline().parameters.pEndDate",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "@split(item(),'.')[0]",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"Instance": {
													"value": "wflex",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Copy WSG NSW to Data Lake",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Copy WFLEX to Data Lake",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"additionalColumns": [
												{
													"name": "Instance",
													"value": "wsgvic"
												}
											],
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true",
												"EndCondition:$.has_more": "Const:false",
												"QueryParameters.$start": "$.next_result"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "WSGNSW_Date",
											"type": "DatasetReference",
											"parameters": {
												"API_Instance": {
													"value": "@split(item(),'.')[1]",
													"type": "Expression"
												},
												"pStartDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"pEndDate": {
													"value": "@pipeline().parameters.pEndDate",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "@split(item(),'.')[0]",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"Instance": {
													"value": "wsgnsw",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "For Each Instance_copy1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "For Each Entity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('Instance')",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Booking to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Customer to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['add_chg_changed']"
													},
													"sink": {
														"name": "add_chg_changed",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['admin_status']"
													},
													"sink": {
														"name": "admin_status",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_1']"
													},
													"sink": {
														"name": "alt_ref_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_2']"
													},
													"sink": {
														"name": "alt_ref_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_serv_1']"
													},
													"sink": {
														"name": "alt_ref_serv_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_serv_2']"
													},
													"sink": {
														"name": "alt_ref_serv_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['application_id']"
													},
													"sink": {
														"name": "application_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_address_1']"
													},
													"sink": {
														"name": "bill_address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_address_2']"
													},
													"sink": {
														"name": "bill_address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_city']"
													},
													"sink": {
														"name": "bill_city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_name']"
													},
													"sink": {
														"name": "bill_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_property_name']"
													},
													"sink": {
														"name": "bill_property_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_state']"
													},
													"sink": {
														"name": "bill_state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_to_swt']"
													},
													"sink": {
														"name": "bill_to_swt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_zip']"
													},
													"sink": {
														"name": "bill_zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bin_attributes']"
													},
													"sink": {
														"name": "bin_attributes",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bins_collected']"
													},
													"sink": {
														"name": "bins_collected",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['booking_custom_price']"
													},
													"sink": {
														"name": "booking_custom_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['booking_id']"
													},
													"sink": {
														"name": "booking_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['booking_update_flag']"
													},
													"sink": {
														"name": "booking_update_flag",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['chargeable']"
													},
													"sink": {
														"name": "chargeable",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['cont_id']"
													},
													"sink": {
														"name": "cont_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_id']"
													},
													"sink": {
														"name": "container_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_size']"
													},
													"sink": {
														"name": "container_size",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['container_type']"
													},
													"sink": {
														"name": "container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_weight']"
													},
													"sink": {
														"name": "container_weight",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['containers']"
													},
													"sink": {
														"name": "containers",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['coord_date']"
													},
													"sink": {
														"name": "coord_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['coord_time']"
													},
													"sink": {
														"name": "coord_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_type']"
													},
													"sink": {
														"name": "coord_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['currency_code']"
													},
													"sink": {
														"name": "currency_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_cust_ref']"
													},
													"sink": {
														"name": "cust_cust_ref",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer_class']"
													},
													"sink": {
														"name": "customer_class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer_service_line_no']"
													},
													"sink": {
														"name": "customer_service_line_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['default_weight']"
													},
													"sink": {
														"name": "default_weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['delivery_serial_no']"
													},
													"sink": {
														"name": "delivery_serial_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['delivery_site_number']"
													},
													"sink": {
														"name": "delivery_site_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['delivery_site_type']"
													},
													"sink": {
														"name": "delivery_site_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Department']"
													},
													"sink": {
														"name": "Department",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['destruction_batch_no']"
													},
													"sink": {
														"name": "destruction_batch_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['destruction_certificate_required']"
													},
													"sink": {
														"name": "destruction_certificate_required",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type']"
													},
													"sink": {
														"name": "disposal_charge_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_incl_charge']"
													},
													"sink": {
														"name": "disposal_incl_charge",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_ticket']"
													},
													"sink": {
														"name": "disposal_ticket",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['driver_comments']"
													},
													"sink": {
														"name": "driver_comments",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_docket_no']"
													},
													"sink": {
														"name": "driver_docket_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['driver_seq_no']"
													},
													"sink": {
														"name": "driver_seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['eba_codes']"
													},
													"sink": {
														"name": "eba_codes",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['email_address']"
													},
													"sink": {
														"name": "email_address",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Exported']"
													},
													"sink": {
														"name": "Exported",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['fax_no']"
													},
													"sink": {
														"name": "fax_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['GetLastestPrice']"
													},
													"sink": {
														"name": "GetLastestPrice",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['HasAttachment']"
													},
													"sink": {
														"name": "HasAttachment",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['invoice_no']"
													},
													"sink": {
														"name": "invoice_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['InvoiceDescription']"
													},
													"sink": {
														"name": "InvoiceDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['job_end_time']"
													},
													"sink": {
														"name": "job_end_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['job_hours']"
													},
													"sink": {
														"name": "job_hours",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['job_serviced_date']"
													},
													"sink": {
														"name": "job_serviced_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['job_start_time']"
													},
													"sink": {
														"name": "job_start_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['jrl_no']"
													},
													"sink": {
														"name": "jrl_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['linked_trans_no']"
													},
													"sink": {
														"name": "linked_trans_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['linked_trans_seq_no']"
													},
													"sink": {
														"name": "linked_trans_seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['map_reference']"
													},
													"sink": {
														"name": "map_reference",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['mdt_cash_payment']"
													},
													"sink": {
														"name": "mdt_cash_payment",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['meters_collected']"
													},
													"sink": {
														"name": "meters_collected",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['multi_total_price']"
													},
													"sink": {
														"name": "multi_total_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['multi_total_price_ex_tax']"
													},
													"sink": {
														"name": "multi_total_price_ex_tax",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['multi_total_tax']"
													},
													"sink": {
														"name": "multi_total_tax",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['OldServType']"
													},
													"sink": {
														"name": "OldServType",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['open_flag']"
													},
													"sink": {
														"name": "open_flag",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['order_no']"
													},
													"sink": {
														"name": "order_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['p_year']"
													},
													"sink": {
														"name": "p_year",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['paid']"
													},
													"sink": {
														"name": "paid",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['period']"
													},
													"sink": {
														"name": "period",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['phone_2']"
													},
													"sink": {
														"name": "phone_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PlannedEndTime']"
													},
													"sink": {
														"name": "PlannedEndTime",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PlannedStartTime']"
													},
													"sink": {
														"name": "PlannedStartTime",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['po_no']"
													},
													"sink": {
														"name": "po_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['prev_trans_status']"
													},
													"sink": {
														"name": "prev_trans_status",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['price_line_no']"
													},
													"sink": {
														"name": "price_line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['price_rate']"
													},
													"sink": {
														"name": "price_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Priority']"
													},
													"sink": {
														"name": "Priority",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ProfitCentre']"
													},
													"sink": {
														"name": "ProfitCentre",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['prorated_tip_cost']"
													},
													"sink": {
														"name": "prorated_tip_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['rcti_batch']"
													},
													"sink": {
														"name": "rcti_batch",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rcti_no']"
													},
													"sink": {
														"name": "rcti_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['reason_code']"
													},
													"sink": {
														"name": "reason_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['removal_serial_no']"
													},
													"sink": {
														"name": "removal_serial_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['removal_site_number']"
													},
													"sink": {
														"name": "removal_site_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['removal_site_type']"
													},
													"sink": {
														"name": "removal_site_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_1']"
													},
													"sink": {
														"name": "route_directions_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_2']"
													},
													"sink": {
														"name": "route_directions_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_3']"
													},
													"sink": {
														"name": "route_directions_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_4']"
													},
													"sink": {
														"name": "route_directions_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['run_gen_batch']"
													},
													"sink": {
														"name": "run_gen_batch",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SendTipFeeAttachments']"
													},
													"sink": {
														"name": "SendTipFeeAttachments",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['sent_flag']"
													},
													"sink": {
														"name": "sent_flag",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_addr_1']"
													},
													"sink": {
														"name": "serv_addr_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_addr_2']"
													},
													"sink": {
														"name": "serv_addr_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_city']"
													},
													"sink": {
														"name": "serv_city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_contact']"
													},
													"sink": {
														"name": "serv_contact",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_country']"
													},
													"sink": {
														"name": "serv_country",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc_1']"
													},
													"sink": {
														"name": "serv_desc_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc_2']"
													},
													"sink": {
														"name": "serv_desc_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc_3']"
													},
													"sink": {
														"name": "serv_desc_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc_4']"
													},
													"sink": {
														"name": "serv_desc_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_name']"
													},
													"sink": {
														"name": "serv_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_no']"
													},
													"sink": {
														"name": "serv_no",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['serv_phone']"
													},
													"sink": {
														"name": "serv_phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_property_name']"
													},
													"sink": {
														"name": "serv_property_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_state']"
													},
													"sink": {
														"name": "serv_state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_time_code']"
													},
													"sink": {
														"name": "serv_time_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_type']"
													},
													"sink": {
														"name": "serv_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_zip']"
													},
													"sink": {
														"name": "serv_zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['service_line_no']"
													},
													"sink": {
														"name": "service_line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['site_number']"
													},
													"sink": {
														"name": "site_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['status']"
													},
													"sink": {
														"name": "status",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['temp_code']"
													},
													"sink": {
														"name": "temp_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TempLedgerAccount']"
													},
													"sink": {
														"name": "TempLedgerAccount",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_required']"
													},
													"sink": {
														"name": "ticket_required",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['tip_fee']"
													},
													"sink": {
														"name": "tip_fee",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_price']"
													},
													"sink": {
														"name": "total_price",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_price_ex_tax']"
													},
													"sink": {
														"name": "total_price_ex_tax",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trans_date']"
													},
													"sink": {
														"name": "trans_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['trans_entry_date']"
													},
													"sink": {
														"name": "trans_entry_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['trans_entry_id']"
													},
													"sink": {
														"name": "trans_entry_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trans_entry_time']"
													},
													"sink": {
														"name": "trans_entry_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trans_no']"
													},
													"sink": {
														"name": "trans_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['trans_seq_no']"
													},
													"sink": {
														"name": "trans_seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['trans_update_date']"
													},
													"sink": {
														"name": "trans_update_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['trans_update_id']"
													},
													"sink": {
														"name": "trans_update_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trans_update_time']"
													},
													"sink": {
														"name": "trans_update_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['truck_no']"
													},
													"sink": {
														"name": "truck_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['updated']"
													},
													"sink": {
														"name": "updated",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['usePriceCode']"
													},
													"sink": {
														"name": "usePriceCode",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['user_id']"
													},
													"sink": {
														"name": "user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['vehicle_class']"
													},
													"sink": {
														"name": "vehicle_class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WasteOutcome']"
													},
													"sink": {
														"name": "WasteOutcome",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_equip_codes']"
													},
													"sink": {
														"name": "we_equip_codes",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_helpers']"
													},
													"sink": {
														"name": "we_helpers",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_price']"
													},
													"sink": {
														"name": "we_price",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['we_price_code']"
													},
													"sink": {
														"name": "we_price_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_price_discount_label']"
													},
													"sink": {
														"name": "we_price_discount_label",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_tax']"
													},
													"sink": {
														"name": "we_tax",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['zone_no']"
													},
													"sink": {
														"name": "zone_no",
														"type": "Int32"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "booking",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "booking",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('booking_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Customer to DB",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"modifiedDatetimeStart": "2022-12-21T00:00:00.335Z",
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['accounting_acc_no']"
													},
													"sink": {
														"name": "accounting_acc_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['accounting_bal_due_days']"
													},
													"sink": {
														"name": "accounting_bal_due_days",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['accounting_cust_id']"
													},
													"sink": {
														"name": "accounting_cust_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['accounting_vendor_id']"
													},
													"sink": {
														"name": "accounting_vendor_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_1']"
													},
													"sink": {
														"name": "address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_2']"
													},
													"sink": {
														"name": "address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alternate_id']"
													},
													"sink": {
														"name": "alternate_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['anzsic_code']"
													},
													"sink": {
														"name": "anzsic_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['approval_contact']"
													},
													"sink": {
														"name": "approval_contact",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['approval_email']"
													},
													"sink": {
														"name": "approval_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['approval_phone']"
													},
													"sink": {
														"name": "approval_phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['apt_no']"
													},
													"sink": {
														"name": "apt_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AttachmentCategories']"
													},
													"sink": {
														"name": "AttachmentCategories",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AutoStopCreditOff']"
													},
													"sink": {
														"name": "AutoStopCreditOff",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['AutoStopCreditOn']"
													},
													"sink": {
														"name": "AutoStopCreditOn",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['bank_acct_no']"
													},
													"sink": {
														"name": "bank_acct_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bank_name']"
													},
													"sink": {
														"name": "bank_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_cycle']"
													},
													"sink": {
														"name": "bill_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_to_swt']"
													},
													"sink": {
														"name": "bill_to_swt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['book_alt_ref1']"
													},
													"sink": {
														"name": "book_alt_ref1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['book_alt_ref2']"
													},
													"sink": {
														"name": "book_alt_ref2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['BusinessType']"
													},
													"sink": {
														"name": "BusinessType",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cash_account']"
													},
													"sink": {
														"name": "cash_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cash_cardname']"
													},
													"sink": {
														"name": "cash_cardname",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cash_expiry']"
													},
													"sink": {
														"name": "cash_expiry",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cash_method']"
													},
													"sink": {
														"name": "cash_method",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['city']"
													},
													"sink": {
														"name": "city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_1']"
													},
													"sink": {
														"name": "classification_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_2']"
													},
													"sink": {
														"name": "classification_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_3']"
													},
													"sink": {
														"name": "classification_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_4']"
													},
													"sink": {
														"name": "classification_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_5']"
													},
													"sink": {
														"name": "classification_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_6']"
													},
													"sink": {
														"name": "classification_6",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_7']"
													},
													"sink": {
														"name": "classification_7",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_8']"
													},
													"sink": {
														"name": "classification_8",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_9']"
													},
													"sink": {
														"name": "classification_9",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_10']"
													},
													"sink": {
														"name": "classification_10",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contribution_entitlement']"
													},
													"sink": {
														"name": "contribution_entitlement",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['contribution_entitlement_total']"
													},
													"sink": {
														"name": "contribution_entitlement_total",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['coord_date']"
													},
													"sink": {
														"name": "coord_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['coord_time']"
													},
													"sink": {
														"name": "coord_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_type']"
													},
													"sink": {
														"name": "coord_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['country_code']"
													},
													"sink": {
														"name": "country_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['county']"
													},
													"sink": {
														"name": "county",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_date']"
													},
													"sink": {
														"name": "create_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['credit_contact']"
													},
													"sink": {
														"name": "credit_contact",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['credit_email']"
													},
													"sink": {
														"name": "credit_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['credit_limit']"
													},
													"sink": {
														"name": "credit_limit",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['credit_limit_warn_amt']"
													},
													"sink": {
														"name": "credit_limit_warn_amt",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['credit_phone']"
													},
													"sink": {
														"name": "credit_phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CTSName']"
													},
													"sink": {
														"name": "CTSName",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CTSNumber']"
													},
													"sink": {
														"name": "CTSNumber",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['currency_code']"
													},
													"sink": {
														"name": "currency_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_1']"
													},
													"sink": {
														"name": "cust_class_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_2']"
													},
													"sink": {
														"name": "cust_class_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_3']"
													},
													"sink": {
														"name": "cust_class_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_4']"
													},
													"sink": {
														"name": "cust_class_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_5']"
													},
													"sink": {
														"name": "cust_class_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_group']"
													},
													"sink": {
														"name": "cust_group",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_number']"
													},
													"sink": {
														"name": "cust_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['cust_seq_no']"
													},
													"sink": {
														"name": "cust_seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['cust_type']"
													},
													"sink": {
														"name": "cust_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer_class']"
													},
													"sink": {
														"name": "customer_class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cut_off_swt']"
													},
													"sink": {
														"name": "cut_off_swt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_closed_1']"
													},
													"sink": {
														"name": "day_closed_1",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_2']"
													},
													"sink": {
														"name": "day_closed_2",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_3']"
													},
													"sink": {
														"name": "day_closed_3",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_4']"
													},
													"sink": {
														"name": "day_closed_4",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_5']"
													},
													"sink": {
														"name": "day_closed_5",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_6']"
													},
													"sink": {
														"name": "day_closed_6",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_7']"
													},
													"sink": {
														"name": "day_closed_7",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_1']"
													},
													"sink": {
														"name": "day_not_after_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_2']"
													},
													"sink": {
														"name": "day_not_after_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_3']"
													},
													"sink": {
														"name": "day_not_after_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_4']"
													},
													"sink": {
														"name": "day_not_after_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_5']"
													},
													"sink": {
														"name": "day_not_after_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_6']"
													},
													"sink": {
														"name": "day_not_after_6",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_7']"
													},
													"sink": {
														"name": "day_not_after_7",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_1']"
													},
													"sink": {
														"name": "day_not_before_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_2']"
													},
													"sink": {
														"name": "day_not_before_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_3']"
													},
													"sink": {
														"name": "day_not_before_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_4']"
													},
													"sink": {
														"name": "day_not_before_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_5']"
													},
													"sink": {
														"name": "day_not_before_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_6']"
													},
													"sink": {
														"name": "day_not_before_6",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_7']"
													},
													"sink": {
														"name": "day_not_before_7",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['default_tax_perc']"
													},
													"sink": {
														"name": "default_tax_perc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_site']"
													},
													"sink": {
														"name": "disposal_site",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['docket_req']"
													},
													"sink": {
														"name": "docket_req",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['drawer']"
													},
													"sink": {
														"name": "drawer",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['email_address']"
													},
													"sink": {
														"name": "email_address",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['fax_no']"
													},
													"sink": {
														"name": "fax_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['FilteredWithAttributes']"
													},
													"sink": {
														"name": "FilteredWithAttributes",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['first_dd_date']"
													},
													"sink": {
														"name": "first_dd_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['government_no']"
													},
													"sink": {
														"name": "government_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['historical_date']"
													},
													"sink": {
														"name": "historical_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['house_no']"
													},
													"sink": {
														"name": "house_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['house_no_text']"
													},
													"sink": {
														"name": "house_no_text",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['in_collection_area']"
													},
													"sink": {
														"name": "in_collection_area",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['internal_account']"
													},
													"sink": {
														"name": "internal_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['invoice_email']"
													},
													"sink": {
														"name": "invoice_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['invoice_send_method']"
													},
													"sink": {
														"name": "invoice_send_method",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['invoice_send_method_we']"
													},
													"sink": {
														"name": "invoice_send_method_we",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['InvoiceStyle']"
													},
													"sink": {
														"name": "InvoiceStyle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['is_rcti']"
													},
													"sink": {
														"name": "is_rcti",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['LastPaymentDate']"
													},
													"sink": {
														"name": "LastPaymentDate",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['lot_no']"
													},
													"sink": {
														"name": "lot_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['map_reference']"
													},
													"sink": {
														"name": "map_reference",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['module']"
													},
													"sink": {
														"name": "module",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MultiSiteOneEmail']"
													},
													"sink": {
														"name": "MultiSiteOneEmail",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['name']"
													},
													"sink": {
														"name": "name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['NoService']"
													},
													"sink": {
														"name": "NoService",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['par_billto_cust_number']"
													},
													"sink": {
														"name": "par_billto_cust_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['parcel_key']"
													},
													"sink": {
														"name": "parcel_key",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['phone']"
													},
													"sink": {
														"name": "phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Phone2']"
													},
													"sink": {
														"name": "Phone2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['po_no']"
													},
													"sink": {
														"name": "po_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['POChain']"
													},
													"sink": {
														"name": "POChain",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['possession_date']"
													},
													"sink": {
														"name": "possession_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['postal_address_1']"
													},
													"sink": {
														"name": "postal_address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_address_2']"
													},
													"sink": {
														"name": "postal_address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_city']"
													},
													"sink": {
														"name": "postal_city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_country_code']"
													},
													"sink": {
														"name": "postal_country_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_county']"
													},
													"sink": {
														"name": "postal_county",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_name']"
													},
													"sink": {
														"name": "postal_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_property_name']"
													},
													"sink": {
														"name": "postal_property_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_state']"
													},
													"sink": {
														"name": "postal_state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_zip']"
													},
													"sink": {
														"name": "postal_zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['property_name']"
													},
													"sink": {
														"name": "property_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['protected_from']"
													},
													"sink": {
														"name": "protected_from",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['protected_to']"
													},
													"sink": {
														"name": "protected_to",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['rate_account_number']"
													},
													"sink": {
														"name": "rate_account_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rcti_email']"
													},
													"sink": {
														"name": "rcti_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['registration_date']"
													},
													"sink": {
														"name": "registration_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['renter_owner_swt']"
													},
													"sink": {
														"name": "renter_owner_swt",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rp_master']"
													},
													"sink": {
														"name": "rp_master",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['rp_number']"
													},
													"sink": {
														"name": "rp_number",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['sales_id']"
													},
													"sink": {
														"name": "sales_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['sales_territory']"
													},
													"sink": {
														"name": "sales_territory",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SecondaryZones']"
													},
													"sink": {
														"name": "SecondaryZones",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SendDocketsWithInvoice']"
													},
													"sink": {
														"name": "SendDocketsWithInvoice",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['serv_contact']"
													},
													"sink": {
														"name": "serv_contact",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SignatureMandatoryOnMDT']"
													},
													"sink": {
														"name": "SignatureMandatoryOnMDT",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['stat']"
													},
													"sink": {
														"name": "stat",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['state']"
													},
													"sink": {
														"name": "state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['statement_email']"
													},
													"sink": {
														"name": "statement_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['street_code']"
													},
													"sink": {
														"name": "street_code",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['street_section']"
													},
													"sink": {
														"name": "street_section",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['temp_susp_ed']"
													},
													"sink": {
														"name": "temp_susp_ed",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['temp_susp_sd']"
													},
													"sink": {
														"name": "temp_susp_sd",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['terms_code']"
													},
													"sink": {
														"name": "terms_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['town_code']"
													},
													"sink": {
														"name": "town_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trade_name']"
													},
													"sink": {
														"name": "trade_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UsePOChain']"
													},
													"sink": {
														"name": "UsePOChain",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['waste_precinct']"
													},
													"sink": {
														"name": "waste_precinct",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zip']"
													},
													"sink": {
														"name": "zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zone_code']"
													},
													"sink": {
														"name": "zone_code",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "customer",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "customer",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('Customer_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Service to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Booking to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_serv_1']"
													},
													"sink": {
														"name": "alt_ref_serv_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_serv_2']"
													},
													"sink": {
														"name": "alt_ref_serv_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['application_id']"
													},
													"sink": {
														"name": "application_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ApplyMinimumBookingPriceTo']"
													},
													"sink": {
														"name": "ApplyMinimumBookingPriceTo",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_cycle']"
													},
													"sink": {
														"name": "bill_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BillingQtySwitch']"
													},
													"sink": {
														"name": "BillingQtySwitch",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['budget_lifts']"
													},
													"sink": {
														"name": "budget_lifts",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['cancel_serv_date']"
													},
													"sink": {
														"name": "cancel_serv_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['chargeable']"
													},
													"sink": {
														"name": "chargeable",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['container_type']"
													},
													"sink": {
														"name": "container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['containers']"
													},
													"sink": {
														"name": "containers",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['contract_desc_1']"
													},
													"sink": {
														"name": "contract_desc_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_desc_2']"
													},
													"sink": {
														"name": "contract_desc_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_desc_3']"
													},
													"sink": {
														"name": "contract_desc_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_desc_4']"
													},
													"sink": {
														"name": "contract_desc_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_end_date']"
													},
													"sink": {
														"name": "contract_end_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['contract_no']"
													},
													"sink": {
														"name": "contract_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_str_date']"
													},
													"sink": {
														"name": "contract_str_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['contractor_no']"
													},
													"sink": {
														"name": "contractor_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['currency_code']"
													},
													"sink": {
														"name": "currency_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['destruction_certificate_required']"
													},
													"sink": {
														"name": "destruction_certificate_required",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc']"
													},
													"sink": {
														"name": "disposal_charge_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc2']"
													},
													"sink": {
														"name": "disposal_charge_desc2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc3']"
													},
													"sink": {
														"name": "disposal_charge_desc3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc_ex']"
													},
													"sink": {
														"name": "disposal_charge_desc_ex",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate']"
													},
													"sink": {
														"name": "disposal_charge_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate2']"
													},
													"sink": {
														"name": "disposal_charge_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate3']"
													},
													"sink": {
														"name": "disposal_charge_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex2']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex3']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type']"
													},
													"sink": {
														"name": "disposal_charge_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type2']"
													},
													"sink": {
														"name": "disposal_charge_type2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type3']"
													},
													"sink": {
														"name": "disposal_charge_type3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex']"
													},
													"sink": {
														"name": "disposal_charge_type_ex",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex2']"
													},
													"sink": {
														"name": "disposal_charge_type_ex2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex3']"
													},
													"sink": {
														"name": "disposal_charge_type_ex3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_default_weight']"
													},
													"sink": {
														"name": "disposal_default_weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_default_weight_max']"
													},
													"sink": {
														"name": "disposal_default_weight_max",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_default_weight_min']"
													},
													"sink": {
														"name": "disposal_default_weight_min",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_incl_charge']"
													},
													"sink": {
														"name": "disposal_incl_charge",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Disposal_Levy1Desc']"
													},
													"sink": {
														"name": "Disposal_Levy1Desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Disposal_Levy1Rate']"
													},
													"sink": {
														"name": "Disposal_Levy1Rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Disposal_Levy1Type']"
													},
													"sink": {
														"name": "Disposal_Levy1Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_site']"
													},
													"sink": {
														"name": "disposal_site",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_unit_meas']"
													},
													"sink": {
														"name": "disposal_unit_meas",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex",
														"type": "Double"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex2']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex3']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Disposal_weight_min']"
													},
													"sink": {
														"name": "Disposal_weight_min",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['facility_code']"
													},
													"sink": {
														"name": "facility_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['facility_number']"
													},
													"sink": {
														"name": "facility_number",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['float_next_date']"
													},
													"sink": {
														"name": "float_next_date",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['frequency']"
													},
													"sink": {
														"name": "frequency",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['indemnification_on_file']"
													},
													"sink": {
														"name": "indemnification_on_file",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['initial_serv_date']"
													},
													"sink": {
														"name": "initial_serv_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['InvoiceDescription']"
													},
													"sink": {
														"name": "InvoiceDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['last_bill_date']"
													},
													"sink": {
														"name": "last_bill_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['line_no']"
													},
													"sink": {
														"name": "line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['line_notes_1']"
													},
													"sink": {
														"name": "line_notes_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_notes_2']"
													},
													"sink": {
														"name": "line_notes_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_notes_3']"
													},
													"sink": {
														"name": "line_notes_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_notes_4']"
													},
													"sink": {
														"name": "line_notes_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['next_bill_date']"
													},
													"sink": {
														"name": "next_bill_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['next_care_cert_due']"
													},
													"sink": {
														"name": "next_care_cert_due",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['owned_flag']"
													},
													"sink": {
														"name": "owned_flag",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['ParentService']"
													},
													"sink": {
														"name": "ParentService",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['pickup_days']"
													},
													"sink": {
														"name": "pickup_days",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['po_no']"
													},
													"sink": {
														"name": "po_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['POChain']"
													},
													"sink": {
														"name": "POChain",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['pref_serv_time']"
													},
													"sink": {
														"name": "pref_serv_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['price_increase_exempt_date']"
													},
													"sink": {
														"name": "price_increase_exempt_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['rate_exempt']"
													},
													"sink": {
														"name": "rate_exempt",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['rent_days']"
													},
													"sink": {
														"name": "rent_days",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rent_free_days']"
													},
													"sink": {
														"name": "rent_free_days",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['repeating_loads']"
													},
													"sink": {
														"name": "repeating_loads",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['route']"
													},
													"sink": {
														"name": "route",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_collection']"
													},
													"sink": {
														"name": "route_collection",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['route_cycle']"
													},
													"sink": {
														"name": "route_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_1']"
													},
													"sink": {
														"name": "route_directions_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_2']"
													},
													"sink": {
														"name": "route_directions_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_3']"
													},
													"sink": {
														"name": "route_directions_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_4']"
													},
													"sink": {
														"name": "route_directions_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['sales_id_1']"
													},
													"sink": {
														"name": "sales_id_1",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['sch_end_time']"
													},
													"sink": {
														"name": "sch_end_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['sch_start_time']"
													},
													"sink": {
														"name": "sch_start_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SendTipFeeAttachments']"
													},
													"sink": {
														"name": "SendTipFeeAttachments",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_type']"
													},
													"sink": {
														"name": "serv_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SharedService']"
													},
													"sink": {
														"name": "SharedService",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['site_location_ref_no']"
													},
													"sink": {
														"name": "site_location_ref_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['subcontractor_line_no']"
													},
													"sink": {
														"name": "subcontractor_line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['temp_code']"
													},
													"sink": {
														"name": "temp_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_required']"
													},
													"sink": {
														"name": "ticket_required",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Time_at_site']"
													},
													"sink": {
														"name": "Time_at_site",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UseForAllSites']"
													},
													"sink": {
														"name": "UseForAllSites",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['UsePOChain']"
													},
													"sink": {
														"name": "UsePOChain",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_price_code']"
													},
													"sink": {
														"name": "we_price_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WeightLimitSwitch']"
													},
													"sink": {
														"name": "WeightLimitSwitch",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "service",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "service",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('service_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Scheduled Service to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Service to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"preCopyScript": "delete from scheduled_service_wsgvic",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['cont_number']"
													},
													"sink": {
														"name": "cont_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['display_order']"
													},
													"sink": {
														"name": "display_order",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['EndDate']"
													},
													"sink": {
														"name": "EndDate",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['ending_house']"
													},
													"sink": {
														"name": "ending_house",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['expected_metres']"
													},
													"sink": {
														"name": "expected_metres",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['first_service_date']"
													},
													"sink": {
														"name": "first_service_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['last_mdt_seq']"
													},
													"sink": {
														"name": "last_mdt_seq",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['line_no']"
													},
													"sink": {
														"name": "line_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_type']"
													},
													"sink": {
														"name": "line_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['navigation']"
													},
													"sink": {
														"name": "navigation",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['next_service_date']"
													},
													"sink": {
														"name": "next_service_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['route_line']"
													},
													"sink": {
														"name": "route_line",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['route_msg']"
													},
													"sink": {
														"name": "route_msg",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['schedule_no']"
													},
													"sink": {
														"name": "schedule_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['section']"
													},
													"sink": {
														"name": "section",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['segment_length']"
													},
													"sink": {
														"name": "segment_length",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['StartDate']"
													},
													"sink": {
														"name": "StartDate",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['street_code']"
													},
													"sink": {
														"name": "street_code",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "scheduledservice",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "scheduled_service",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('scheduled_service_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Tip Fee to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Scheduled Service to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"preCopyScript": {
												"value": "delete from @{concat('tip_fee_',item())}",
												"type": "Expression"
											},
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"parallelCopies": 1,
										"enableSkipIncompatibleRow": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_qty']"
													},
													"sink": {
														"name": "alt_qty",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['alt_qty_unit']"
													},
													"sink": {
														"name": "alt_qty_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['booking']"
													},
													"sink": {
														"name": "booking",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['cont_id']"
													},
													"sink": {
														"name": "cont_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_date']"
													},
													"sink": {
														"name": "coord_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['coord_time']"
													},
													"sink": {
														"name": "coord_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_type']"
													},
													"sink": {
														"name": "coord_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['date_accrual']"
													},
													"sink": {
														"name": "date_accrual",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['date_approved']"
													},
													"sink": {
														"name": "date_approved",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['date_paid']"
													},
													"sink": {
														"name": "date_paid",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc']"
													},
													"sink": {
														"name": "disposal_charge_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc2']"
													},
													"sink": {
														"name": "disposal_charge_desc2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc3']"
													},
													"sink": {
														"name": "disposal_charge_desc3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate']"
													},
													"sink": {
														"name": "disposal_charge_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate2']"
													},
													"sink": {
														"name": "disposal_charge_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate3']"
													},
													"sink": {
														"name": "disposal_charge_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex2']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex3']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type']"
													},
													"sink": {
														"name": "disposal_charge_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type2']"
													},
													"sink": {
														"name": "disposal_charge_type2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type3']"
													},
													"sink": {
														"name": "disposal_charge_type3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex']"
													},
													"sink": {
														"name": "disposal_charge_type_ex",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex2']"
													},
													"sink": {
														"name": "disposal_charge_type_ex2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex3']"
													},
													"sink": {
														"name": "disposal_charge_type_ex3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate']"
													},
													"sink": {
														"name": "disposal_cost_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate2']"
													},
													"sink": {
														"name": "disposal_cost_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate3']"
													},
													"sink": {
														"name": "disposal_cost_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate_ex']"
													},
													"sink": {
														"name": "disposal_cost_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate_type']"
													},
													"sink": {
														"name": "disposal_cost_rate_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_date']"
													},
													"sink": {
														"name": "disposal_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['disposal_incl_charge']"
													},
													"sink": {
														"name": "disposal_incl_charge",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_site']"
													},
													"sink": {
														"name": "disposal_site",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex2']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex3']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['DisposalServiceFunction']"
													},
													"sink": {
														"name": "DisposalServiceFunction",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['docket_no']"
													},
													"sink": {
														"name": "docket_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ExternalWeight']"
													},
													"sink": {
														"name": "ExternalWeight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['invoice_number']"
													},
													"sink": {
														"name": "invoice_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Levy1Desc']"
													},
													"sink": {
														"name": "Levy1Desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Levy1Rate']"
													},
													"sink": {
														"name": "Levy1Rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Levy1Type']"
													},
													"sink": {
														"name": "Levy1Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['odometer']"
													},
													"sink": {
														"name": "odometer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['plate_no']"
													},
													"sink": {
														"name": "plate_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route']"
													},
													"sink": {
														"name": "route",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_date']"
													},
													"sink": {
														"name": "route_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['route_summary']"
													},
													"sink": {
														"name": "route_summary",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['seq_no']"
													},
													"sink": {
														"name": "seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['serial_no']"
													},
													"sink": {
														"name": "serial_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_number']"
													},
													"sink": {
														"name": "ticket_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_number_old']"
													},
													"sink": {
														"name": "ticket_number_old",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['tip_in_time']"
													},
													"sink": {
														"name": "tip_in_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_out_time']"
													},
													"sink": {
														"name": "tip_out_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_sub_loc_no']"
													},
													"sink": {
														"name": "tip_sub_loc_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_visit_time']"
													},
													"sink": {
														"name": "tip_visit_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_charge']"
													},
													"sink": {
														"name": "total_charge",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_cost']"
													},
													"sink": {
														"name": "total_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_cost_entered']"
													},
													"sink": {
														"name": "total_cost_entered",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['trans_no']"
													},
													"sink": {
														"name": "trans_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['trans_seq']"
													},
													"sink": {
														"name": "trans_seq",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['transmit_no']"
													},
													"sink": {
														"name": "transmit_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['truck']"
													},
													"sink": {
														"name": "truck",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['user_approved']"
													},
													"sink": {
														"name": "user_approved",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['volume']"
													},
													"sink": {
														"name": "volume",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['volume_unit']"
													},
													"sink": {
														"name": "volume_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['weight']"
													},
													"sink": {
														"name": "weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_max']"
													},
													"sink": {
														"name": "weight_max",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_min']"
													},
													"sink": {
														"name": "weight_min",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_orig']"
													},
													"sink": {
														"name": "weight_orig",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_unit']"
													},
													"sink": {
														"name": "weight_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WeightIn']"
													},
													"sink": {
														"name": "WeightIn",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['WeightOut']"
													},
													"sink": {
														"name": "WeightOut",
														"type": "Decimal"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "tipfee",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "tip_fee",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('tip_fee_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Route Tip Fee to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Tip Fee to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_qty']"
													},
													"sink": {
														"name": "alt_qty",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['alt_qty_unit']"
													},
													"sink": {
														"name": "alt_qty_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['cont_id']"
													},
													"sink": {
														"name": "cont_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_date']"
													},
													"sink": {
														"name": "coord_date",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_time']"
													},
													"sink": {
														"name": "coord_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_type']"
													},
													"sink": {
														"name": "coord_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['date_accrual']"
													},
													"sink": {
														"name": "date_accrual",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['date_approved']"
													},
													"sink": {
														"name": "date_approved",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['date_paid']"
													},
													"sink": {
														"name": "date_paid",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc']"
													},
													"sink": {
														"name": "disposal_charge_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc2']"
													},
													"sink": {
														"name": "disposal_charge_desc2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc3']"
													},
													"sink": {
														"name": "disposal_charge_desc3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate']"
													},
													"sink": {
														"name": "disposal_charge_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate2']"
													},
													"sink": {
														"name": "disposal_charge_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate3']"
													},
													"sink": {
														"name": "disposal_charge_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex2']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex3']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type']"
													},
													"sink": {
														"name": "disposal_charge_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type2']"
													},
													"sink": {
														"name": "disposal_charge_type2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type3']"
													},
													"sink": {
														"name": "disposal_charge_type3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex']"
													},
													"sink": {
														"name": "disposal_charge_type_ex",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex2']"
													},
													"sink": {
														"name": "disposal_charge_type_ex2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex3']"
													},
													"sink": {
														"name": "disposal_charge_type_ex3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate']"
													},
													"sink": {
														"name": "disposal_cost_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate2']"
													},
													"sink": {
														"name": "disposal_cost_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate3']"
													},
													"sink": {
														"name": "disposal_cost_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate_ex']"
													},
													"sink": {
														"name": "disposal_cost_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate_type']"
													},
													"sink": {
														"name": "disposal_cost_rate_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_date']"
													},
													"sink": {
														"name": "disposal_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['disposal_incl_charge']"
													},
													"sink": {
														"name": "disposal_incl_charge",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_site']"
													},
													"sink": {
														"name": "disposal_site",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex2']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex3']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['DisposalServiceFunction']"
													},
													"sink": {
														"name": "DisposalServiceFunction",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['docket_no']"
													},
													"sink": {
														"name": "docket_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ExternalWeight']"
													},
													"sink": {
														"name": "ExternalWeight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['invoice_number']"
													},
													"sink": {
														"name": "invoice_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Levy1Desc']"
													},
													"sink": {
														"name": "Levy1Desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Levy1Rate']"
													},
													"sink": {
														"name": "Levy1Rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Levy1Type']"
													},
													"sink": {
														"name": "Levy1Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['odometer']"
													},
													"sink": {
														"name": "odometer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['plate_no']"
													},
													"sink": {
														"name": "plate_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route']"
													},
													"sink": {
														"name": "route",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_date']"
													},
													"sink": {
														"name": "route_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['route_summary']"
													},
													"sink": {
														"name": "route_summary",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['seq_no']"
													},
													"sink": {
														"name": "seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['serial_no']"
													},
													"sink": {
														"name": "serial_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_number']"
													},
													"sink": {
														"name": "ticket_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_number_old']"
													},
													"sink": {
														"name": "ticket_number_old",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['tip_in_time']"
													},
													"sink": {
														"name": "tip_in_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_out_time']"
													},
													"sink": {
														"name": "tip_out_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_sub_loc_no']"
													},
													"sink": {
														"name": "tip_sub_loc_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_visit_time']"
													},
													"sink": {
														"name": "tip_visit_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_charge']"
													},
													"sink": {
														"name": "total_charge",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_cost']"
													},
													"sink": {
														"name": "total_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_cost_entered']"
													},
													"sink": {
														"name": "total_cost_entered",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['trans_no']"
													},
													"sink": {
														"name": "trans_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['trans_seq']"
													},
													"sink": {
														"name": "trans_seq",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['transmit_no']"
													},
													"sink": {
														"name": "transmit_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['truck']"
													},
													"sink": {
														"name": "truck",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['user_approved']"
													},
													"sink": {
														"name": "user_approved",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['volume']"
													},
													"sink": {
														"name": "volume",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['volume_unit']"
													},
													"sink": {
														"name": "volume_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['weight']"
													},
													"sink": {
														"name": "weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_max']"
													},
													"sink": {
														"name": "weight_max",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_min']"
													},
													"sink": {
														"name": "weight_min",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_orig']"
													},
													"sink": {
														"name": "weight_orig",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_unit']"
													},
													"sink": {
														"name": "weight_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WeightIn']"
													},
													"sink": {
														"name": "WeightIn",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['WeightOut']"
													},
													"sink": {
														"name": "WeightOut",
														"type": "Decimal"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "routetipfee",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "route_tip_fee",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('route_tip_fee_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Route_Summary to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Route Tip Fee to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Bookings']"
													},
													"sink": {
														"name": "Bookings",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Confirmed']"
													},
													"sink": {
														"name": "Confirmed",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['depot']"
													},
													"sink": {
														"name": "depot",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Failed']"
													},
													"sink": {
														"name": "Failed",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['labour_rate_per_hour']"
													},
													"sink": {
														"name": "labour_rate_per_hour",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['labour_rate_per_hour_ot']"
													},
													"sink": {
														"name": "labour_rate_per_hour_ot",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['labour_rate_per_hour_ot2']"
													},
													"sink": {
														"name": "labour_rate_per_hour_ot2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['mdt_no']"
													},
													"sink": {
														"name": "mdt_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['mileage_from_tip']"
													},
													"sink": {
														"name": "mileage_from_tip",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['mileage_to_tip']"
													},
													"sink": {
														"name": "mileage_to_tip",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['normal_labour_hrs']"
													},
													"sink": {
														"name": "normal_labour_hrs",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['notes']"
													},
													"sink": {
														"name": "notes",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['odometer_finish']"
													},
													"sink": {
														"name": "odometer_finish",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['odometer_start']"
													},
													"sink": {
														"name": "odometer_start",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Outstanding']"
													},
													"sink": {
														"name": "Outstanding",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['overtime_labour_hrs']"
													},
													"sink": {
														"name": "overtime_labour_hrs",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['overtime_labour_hrs2']"
													},
													"sink": {
														"name": "overtime_labour_hrs2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['route_date']"
													},
													"sink": {
														"name": "route_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['RouteDescription']"
													},
													"sink": {
														"name": "RouteDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['run_hours']"
													},
													"sink": {
														"name": "run_hours",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['run_meter_finish']"
													},
													"sink": {
														"name": "run_meter_finish",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['run_meter_start']"
													},
													"sink": {
														"name": "run_meter_start",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Sent']"
													},
													"sink": {
														"name": "Sent",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['StatusPercent']"
													},
													"sink": {
														"name": "StatusPercent",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['team_no']"
													},
													"sink": {
														"name": "team_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['time_finish']"
													},
													"sink": {
														"name": "time_finish",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['time_start']"
													},
													"sink": {
														"name": "time_start",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['time_to_tip']"
													},
													"sink": {
														"name": "time_to_tip",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tips_visited']"
													},
													"sink": {
														"name": "tips_visited",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_additional_charge']"
													},
													"sink": {
														"name": "total_additional_charge",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_containers_scheduled']"
													},
													"sink": {
														"name": "total_containers_scheduled",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_containers_serviced']"
													},
													"sink": {
														"name": "total_containers_serviced",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_containers_serviced_old']"
													},
													"sink": {
														"name": "total_containers_serviced_old",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_cubic_meters']"
													},
													"sink": {
														"name": "total_cubic_meters",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_disposal_rebate_costs']"
													},
													"sink": {
														"name": "total_disposal_rebate_costs",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_down_time']"
													},
													"sink": {
														"name": "total_down_time",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_engine_hours']"
													},
													"sink": {
														"name": "total_engine_hours",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_fuel_cost']"
													},
													"sink": {
														"name": "total_fuel_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_fuel_used']"
													},
													"sink": {
														"name": "total_fuel_used",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_kilometers']"
													},
													"sink": {
														"name": "total_kilometers",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_kilometers_gps']"
													},
													"sink": {
														"name": "total_kilometers_gps",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_metric_tons']"
													},
													"sink": {
														"name": "total_metric_tons",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_no_of_main_jobs']"
													},
													"sink": {
														"name": "total_no_of_main_jobs",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_no_of_messages']"
													},
													"sink": {
														"name": "total_no_of_messages",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_no_of_sections']"
													},
													"sink": {
														"name": "total_no_of_sections",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_normal_labour_cost']"
													},
													"sink": {
														"name": "total_normal_labour_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_oil_cost']"
													},
													"sink": {
														"name": "total_oil_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_oil_used']"
													},
													"sink": {
														"name": "total_oil_used",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_overtime_labour_cost']"
													},
													"sink": {
														"name": "total_overtime_labour_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_overtime_labour_cost2']"
													},
													"sink": {
														"name": "total_overtime_labour_cost2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_rcti_costs']"
													},
													"sink": {
														"name": "total_rcti_costs",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_revenue']"
													},
													"sink": {
														"name": "total_revenue",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_run_mileage']"
													},
													"sink": {
														"name": "total_run_mileage",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_run_time']"
													},
													"sink": {
														"name": "total_run_time",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_stops_completed']"
													},
													"sink": {
														"name": "total_stops_completed",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_stops_scheduled']"
													},
													"sink": {
														"name": "total_stops_scheduled",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_subcontr_cost']"
													},
													"sink": {
														"name": "total_subcontr_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_tip_time']"
													},
													"sink": {
														"name": "total_tip_time",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_tip_wait_time']"
													},
													"sink": {
														"name": "total_tip_wait_time",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_tipping_charges']"
													},
													"sink": {
														"name": "total_tipping_charges",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_tipping_costs']"
													},
													"sink": {
														"name": "total_tipping_costs",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_veh_cost_hour']"
													},
													"sink": {
														"name": "total_veh_cost_hour",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_veh_cost_klm']"
													},
													"sink": {
														"name": "total_veh_cost_klm",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_veh_cost_klm_gps']"
													},
													"sink": {
														"name": "total_veh_cost_klm_gps",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['truck_no']"
													},
													"sink": {
														"name": "truck_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UnSent']"
													},
													"sink": {
														"name": "UnSent",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['unused_time']"
													},
													"sink": {
														"name": "unused_time",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['veh_cost_per_hr']"
													},
													"sink": {
														"name": "veh_cost_per_hr",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['veh_cost_per_klm']"
													},
													"sink": {
														"name": "veh_cost_per_klm",
														"type": "Decimal"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "routesummary",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "route_summary",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('route_summary_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Service Custom Price to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Route_Summary to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_cycle']"
													},
													"sink": {
														"name": "bill_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Code']"
													},
													"sink": {
														"name": "Code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['CreateUserID']"
													},
													"sink": {
														"name": "CreateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_number']"
													},
													"sink": {
														"name": "cust_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Department']"
													},
													"sink": {
														"name": "Department",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Description']"
													},
													"sink": {
														"name": "Description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['last_bill_date']"
													},
													"sink": {
														"name": "last_bill_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['LastInvoiceDate']"
													},
													"sink": {
														"name": "LastInvoiceDate",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Line_no']"
													},
													"sink": {
														"name": "Line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['MaxContainers']"
													},
													"sink": {
														"name": "MaxContainers",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['MinContainers']"
													},
													"sink": {
														"name": "MinContainers",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['next_bill_date']"
													},
													"sink": {
														"name": "next_bill_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['NextInvoiceDate']"
													},
													"sink": {
														"name": "NextInvoiceDate",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Price']"
													},
													"sink": {
														"name": "Price",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['price_type']"
													},
													"sink": {
														"name": "price_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PricePer']"
													},
													"sink": {
														"name": "PricePer",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PriceSource']"
													},
													"sink": {
														"name": "PriceSource",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ProfitCentre']"
													},
													"sink": {
														"name": "ProfitCentre",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['service_line_no']"
													},
													"sink": {
														"name": "service_line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Tax']"
													},
													"sink": {
														"name": "Tax",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['useCustomPrice']"
													},
													"sink": {
														"name": "useCustomPrice",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['we_c_pricline_cust_F6CHAR']"
													},
													"sink": {
														"name": "we_c_pricline_cust_F6CHAR",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_c_pricline_cust_F6DATE']"
													},
													"sink": {
														"name": "we_c_pricline_cust_F6DATE",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['we_c_pricline_cust_F6INT']"
													},
													"sink": {
														"name": "we_c_pricline_cust_F6INT",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['we_c_pricline_cust_F6LOG']"
													},
													"sink": {
														"name": "we_c_pricline_cust_F6LOG",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['we_c_pricline_cust_F8DEC']"
													},
													"sink": {
														"name": "we_c_pricline_cust_F8DEC",
														"type": "Decimal"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "servicecustomprice",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "service_custom_price",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('service_custom_price_',item())",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"Entity": {
						"type": "Array",
						"defaultValue": [
							"customer.customer/customer",
							"booking.booking/booking",
							"routetipfee.vehicle/route_tip_fee",
							"tipfee.vehicle/tip_fee",
							"servicecustomprice.customer/service_custom_price",
							"scheduledservice.customer/scheduled_service",
							"routesummary.vehicle/route_summary",
							"service.customer/service"
						]
					},
					"Instance": {
						"type": "Array",
						"defaultValue": [
							"wsgvic",
							"wflex"
						]
					},
					"StartDate": {
						"type": "String"
					},
					"EndDate": {
						"type": "String"
					},
					"Debug": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/WFLEX_date')]",
				"[concat(variables('factoryId'), '/datasets/WSGNSW_Date')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_WSG_DateQuery_wflex')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "For Each Entity",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('Entity')",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Set StartDate",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "StartDate",
										"value": {
											"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set End Date",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "EndDate",
										"value": {
											"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'yyyy-MM-dd')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set Debug",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "Debug",
										"value": {
											"value": "@concat(item(),'$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Copy WFLEX to Data Lake",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set StartDate",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Set End Date",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Set Debug",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"additionalColumns": [
												{
													"name": "Instance",
													"value": "wflex"
												}
											],
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true",
												"EndCondition:$.has_more": "Const:false",
												"QueryParameters.$start": "$.next_result"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "WFLEX_date",
											"type": "DatasetReference",
											"parameters": {
												"API_Instance": {
													"value": "@split(item(),'.')[1]",
													"type": "Expression"
												},
												"pStartDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"pEndDate": {
													"value": "@pipeline().parameters.pEndDate",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "@split(item(),'.')[0]",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"Instance": {
													"value": "wflex",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Copy WSG NSW to Data Lake",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Copy WFLEX to Data Lake",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"additionalColumns": [
												{
													"name": "Instance",
													"value": "wsgvic"
												}
											],
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true",
												"EndCondition:$.has_more": "Const:false",
												"QueryParameters.$start": "$.next_result"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "WSGNSW_Date",
											"type": "DatasetReference",
											"parameters": {
												"API_Instance": {
													"value": "@item()",
													"type": "Expression"
												},
												"pStartDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"pEndDate": {
													"value": "@pipeline().parameters.pEndDate",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"Instance": {
													"value": "wsgnsw",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Copy WSG VIC to Data Lake",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Copy WSG NSW to Data Lake",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true",
												"EndCondition:$.has_more": "Const:false",
												"QueryParameters.$start": "$.next_result"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "RestAPI_Date",
											"type": "DatasetReference",
											"parameters": {
												"pStartDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"pEndDate": {
													"value": "@pipeline().parameters.pEndDate",
													"type": "Expression"
												},
												"API_Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"Instance": {
													"value": "wsgvic",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "For Each Instance",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "For Each Entity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('Instance')",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Booking to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Customer to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['add_chg_changed']"
													},
													"sink": {
														"name": "add_chg_changed",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['admin_status']"
													},
													"sink": {
														"name": "admin_status",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_1']"
													},
													"sink": {
														"name": "alt_ref_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_2']"
													},
													"sink": {
														"name": "alt_ref_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_serv_1']"
													},
													"sink": {
														"name": "alt_ref_serv_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_serv_2']"
													},
													"sink": {
														"name": "alt_ref_serv_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['application_id']"
													},
													"sink": {
														"name": "application_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_address_1']"
													},
													"sink": {
														"name": "bill_address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_address_2']"
													},
													"sink": {
														"name": "bill_address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_city']"
													},
													"sink": {
														"name": "bill_city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_name']"
													},
													"sink": {
														"name": "bill_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_property_name']"
													},
													"sink": {
														"name": "bill_property_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_state']"
													},
													"sink": {
														"name": "bill_state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_to_swt']"
													},
													"sink": {
														"name": "bill_to_swt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_zip']"
													},
													"sink": {
														"name": "bill_zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bin_attributes']"
													},
													"sink": {
														"name": "bin_attributes",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bins_collected']"
													},
													"sink": {
														"name": "bins_collected",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['booking_custom_price']"
													},
													"sink": {
														"name": "booking_custom_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['booking_id']"
													},
													"sink": {
														"name": "booking_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['booking_update_flag']"
													},
													"sink": {
														"name": "booking_update_flag",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['chargeable']"
													},
													"sink": {
														"name": "chargeable",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['cont_id']"
													},
													"sink": {
														"name": "cont_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_id']"
													},
													"sink": {
														"name": "container_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_size']"
													},
													"sink": {
														"name": "container_size",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['container_type']"
													},
													"sink": {
														"name": "container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_weight']"
													},
													"sink": {
														"name": "container_weight",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['containers']"
													},
													"sink": {
														"name": "containers",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['coord_date']"
													},
													"sink": {
														"name": "coord_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['coord_time']"
													},
													"sink": {
														"name": "coord_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_type']"
													},
													"sink": {
														"name": "coord_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['currency_code']"
													},
													"sink": {
														"name": "currency_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_cust_ref']"
													},
													"sink": {
														"name": "cust_cust_ref",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer_class']"
													},
													"sink": {
														"name": "customer_class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer_service_line_no']"
													},
													"sink": {
														"name": "customer_service_line_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['default_weight']"
													},
													"sink": {
														"name": "default_weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['delivery_serial_no']"
													},
													"sink": {
														"name": "delivery_serial_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['delivery_site_number']"
													},
													"sink": {
														"name": "delivery_site_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['delivery_site_type']"
													},
													"sink": {
														"name": "delivery_site_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Department']"
													},
													"sink": {
														"name": "Department",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['destruction_batch_no']"
													},
													"sink": {
														"name": "destruction_batch_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['destruction_certificate_required']"
													},
													"sink": {
														"name": "destruction_certificate_required",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type']"
													},
													"sink": {
														"name": "disposal_charge_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_incl_charge']"
													},
													"sink": {
														"name": "disposal_incl_charge",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_ticket']"
													},
													"sink": {
														"name": "disposal_ticket",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['driver_comments']"
													},
													"sink": {
														"name": "driver_comments",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_docket_no']"
													},
													"sink": {
														"name": "driver_docket_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['driver_seq_no']"
													},
													"sink": {
														"name": "driver_seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['eba_codes']"
													},
													"sink": {
														"name": "eba_codes",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['email_address']"
													},
													"sink": {
														"name": "email_address",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Exported']"
													},
													"sink": {
														"name": "Exported",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['fax_no']"
													},
													"sink": {
														"name": "fax_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['GetLastestPrice']"
													},
													"sink": {
														"name": "GetLastestPrice",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['HasAttachment']"
													},
													"sink": {
														"name": "HasAttachment",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['invoice_no']"
													},
													"sink": {
														"name": "invoice_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['InvoiceDescription']"
													},
													"sink": {
														"name": "InvoiceDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['job_end_time']"
													},
													"sink": {
														"name": "job_end_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['job_hours']"
													},
													"sink": {
														"name": "job_hours",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['job_serviced_date']"
													},
													"sink": {
														"name": "job_serviced_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['job_start_time']"
													},
													"sink": {
														"name": "job_start_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['jrl_no']"
													},
													"sink": {
														"name": "jrl_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['linked_trans_no']"
													},
													"sink": {
														"name": "linked_trans_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['linked_trans_seq_no']"
													},
													"sink": {
														"name": "linked_trans_seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['map_reference']"
													},
													"sink": {
														"name": "map_reference",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['mdt_cash_payment']"
													},
													"sink": {
														"name": "mdt_cash_payment",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['meters_collected']"
													},
													"sink": {
														"name": "meters_collected",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['multi_total_price']"
													},
													"sink": {
														"name": "multi_total_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['multi_total_price_ex_tax']"
													},
													"sink": {
														"name": "multi_total_price_ex_tax",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['multi_total_tax']"
													},
													"sink": {
														"name": "multi_total_tax",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['OldServType']"
													},
													"sink": {
														"name": "OldServType",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['open_flag']"
													},
													"sink": {
														"name": "open_flag",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['order_no']"
													},
													"sink": {
														"name": "order_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['p_year']"
													},
													"sink": {
														"name": "p_year",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['paid']"
													},
													"sink": {
														"name": "paid",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['period']"
													},
													"sink": {
														"name": "period",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['phone_2']"
													},
													"sink": {
														"name": "phone_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PlannedEndTime']"
													},
													"sink": {
														"name": "PlannedEndTime",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PlannedStartTime']"
													},
													"sink": {
														"name": "PlannedStartTime",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['po_no']"
													},
													"sink": {
														"name": "po_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['prev_trans_status']"
													},
													"sink": {
														"name": "prev_trans_status",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['price_line_no']"
													},
													"sink": {
														"name": "price_line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['price_rate']"
													},
													"sink": {
														"name": "price_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Priority']"
													},
													"sink": {
														"name": "Priority",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ProfitCentre']"
													},
													"sink": {
														"name": "ProfitCentre",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['prorated_tip_cost']"
													},
													"sink": {
														"name": "prorated_tip_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['rcti_batch']"
													},
													"sink": {
														"name": "rcti_batch",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rcti_no']"
													},
													"sink": {
														"name": "rcti_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['reason_code']"
													},
													"sink": {
														"name": "reason_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['removal_serial_no']"
													},
													"sink": {
														"name": "removal_serial_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['removal_site_number']"
													},
													"sink": {
														"name": "removal_site_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['removal_site_type']"
													},
													"sink": {
														"name": "removal_site_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_1']"
													},
													"sink": {
														"name": "route_directions_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_2']"
													},
													"sink": {
														"name": "route_directions_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_3']"
													},
													"sink": {
														"name": "route_directions_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_4']"
													},
													"sink": {
														"name": "route_directions_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['run_gen_batch']"
													},
													"sink": {
														"name": "run_gen_batch",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SendTipFeeAttachments']"
													},
													"sink": {
														"name": "SendTipFeeAttachments",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['sent_flag']"
													},
													"sink": {
														"name": "sent_flag",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_addr_1']"
													},
													"sink": {
														"name": "serv_addr_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_addr_2']"
													},
													"sink": {
														"name": "serv_addr_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_city']"
													},
													"sink": {
														"name": "serv_city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_contact']"
													},
													"sink": {
														"name": "serv_contact",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_country']"
													},
													"sink": {
														"name": "serv_country",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc_1']"
													},
													"sink": {
														"name": "serv_desc_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc_2']"
													},
													"sink": {
														"name": "serv_desc_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc_3']"
													},
													"sink": {
														"name": "serv_desc_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc_4']"
													},
													"sink": {
														"name": "serv_desc_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_name']"
													},
													"sink": {
														"name": "serv_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_no']"
													},
													"sink": {
														"name": "serv_no",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['serv_phone']"
													},
													"sink": {
														"name": "serv_phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_property_name']"
													},
													"sink": {
														"name": "serv_property_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_state']"
													},
													"sink": {
														"name": "serv_state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_time_code']"
													},
													"sink": {
														"name": "serv_time_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_type']"
													},
													"sink": {
														"name": "serv_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_zip']"
													},
													"sink": {
														"name": "serv_zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['service_line_no']"
													},
													"sink": {
														"name": "service_line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['site_number']"
													},
													"sink": {
														"name": "site_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['status']"
													},
													"sink": {
														"name": "status",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['temp_code']"
													},
													"sink": {
														"name": "temp_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TempLedgerAccount']"
													},
													"sink": {
														"name": "TempLedgerAccount",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_required']"
													},
													"sink": {
														"name": "ticket_required",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['tip_fee']"
													},
													"sink": {
														"name": "tip_fee",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_price']"
													},
													"sink": {
														"name": "total_price",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_price_ex_tax']"
													},
													"sink": {
														"name": "total_price_ex_tax",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trans_date']"
													},
													"sink": {
														"name": "trans_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['trans_entry_date']"
													},
													"sink": {
														"name": "trans_entry_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['trans_entry_id']"
													},
													"sink": {
														"name": "trans_entry_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trans_entry_time']"
													},
													"sink": {
														"name": "trans_entry_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trans_no']"
													},
													"sink": {
														"name": "trans_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['trans_seq_no']"
													},
													"sink": {
														"name": "trans_seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['trans_update_date']"
													},
													"sink": {
														"name": "trans_update_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['trans_update_id']"
													},
													"sink": {
														"name": "trans_update_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trans_update_time']"
													},
													"sink": {
														"name": "trans_update_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['truck_no']"
													},
													"sink": {
														"name": "truck_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['updated']"
													},
													"sink": {
														"name": "updated",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['usePriceCode']"
													},
													"sink": {
														"name": "usePriceCode",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['user_id']"
													},
													"sink": {
														"name": "user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['vehicle_class']"
													},
													"sink": {
														"name": "vehicle_class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WasteOutcome']"
													},
													"sink": {
														"name": "WasteOutcome",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_equip_codes']"
													},
													"sink": {
														"name": "we_equip_codes",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_helpers']"
													},
													"sink": {
														"name": "we_helpers",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_price']"
													},
													"sink": {
														"name": "we_price",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['we_price_code']"
													},
													"sink": {
														"name": "we_price_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_price_discount_label']"
													},
													"sink": {
														"name": "we_price_discount_label",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_tax']"
													},
													"sink": {
														"name": "we_tax",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['zone_no']"
													},
													"sink": {
														"name": "zone_no",
														"type": "Int32"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "booking",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "booking",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('booking_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Customer to DB",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"modifiedDatetimeStart": "2022-12-21T00:00:00.335Z",
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['accounting_acc_no']"
													},
													"sink": {
														"name": "accounting_acc_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['accounting_bal_due_days']"
													},
													"sink": {
														"name": "accounting_bal_due_days",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['accounting_cust_id']"
													},
													"sink": {
														"name": "accounting_cust_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['accounting_vendor_id']"
													},
													"sink": {
														"name": "accounting_vendor_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_1']"
													},
													"sink": {
														"name": "address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_2']"
													},
													"sink": {
														"name": "address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alternate_id']"
													},
													"sink": {
														"name": "alternate_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['anzsic_code']"
													},
													"sink": {
														"name": "anzsic_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['approval_contact']"
													},
													"sink": {
														"name": "approval_contact",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['approval_email']"
													},
													"sink": {
														"name": "approval_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['approval_phone']"
													},
													"sink": {
														"name": "approval_phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['apt_no']"
													},
													"sink": {
														"name": "apt_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AttachmentCategories']"
													},
													"sink": {
														"name": "AttachmentCategories",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AutoStopCreditOff']"
													},
													"sink": {
														"name": "AutoStopCreditOff",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['AutoStopCreditOn']"
													},
													"sink": {
														"name": "AutoStopCreditOn",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['bank_acct_no']"
													},
													"sink": {
														"name": "bank_acct_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bank_name']"
													},
													"sink": {
														"name": "bank_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_cycle']"
													},
													"sink": {
														"name": "bill_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_to_swt']"
													},
													"sink": {
														"name": "bill_to_swt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['book_alt_ref1']"
													},
													"sink": {
														"name": "book_alt_ref1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['book_alt_ref2']"
													},
													"sink": {
														"name": "book_alt_ref2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['BusinessType']"
													},
													"sink": {
														"name": "BusinessType",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cash_account']"
													},
													"sink": {
														"name": "cash_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cash_cardname']"
													},
													"sink": {
														"name": "cash_cardname",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cash_expiry']"
													},
													"sink": {
														"name": "cash_expiry",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cash_method']"
													},
													"sink": {
														"name": "cash_method",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['city']"
													},
													"sink": {
														"name": "city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_1']"
													},
													"sink": {
														"name": "classification_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_2']"
													},
													"sink": {
														"name": "classification_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_3']"
													},
													"sink": {
														"name": "classification_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_4']"
													},
													"sink": {
														"name": "classification_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_5']"
													},
													"sink": {
														"name": "classification_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_6']"
													},
													"sink": {
														"name": "classification_6",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_7']"
													},
													"sink": {
														"name": "classification_7",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_8']"
													},
													"sink": {
														"name": "classification_8",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_9']"
													},
													"sink": {
														"name": "classification_9",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_10']"
													},
													"sink": {
														"name": "classification_10",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contribution_entitlement']"
													},
													"sink": {
														"name": "contribution_entitlement",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['contribution_entitlement_total']"
													},
													"sink": {
														"name": "contribution_entitlement_total",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['coord_date']"
													},
													"sink": {
														"name": "coord_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['coord_time']"
													},
													"sink": {
														"name": "coord_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_type']"
													},
													"sink": {
														"name": "coord_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['country_code']"
													},
													"sink": {
														"name": "country_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['county']"
													},
													"sink": {
														"name": "county",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_date']"
													},
													"sink": {
														"name": "create_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['credit_contact']"
													},
													"sink": {
														"name": "credit_contact",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['credit_email']"
													},
													"sink": {
														"name": "credit_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['credit_limit']"
													},
													"sink": {
														"name": "credit_limit",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['credit_limit_warn_amt']"
													},
													"sink": {
														"name": "credit_limit_warn_amt",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['credit_phone']"
													},
													"sink": {
														"name": "credit_phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CTSName']"
													},
													"sink": {
														"name": "CTSName",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CTSNumber']"
													},
													"sink": {
														"name": "CTSNumber",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['currency_code']"
													},
													"sink": {
														"name": "currency_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_1']"
													},
													"sink": {
														"name": "cust_class_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_2']"
													},
													"sink": {
														"name": "cust_class_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_3']"
													},
													"sink": {
														"name": "cust_class_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_4']"
													},
													"sink": {
														"name": "cust_class_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_5']"
													},
													"sink": {
														"name": "cust_class_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_group']"
													},
													"sink": {
														"name": "cust_group",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_number']"
													},
													"sink": {
														"name": "cust_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['cust_seq_no']"
													},
													"sink": {
														"name": "cust_seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['cust_type']"
													},
													"sink": {
														"name": "cust_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer_class']"
													},
													"sink": {
														"name": "customer_class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cut_off_swt']"
													},
													"sink": {
														"name": "cut_off_swt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_closed_1']"
													},
													"sink": {
														"name": "day_closed_1",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_2']"
													},
													"sink": {
														"name": "day_closed_2",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_3']"
													},
													"sink": {
														"name": "day_closed_3",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_4']"
													},
													"sink": {
														"name": "day_closed_4",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_5']"
													},
													"sink": {
														"name": "day_closed_5",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_6']"
													},
													"sink": {
														"name": "day_closed_6",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_7']"
													},
													"sink": {
														"name": "day_closed_7",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_1']"
													},
													"sink": {
														"name": "day_not_after_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_2']"
													},
													"sink": {
														"name": "day_not_after_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_3']"
													},
													"sink": {
														"name": "day_not_after_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_4']"
													},
													"sink": {
														"name": "day_not_after_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_5']"
													},
													"sink": {
														"name": "day_not_after_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_6']"
													},
													"sink": {
														"name": "day_not_after_6",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_7']"
													},
													"sink": {
														"name": "day_not_after_7",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_1']"
													},
													"sink": {
														"name": "day_not_before_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_2']"
													},
													"sink": {
														"name": "day_not_before_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_3']"
													},
													"sink": {
														"name": "day_not_before_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_4']"
													},
													"sink": {
														"name": "day_not_before_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_5']"
													},
													"sink": {
														"name": "day_not_before_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_6']"
													},
													"sink": {
														"name": "day_not_before_6",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_7']"
													},
													"sink": {
														"name": "day_not_before_7",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['default_tax_perc']"
													},
													"sink": {
														"name": "default_tax_perc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_site']"
													},
													"sink": {
														"name": "disposal_site",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['docket_req']"
													},
													"sink": {
														"name": "docket_req",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['drawer']"
													},
													"sink": {
														"name": "drawer",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['duty_care_accepted']"
													},
													"sink": {
														"name": "Duty_care_accepted",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['duty_care_from_date']"
													},
													"sink": {
														"name": "duty_care_from_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['duty_care_to_date']"
													},
													"sink": {
														"name": "duty_care_to_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['email_address']"
													},
													"sink": {
														"name": "email_address",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['fax_no']"
													},
													"sink": {
														"name": "fax_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['FilteredWithAttributes']"
													},
													"sink": {
														"name": "FilteredWithAttributes",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['first_dd_date']"
													},
													"sink": {
														"name": "first_dd_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['government_no']"
													},
													"sink": {
														"name": "government_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['historical_date']"
													},
													"sink": {
														"name": "historical_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['house_no']"
													},
													"sink": {
														"name": "house_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['house_no_text']"
													},
													"sink": {
														"name": "house_no_text",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['in_collection_area']"
													},
													"sink": {
														"name": "in_collection_area",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['internal_account']"
													},
													"sink": {
														"name": "internal_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['invoice_email']"
													},
													"sink": {
														"name": "invoice_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['invoice_send_method']"
													},
													"sink": {
														"name": "invoice_send_method",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['invoice_send_method_we']"
													},
													"sink": {
														"name": "invoice_send_method_we",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['InvoiceStyle']"
													},
													"sink": {
														"name": "InvoiceStyle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['is_rcti']"
													},
													"sink": {
														"name": "is_rcti",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['LastPaymentDate']"
													},
													"sink": {
														"name": "LastPaymentDate",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['lot_no']"
													},
													"sink": {
														"name": "lot_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['map_reference']"
													},
													"sink": {
														"name": "map_reference",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['module']"
													},
													"sink": {
														"name": "module",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MultiSiteOneEmail']"
													},
													"sink": {
														"name": "MultiSiteOneEmail",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['name']"
													},
													"sink": {
														"name": "name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['NoService']"
													},
													"sink": {
														"name": "NoService",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['par_billto_cust_number']"
													},
													"sink": {
														"name": "par_billto_cust_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['parcel_key']"
													},
													"sink": {
														"name": "parcel_key",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['phone']"
													},
													"sink": {
														"name": "phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Phone2']"
													},
													"sink": {
														"name": "Phone2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['po_no']"
													},
													"sink": {
														"name": "po_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['POChain']"
													},
													"sink": {
														"name": "POChain",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['possession_date']"
													},
													"sink": {
														"name": "possession_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['postal_address_1']"
													},
													"sink": {
														"name": "postal_address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_address_2']"
													},
													"sink": {
														"name": "postal_address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_city']"
													},
													"sink": {
														"name": "postal_city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_country_code']"
													},
													"sink": {
														"name": "postal_country_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_county']"
													},
													"sink": {
														"name": "postal_county",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_name']"
													},
													"sink": {
														"name": "postal_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_property_name']"
													},
													"sink": {
														"name": "postal_property_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_state']"
													},
													"sink": {
														"name": "postal_state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_zip']"
													},
													"sink": {
														"name": "postal_zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['property_name']"
													},
													"sink": {
														"name": "property_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['protected_from']"
													},
													"sink": {
														"name": "protected_from",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['protected_to']"
													},
													"sink": {
														"name": "protected_to",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['rate_account_number']"
													},
													"sink": {
														"name": "rate_account_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rcti_email']"
													},
													"sink": {
														"name": "rcti_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['registration_date']"
													},
													"sink": {
														"name": "registration_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['renter_owner_swt']"
													},
													"sink": {
														"name": "renter_owner_swt",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rp_master']"
													},
													"sink": {
														"name": "rp_master",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['rp_number']"
													},
													"sink": {
														"name": "rp_number",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['sales_id']"
													},
													"sink": {
														"name": "sales_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['sales_territory']"
													},
													"sink": {
														"name": "sales_territory",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SecondaryZones']"
													},
													"sink": {
														"name": "SecondaryZones",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SendDocketsWithInvoice']"
													},
													"sink": {
														"name": "SendDocketsWithInvoice",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['serv_contact']"
													},
													"sink": {
														"name": "serv_contact",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SignatureMandatoryOnMDT']"
													},
													"sink": {
														"name": "SignatureMandatoryOnMDT",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['stat']"
													},
													"sink": {
														"name": "stat",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['state']"
													},
													"sink": {
														"name": "state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['statement_email']"
													},
													"sink": {
														"name": "statement_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['street_code']"
													},
													"sink": {
														"name": "street_code",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['street_section']"
													},
													"sink": {
														"name": "street_section",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['temp_susp_ed']"
													},
													"sink": {
														"name": "temp_susp_ed",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['temp_susp_sd']"
													},
													"sink": {
														"name": "temp_susp_sd",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['terms_code']"
													},
													"sink": {
														"name": "terms_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['town_code']"
													},
													"sink": {
														"name": "town_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trade_name']"
													},
													"sink": {
														"name": "trade_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UsePOChain']"
													},
													"sink": {
														"name": "UsePOChain",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['waste_precinct']"
													},
													"sink": {
														"name": "waste_precinct",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zip']"
													},
													"sink": {
														"name": "zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zone_code']"
													},
													"sink": {
														"name": "zone_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "$['offset']"
													},
													"sink": {}
												},
												{
													"source": {
														"path": "$['count']"
													},
													"sink": {}
												},
												{
													"source": {
														"path": "$['has_more']"
													},
													"sink": {}
												},
												{
													"source": {
														"path": "$['next_result']"
													},
													"sink": {}
												},
												{
													"source": {
														"path": "$['Instance']"
													},
													"sink": {
														"name": "Ins"
													}
												}
											],
											"collectionReference": "$['result']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "customer",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "customer",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('Customer_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Service to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Booking to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_serv_1']"
													},
													"sink": {
														"name": "alt_ref_serv_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_serv_2']"
													},
													"sink": {
														"name": "alt_ref_serv_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['application_id']"
													},
													"sink": {
														"name": "application_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ApplyMinimumBookingPriceTo']"
													},
													"sink": {
														"name": "ApplyMinimumBookingPriceTo",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_cycle']"
													},
													"sink": {
														"name": "bill_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BillingQtySwitch']"
													},
													"sink": {
														"name": "BillingQtySwitch",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['budget_lifts']"
													},
													"sink": {
														"name": "budget_lifts",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['cancel_serv_date']"
													},
													"sink": {
														"name": "cancel_serv_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['chargeable']"
													},
													"sink": {
														"name": "chargeable",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['container_type']"
													},
													"sink": {
														"name": "container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['containers']"
													},
													"sink": {
														"name": "containers",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['contract_desc_1']"
													},
													"sink": {
														"name": "contract_desc_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_desc_2']"
													},
													"sink": {
														"name": "contract_desc_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_desc_3']"
													},
													"sink": {
														"name": "contract_desc_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_desc_4']"
													},
													"sink": {
														"name": "contract_desc_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_end_date']"
													},
													"sink": {
														"name": "contract_end_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['contract_no']"
													},
													"sink": {
														"name": "contract_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_str_date']"
													},
													"sink": {
														"name": "contract_str_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['contractor_no']"
													},
													"sink": {
														"name": "contractor_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['currency_code']"
													},
													"sink": {
														"name": "currency_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['destruction_certificate_required']"
													},
													"sink": {
														"name": "destruction_certificate_required",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc']"
													},
													"sink": {
														"name": "disposal_charge_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc2']"
													},
													"sink": {
														"name": "disposal_charge_desc2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc3']"
													},
													"sink": {
														"name": "disposal_charge_desc3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc_ex']"
													},
													"sink": {
														"name": "disposal_charge_desc_ex",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate']"
													},
													"sink": {
														"name": "disposal_charge_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate2']"
													},
													"sink": {
														"name": "disposal_charge_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate3']"
													},
													"sink": {
														"name": "disposal_charge_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex2']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex3']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type']"
													},
													"sink": {
														"name": "disposal_charge_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type2']"
													},
													"sink": {
														"name": "disposal_charge_type2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type3']"
													},
													"sink": {
														"name": "disposal_charge_type3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex']"
													},
													"sink": {
														"name": "disposal_charge_type_ex",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex2']"
													},
													"sink": {
														"name": "disposal_charge_type_ex2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex3']"
													},
													"sink": {
														"name": "disposal_charge_type_ex3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_default_weight']"
													},
													"sink": {
														"name": "disposal_default_weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_default_weight_max']"
													},
													"sink": {
														"name": "disposal_default_weight_max",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_default_weight_min']"
													},
													"sink": {
														"name": "disposal_default_weight_min",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_incl_charge']"
													},
													"sink": {
														"name": "disposal_incl_charge",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Disposal_Levy1Desc']"
													},
													"sink": {
														"name": "Disposal_Levy1Desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Disposal_Levy1Rate']"
													},
													"sink": {
														"name": "Disposal_Levy1Rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Disposal_Levy1Type']"
													},
													"sink": {
														"name": "Disposal_Levy1Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_site']"
													},
													"sink": {
														"name": "disposal_site",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_unit_meas']"
													},
													"sink": {
														"name": "disposal_unit_meas",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex",
														"type": "Double"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex2']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex3']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Disposal_weight_min']"
													},
													"sink": {
														"name": "Disposal_weight_min",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['facility_code']"
													},
													"sink": {
														"name": "facility_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['facility_number']"
													},
													"sink": {
														"name": "facility_number",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['float_next_date']"
													},
													"sink": {
														"name": "float_next_date",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['frequency']"
													},
													"sink": {
														"name": "frequency",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['indemnification_on_file']"
													},
													"sink": {
														"name": "indemnification_on_file",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['initial_serv_date']"
													},
													"sink": {
														"name": "initial_serv_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['InvoiceDescription']"
													},
													"sink": {
														"name": "InvoiceDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['last_bill_date']"
													},
													"sink": {
														"name": "last_bill_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['line_no']"
													},
													"sink": {
														"name": "line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['line_notes_1']"
													},
													"sink": {
														"name": "line_notes_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_notes_2']"
													},
													"sink": {
														"name": "line_notes_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_notes_3']"
													},
													"sink": {
														"name": "line_notes_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_notes_4']"
													},
													"sink": {
														"name": "line_notes_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['next_bill_date']"
													},
													"sink": {
														"name": "next_bill_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['next_care_cert_due']"
													},
													"sink": {
														"name": "next_care_cert_due",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['owned_flag']"
													},
													"sink": {
														"name": "owned_flag",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['ParentService']"
													},
													"sink": {
														"name": "ParentService",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['pickup_days']"
													},
													"sink": {
														"name": "pickup_days",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['po_no']"
													},
													"sink": {
														"name": "po_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['POChain']"
													},
													"sink": {
														"name": "POChain",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['pref_serv_time']"
													},
													"sink": {
														"name": "pref_serv_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['price_increase_exempt_date']"
													},
													"sink": {
														"name": "price_increase_exempt_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['rate_exempt']"
													},
													"sink": {
														"name": "rate_exempt",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['rent_days']"
													},
													"sink": {
														"name": "rent_days",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rent_free_days']"
													},
													"sink": {
														"name": "rent_free_days",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['repeating_loads']"
													},
													"sink": {
														"name": "repeating_loads",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['route']"
													},
													"sink": {
														"name": "route",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_collection']"
													},
													"sink": {
														"name": "route_collection",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['route_cycle']"
													},
													"sink": {
														"name": "route_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_1']"
													},
													"sink": {
														"name": "route_directions_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_2']"
													},
													"sink": {
														"name": "route_directions_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_3']"
													},
													"sink": {
														"name": "route_directions_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_4']"
													},
													"sink": {
														"name": "route_directions_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['sales_id_1']"
													},
													"sink": {
														"name": "sales_id_1",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['sch_end_time']"
													},
													"sink": {
														"name": "sch_end_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['sch_start_time']"
													},
													"sink": {
														"name": "sch_start_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SendTipFeeAttachments']"
													},
													"sink": {
														"name": "SendTipFeeAttachments",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_type']"
													},
													"sink": {
														"name": "serv_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SharedService']"
													},
													"sink": {
														"name": "SharedService",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['site_location_ref_no']"
													},
													"sink": {
														"name": "site_location_ref_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['subcontractor_line_no']"
													},
													"sink": {
														"name": "subcontractor_line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['temp_code']"
													},
													"sink": {
														"name": "temp_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_required']"
													},
													"sink": {
														"name": "ticket_required",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Time_at_site']"
													},
													"sink": {
														"name": "Time_at_site",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UseForAllSites']"
													},
													"sink": {
														"name": "UseForAllSites",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['UsePOChain']"
													},
													"sink": {
														"name": "UsePOChain",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_price_code']"
													},
													"sink": {
														"name": "we_price_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WeightLimitSwitch']"
													},
													"sink": {
														"name": "WeightLimitSwitch",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "service",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "service",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('service_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Scheduled Service to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Service to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"preCopyScript": "delete from scheduled_service_wflex",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['cont_number']"
													},
													"sink": {
														"name": "cont_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['display_order']"
													},
													"sink": {
														"name": "display_order",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['EndDate']"
													},
													"sink": {
														"name": "EndDate",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['ending_house']"
													},
													"sink": {
														"name": "ending_house",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['expected_metres']"
													},
													"sink": {
														"name": "expected_metres",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['first_service_date']"
													},
													"sink": {
														"name": "first_service_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['last_mdt_seq']"
													},
													"sink": {
														"name": "last_mdt_seq",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['line_no']"
													},
													"sink": {
														"name": "line_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_type']"
													},
													"sink": {
														"name": "line_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['navigation']"
													},
													"sink": {
														"name": "navigation",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['next_service_date']"
													},
													"sink": {
														"name": "next_service_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['route_line']"
													},
													"sink": {
														"name": "route_line",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['route_msg']"
													},
													"sink": {
														"name": "route_msg",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['schedule_no']"
													},
													"sink": {
														"name": "schedule_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['section']"
													},
													"sink": {
														"name": "section",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['segment_length']"
													},
													"sink": {
														"name": "segment_length",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['StartDate']"
													},
													"sink": {
														"name": "StartDate",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['street_code']"
													},
													"sink": {
														"name": "street_code",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "scheduledservice",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "scheduled_service",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('scheduled_service_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Tip Fee to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Scheduled Service to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_qty']"
													},
													"sink": {
														"name": "alt_qty",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['alt_qty_unit']"
													},
													"sink": {
														"name": "alt_qty_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['booking']"
													},
													"sink": {
														"name": "booking",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['cont_id']"
													},
													"sink": {
														"name": "cont_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_date']"
													},
													"sink": {
														"name": "coord_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['coord_time']"
													},
													"sink": {
														"name": "coord_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_type']"
													},
													"sink": {
														"name": "coord_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['date_accrual']"
													},
													"sink": {
														"name": "date_accrual",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['date_approved']"
													},
													"sink": {
														"name": "date_approved",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['date_paid']"
													},
													"sink": {
														"name": "date_paid",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc']"
													},
													"sink": {
														"name": "disposal_charge_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc2']"
													},
													"sink": {
														"name": "disposal_charge_desc2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc3']"
													},
													"sink": {
														"name": "disposal_charge_desc3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate']"
													},
													"sink": {
														"name": "disposal_charge_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate2']"
													},
													"sink": {
														"name": "disposal_charge_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate3']"
													},
													"sink": {
														"name": "disposal_charge_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex2']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex3']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type']"
													},
													"sink": {
														"name": "disposal_charge_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type2']"
													},
													"sink": {
														"name": "disposal_charge_type2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type3']"
													},
													"sink": {
														"name": "disposal_charge_type3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex']"
													},
													"sink": {
														"name": "disposal_charge_type_ex",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex2']"
													},
													"sink": {
														"name": "disposal_charge_type_ex2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex3']"
													},
													"sink": {
														"name": "disposal_charge_type_ex3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate']"
													},
													"sink": {
														"name": "disposal_cost_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate2']"
													},
													"sink": {
														"name": "disposal_cost_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate3']"
													},
													"sink": {
														"name": "disposal_cost_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate_ex']"
													},
													"sink": {
														"name": "disposal_cost_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate_type']"
													},
													"sink": {
														"name": "disposal_cost_rate_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_date']"
													},
													"sink": {
														"name": "disposal_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['disposal_incl_charge']"
													},
													"sink": {
														"name": "disposal_incl_charge",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_site']"
													},
													"sink": {
														"name": "disposal_site",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex2']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex3']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['DisposalServiceFunction']"
													},
													"sink": {
														"name": "DisposalServiceFunction",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['docket_no']"
													},
													"sink": {
														"name": "docket_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ExternalWeight']"
													},
													"sink": {
														"name": "ExternalWeight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['invoice_number']"
													},
													"sink": {
														"name": "invoice_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Levy1Desc']"
													},
													"sink": {
														"name": "Levy1Desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Levy1Rate']"
													},
													"sink": {
														"name": "Levy1Rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Levy1Type']"
													},
													"sink": {
														"name": "Levy1Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['odometer']"
													},
													"sink": {
														"name": "odometer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['plate_no']"
													},
													"sink": {
														"name": "plate_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route']"
													},
													"sink": {
														"name": "route",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_date']"
													},
													"sink": {
														"name": "route_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['route_summary']"
													},
													"sink": {
														"name": "route_summary",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['seq_no']"
													},
													"sink": {
														"name": "seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['serial_no']"
													},
													"sink": {
														"name": "serial_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_number']"
													},
													"sink": {
														"name": "ticket_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_number_old']"
													},
													"sink": {
														"name": "ticket_number_old",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['tip_in_time']"
													},
													"sink": {
														"name": "tip_in_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_out_time']"
													},
													"sink": {
														"name": "tip_out_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_sub_loc_no']"
													},
													"sink": {
														"name": "tip_sub_loc_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_visit_time']"
													},
													"sink": {
														"name": "tip_visit_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_charge']"
													},
													"sink": {
														"name": "total_charge",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_cost']"
													},
													"sink": {
														"name": "total_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_cost_entered']"
													},
													"sink": {
														"name": "total_cost_entered",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['trans_no']"
													},
													"sink": {
														"name": "trans_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['trans_seq']"
													},
													"sink": {
														"name": "trans_seq",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['transmit_no']"
													},
													"sink": {
														"name": "transmit_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['truck']"
													},
													"sink": {
														"name": "truck",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['user_approved']"
													},
													"sink": {
														"name": "user_approved",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['volume']"
													},
													"sink": {
														"name": "volume",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['volume_unit']"
													},
													"sink": {
														"name": "volume_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['weight']"
													},
													"sink": {
														"name": "weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_max']"
													},
													"sink": {
														"name": "weight_max",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_min']"
													},
													"sink": {
														"name": "weight_min",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_orig']"
													},
													"sink": {
														"name": "weight_orig",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_unit']"
													},
													"sink": {
														"name": "weight_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WeightIn']"
													},
													"sink": {
														"name": "WeightIn",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['WeightOut']"
													},
													"sink": {
														"name": "WeightOut",
														"type": "Decimal"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "tipfee",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "tip_fee",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('tip_fee_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Route Tip Fee to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Tip Fee to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_qty']"
													},
													"sink": {
														"name": "alt_qty",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['alt_qty_unit']"
													},
													"sink": {
														"name": "alt_qty_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['cont_id']"
													},
													"sink": {
														"name": "cont_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_date']"
													},
													"sink": {
														"name": "coord_date",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_time']"
													},
													"sink": {
														"name": "coord_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_type']"
													},
													"sink": {
														"name": "coord_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['date_accrual']"
													},
													"sink": {
														"name": "date_accrual",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['date_approved']"
													},
													"sink": {
														"name": "date_approved",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['date_paid']"
													},
													"sink": {
														"name": "date_paid",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc']"
													},
													"sink": {
														"name": "disposal_charge_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc2']"
													},
													"sink": {
														"name": "disposal_charge_desc2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc3']"
													},
													"sink": {
														"name": "disposal_charge_desc3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate']"
													},
													"sink": {
														"name": "disposal_charge_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate2']"
													},
													"sink": {
														"name": "disposal_charge_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate3']"
													},
													"sink": {
														"name": "disposal_charge_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex2']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex3']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type']"
													},
													"sink": {
														"name": "disposal_charge_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type2']"
													},
													"sink": {
														"name": "disposal_charge_type2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type3']"
													},
													"sink": {
														"name": "disposal_charge_type3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex']"
													},
													"sink": {
														"name": "disposal_charge_type_ex",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex2']"
													},
													"sink": {
														"name": "disposal_charge_type_ex2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex3']"
													},
													"sink": {
														"name": "disposal_charge_type_ex3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate']"
													},
													"sink": {
														"name": "disposal_cost_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate2']"
													},
													"sink": {
														"name": "disposal_cost_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate3']"
													},
													"sink": {
														"name": "disposal_cost_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate_ex']"
													},
													"sink": {
														"name": "disposal_cost_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate_type']"
													},
													"sink": {
														"name": "disposal_cost_rate_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_date']"
													},
													"sink": {
														"name": "disposal_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['disposal_incl_charge']"
													},
													"sink": {
														"name": "disposal_incl_charge",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_site']"
													},
													"sink": {
														"name": "disposal_site",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex2']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex3']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['DisposalServiceFunction']"
													},
													"sink": {
														"name": "DisposalServiceFunction",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['docket_no']"
													},
													"sink": {
														"name": "docket_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ExternalWeight']"
													},
													"sink": {
														"name": "ExternalWeight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['invoice_number']"
													},
													"sink": {
														"name": "invoice_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Levy1Desc']"
													},
													"sink": {
														"name": "Levy1Desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Levy1Rate']"
													},
													"sink": {
														"name": "Levy1Rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Levy1Type']"
													},
													"sink": {
														"name": "Levy1Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['odometer']"
													},
													"sink": {
														"name": "odometer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['plate_no']"
													},
													"sink": {
														"name": "plate_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route']"
													},
													"sink": {
														"name": "route",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_date']"
													},
													"sink": {
														"name": "route_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['route_summary']"
													},
													"sink": {
														"name": "route_summary",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['seq_no']"
													},
													"sink": {
														"name": "seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['serial_no']"
													},
													"sink": {
														"name": "serial_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_number']"
													},
													"sink": {
														"name": "ticket_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_number_old']"
													},
													"sink": {
														"name": "ticket_number_old",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['tip_in_time']"
													},
													"sink": {
														"name": "tip_in_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_out_time']"
													},
													"sink": {
														"name": "tip_out_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_sub_loc_no']"
													},
													"sink": {
														"name": "tip_sub_loc_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_visit_time']"
													},
													"sink": {
														"name": "tip_visit_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_charge']"
													},
													"sink": {
														"name": "total_charge",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_cost']"
													},
													"sink": {
														"name": "total_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_cost_entered']"
													},
													"sink": {
														"name": "total_cost_entered",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['trans_no']"
													},
													"sink": {
														"name": "trans_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['trans_seq']"
													},
													"sink": {
														"name": "trans_seq",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['transmit_no']"
													},
													"sink": {
														"name": "transmit_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['truck']"
													},
													"sink": {
														"name": "truck",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['user_approved']"
													},
													"sink": {
														"name": "user_approved",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['volume']"
													},
													"sink": {
														"name": "volume",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['volume_unit']"
													},
													"sink": {
														"name": "volume_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['weight']"
													},
													"sink": {
														"name": "weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_max']"
													},
													"sink": {
														"name": "weight_max",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_min']"
													},
													"sink": {
														"name": "weight_min",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_orig']"
													},
													"sink": {
														"name": "weight_orig",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_unit']"
													},
													"sink": {
														"name": "weight_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WeightIn']"
													},
													"sink": {
														"name": "WeightIn",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['WeightOut']"
													},
													"sink": {
														"name": "WeightOut",
														"type": "Decimal"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "routetipfee",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "route_tip_fee",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('route_tip_fee_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Route_Summary to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Route Tip Fee to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Bookings']"
													},
													"sink": {
														"name": "Bookings",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Confirmed']"
													},
													"sink": {
														"name": "Confirmed",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['depot']"
													},
													"sink": {
														"name": "depot",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Failed']"
													},
													"sink": {
														"name": "Failed",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['labour_rate_per_hour']"
													},
													"sink": {
														"name": "labour_rate_per_hour",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['labour_rate_per_hour_ot']"
													},
													"sink": {
														"name": "labour_rate_per_hour_ot",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['labour_rate_per_hour_ot2']"
													},
													"sink": {
														"name": "labour_rate_per_hour_ot2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['mdt_no']"
													},
													"sink": {
														"name": "mdt_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['mileage_from_tip']"
													},
													"sink": {
														"name": "mileage_from_tip",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['mileage_to_tip']"
													},
													"sink": {
														"name": "mileage_to_tip",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['normal_labour_hrs']"
													},
													"sink": {
														"name": "normal_labour_hrs",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['notes']"
													},
													"sink": {
														"name": "notes",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['odometer_finish']"
													},
													"sink": {
														"name": "odometer_finish",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['odometer_start']"
													},
													"sink": {
														"name": "odometer_start",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Outstanding']"
													},
													"sink": {
														"name": "Outstanding",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['overtime_labour_hrs']"
													},
													"sink": {
														"name": "overtime_labour_hrs",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['overtime_labour_hrs2']"
													},
													"sink": {
														"name": "overtime_labour_hrs2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['route_date']"
													},
													"sink": {
														"name": "route_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['RouteDescription']"
													},
													"sink": {
														"name": "RouteDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['run_hours']"
													},
													"sink": {
														"name": "run_hours",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['run_meter_finish']"
													},
													"sink": {
														"name": "run_meter_finish",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['run_meter_start']"
													},
													"sink": {
														"name": "run_meter_start",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Sent']"
													},
													"sink": {
														"name": "Sent",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['StatusPercent']"
													},
													"sink": {
														"name": "StatusPercent",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['team_no']"
													},
													"sink": {
														"name": "team_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['time_finish']"
													},
													"sink": {
														"name": "time_finish",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['time_start']"
													},
													"sink": {
														"name": "time_start",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['time_to_tip']"
													},
													"sink": {
														"name": "time_to_tip",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tips_visited']"
													},
													"sink": {
														"name": "tips_visited",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_additional_charge']"
													},
													"sink": {
														"name": "total_additional_charge",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_containers_scheduled']"
													},
													"sink": {
														"name": "total_containers_scheduled",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_containers_serviced']"
													},
													"sink": {
														"name": "total_containers_serviced",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_containers_serviced_old']"
													},
													"sink": {
														"name": "total_containers_serviced_old",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_cubic_meters']"
													},
													"sink": {
														"name": "total_cubic_meters",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_disposal_rebate_costs']"
													},
													"sink": {
														"name": "total_disposal_rebate_costs",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_down_time']"
													},
													"sink": {
														"name": "total_down_time",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_engine_hours']"
													},
													"sink": {
														"name": "total_engine_hours",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_fuel_cost']"
													},
													"sink": {
														"name": "total_fuel_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_fuel_used']"
													},
													"sink": {
														"name": "total_fuel_used",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_kilometers']"
													},
													"sink": {
														"name": "total_kilometers",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_kilometers_gps']"
													},
													"sink": {
														"name": "total_kilometers_gps",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_metric_tons']"
													},
													"sink": {
														"name": "total_metric_tons",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_no_of_main_jobs']"
													},
													"sink": {
														"name": "total_no_of_main_jobs",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_no_of_messages']"
													},
													"sink": {
														"name": "total_no_of_messages",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_no_of_sections']"
													},
													"sink": {
														"name": "total_no_of_sections",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_normal_labour_cost']"
													},
													"sink": {
														"name": "total_normal_labour_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_oil_cost']"
													},
													"sink": {
														"name": "total_oil_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_oil_used']"
													},
													"sink": {
														"name": "total_oil_used",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_overtime_labour_cost']"
													},
													"sink": {
														"name": "total_overtime_labour_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_overtime_labour_cost2']"
													},
													"sink": {
														"name": "total_overtime_labour_cost2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_rcti_costs']"
													},
													"sink": {
														"name": "total_rcti_costs",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_revenue']"
													},
													"sink": {
														"name": "total_revenue",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_run_mileage']"
													},
													"sink": {
														"name": "total_run_mileage",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_run_time']"
													},
													"sink": {
														"name": "total_run_time",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_stops_completed']"
													},
													"sink": {
														"name": "total_stops_completed",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_stops_scheduled']"
													},
													"sink": {
														"name": "total_stops_scheduled",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_subcontr_cost']"
													},
													"sink": {
														"name": "total_subcontr_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_tip_time']"
													},
													"sink": {
														"name": "total_tip_time",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_tip_wait_time']"
													},
													"sink": {
														"name": "total_tip_wait_time",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_tipping_charges']"
													},
													"sink": {
														"name": "total_tipping_charges",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_tipping_costs']"
													},
													"sink": {
														"name": "total_tipping_costs",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_veh_cost_hour']"
													},
													"sink": {
														"name": "total_veh_cost_hour",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_veh_cost_klm']"
													},
													"sink": {
														"name": "total_veh_cost_klm",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_veh_cost_klm_gps']"
													},
													"sink": {
														"name": "total_veh_cost_klm_gps",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['truck_no']"
													},
													"sink": {
														"name": "truck_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UnSent']"
													},
													"sink": {
														"name": "UnSent",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['unused_time']"
													},
													"sink": {
														"name": "unused_time",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['veh_cost_per_hr']"
													},
													"sink": {
														"name": "veh_cost_per_hr",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['veh_cost_per_klm']"
													},
													"sink": {
														"name": "veh_cost_per_klm",
														"type": "Decimal"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "routesummary",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "route_summary",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('route_summary_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Service Custom Price to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Route_Summary to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_cycle']"
													},
													"sink": {
														"name": "bill_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Code']"
													},
													"sink": {
														"name": "Code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['CreateUserID']"
													},
													"sink": {
														"name": "CreateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_number']"
													},
													"sink": {
														"name": "cust_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Department']"
													},
													"sink": {
														"name": "Department",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Description']"
													},
													"sink": {
														"name": "Description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['last_bill_date']"
													},
													"sink": {
														"name": "last_bill_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['LastInvoiceDate']"
													},
													"sink": {
														"name": "LastInvoiceDate",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Line_no']"
													},
													"sink": {
														"name": "Line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['MaxContainers']"
													},
													"sink": {
														"name": "MaxContainers",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['MinContainers']"
													},
													"sink": {
														"name": "MinContainers",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['next_bill_date']"
													},
													"sink": {
														"name": "next_bill_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['NextInvoiceDate']"
													},
													"sink": {
														"name": "NextInvoiceDate",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Price']"
													},
													"sink": {
														"name": "Price",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['price_type']"
													},
													"sink": {
														"name": "price_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PricePer']"
													},
													"sink": {
														"name": "PricePer",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PriceSource']"
													},
													"sink": {
														"name": "PriceSource",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ProfitCentre']"
													},
													"sink": {
														"name": "ProfitCentre",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['service_line_no']"
													},
													"sink": {
														"name": "service_line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Tax']"
													},
													"sink": {
														"name": "Tax",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['useCustomPrice']"
													},
													"sink": {
														"name": "useCustomPrice",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['we_c_pricline_cust_F6CHAR']"
													},
													"sink": {
														"name": "we_c_pricline_cust_F6CHAR",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_c_pricline_cust_F6DATE']"
													},
													"sink": {
														"name": "we_c_pricline_cust_F6DATE",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['we_c_pricline_cust_F6INT']"
													},
													"sink": {
														"name": "we_c_pricline_cust_F6INT",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['we_c_pricline_cust_F6LOG']"
													},
													"sink": {
														"name": "we_c_pricline_cust_F6LOG",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['we_c_pricline_cust_F8DEC']"
													},
													"sink": {
														"name": "we_c_pricline_cust_F8DEC",
														"type": "Decimal"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "servicecustomprice",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "service_custom_price",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('service_custom_price_',item())",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"Entity": {
						"type": "Array",
						"defaultValue": [
							"customer.customer/customer",
							"booking.booking/booking",
							"routetipfee.vehicle/route_tip_fee",
							"tipfee.vehicle/tip_fee",
							"servicecustomprice.customer/service_custom_price",
							"scheduledservice.customer/scheduled_service",
							"routesummary.vehicle/route_summary",
							"service.customer/service"
						]
					},
					"Instance": {
						"type": "Array",
						"defaultValue": [
							"wflex"
						]
					},
					"StartDate": {
						"type": "String"
					},
					"EndDate": {
						"type": "String"
					},
					"Debug": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/WFLEX_date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/WSGNSW_Date')]",
				"[concat(variables('factoryId'), '/datasets/RestAPI_Date')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_WSG_DateQuery_wsgnsw')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "For Each Entity",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('Entity')",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Set StartDate",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "StartDate",
										"value": {
											"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set End Date",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "EndDate",
										"value": {
											"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'yyyy-MM-dd')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set Debug",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "Debug",
										"value": {
											"value": "@concat(item(),'$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Copy WSG NSW to Data Lake",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set StartDate",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Set End Date",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Set Debug",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"additionalColumns": [
												{
													"name": "Instance",
													"value": "wsgvic"
												}
											],
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true",
												"EndCondition:$.has_more": "Const:false",
												"QueryParameters.$start": "$.next_result"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "WSGNSW_Date",
											"type": "DatasetReference",
											"parameters": {
												"API_Instance": {
													"value": "@item()",
													"type": "Expression"
												},
												"pStartDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"pEndDate": {
													"value": "@pipeline().parameters.pEndDate",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"Instance": {
													"value": "wsgnsw",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "For Each Instance",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('Instance')",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Booking to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Customer to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['add_chg_changed']"
													},
													"sink": {
														"name": "add_chg_changed",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['admin_status']"
													},
													"sink": {
														"name": "admin_status",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_1']"
													},
													"sink": {
														"name": "alt_ref_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_2']"
													},
													"sink": {
														"name": "alt_ref_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_serv_1']"
													},
													"sink": {
														"name": "alt_ref_serv_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_serv_2']"
													},
													"sink": {
														"name": "alt_ref_serv_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['application_id']"
													},
													"sink": {
														"name": "application_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_address_1']"
													},
													"sink": {
														"name": "bill_address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_address_2']"
													},
													"sink": {
														"name": "bill_address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_city']"
													},
													"sink": {
														"name": "bill_city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_name']"
													},
													"sink": {
														"name": "bill_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_property_name']"
													},
													"sink": {
														"name": "bill_property_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_state']"
													},
													"sink": {
														"name": "bill_state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_to_swt']"
													},
													"sink": {
														"name": "bill_to_swt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_zip']"
													},
													"sink": {
														"name": "bill_zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bin_attributes']"
													},
													"sink": {
														"name": "bin_attributes",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bins_collected']"
													},
													"sink": {
														"name": "bins_collected",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['booking_custom_price']"
													},
													"sink": {
														"name": "booking_custom_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['booking_id']"
													},
													"sink": {
														"name": "booking_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['booking_update_flag']"
													},
													"sink": {
														"name": "booking_update_flag",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['chargeable']"
													},
													"sink": {
														"name": "chargeable",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['cont_id']"
													},
													"sink": {
														"name": "cont_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_id']"
													},
													"sink": {
														"name": "container_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_size']"
													},
													"sink": {
														"name": "container_size",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['container_type']"
													},
													"sink": {
														"name": "container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_weight']"
													},
													"sink": {
														"name": "container_weight",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['containers']"
													},
													"sink": {
														"name": "containers",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['coord_date']"
													},
													"sink": {
														"name": "coord_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['coord_time']"
													},
													"sink": {
														"name": "coord_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_type']"
													},
													"sink": {
														"name": "coord_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['currency_code']"
													},
													"sink": {
														"name": "currency_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_cust_ref']"
													},
													"sink": {
														"name": "cust_cust_ref",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer_class']"
													},
													"sink": {
														"name": "customer_class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer_service_line_no']"
													},
													"sink": {
														"name": "customer_service_line_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['default_weight']"
													},
													"sink": {
														"name": "default_weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['delivery_serial_no']"
													},
													"sink": {
														"name": "delivery_serial_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['delivery_site_number']"
													},
													"sink": {
														"name": "delivery_site_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['delivery_site_type']"
													},
													"sink": {
														"name": "delivery_site_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Department']"
													},
													"sink": {
														"name": "Department",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['destruction_batch_no']"
													},
													"sink": {
														"name": "destruction_batch_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['destruction_certificate_required']"
													},
													"sink": {
														"name": "destruction_certificate_required",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type']"
													},
													"sink": {
														"name": "disposal_charge_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_incl_charge']"
													},
													"sink": {
														"name": "disposal_incl_charge",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_ticket']"
													},
													"sink": {
														"name": "disposal_ticket",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['driver_comments']"
													},
													"sink": {
														"name": "driver_comments",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_docket_no']"
													},
													"sink": {
														"name": "driver_docket_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['driver_seq_no']"
													},
													"sink": {
														"name": "driver_seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['eba_codes']"
													},
													"sink": {
														"name": "eba_codes",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['email_address']"
													},
													"sink": {
														"name": "email_address",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Exported']"
													},
													"sink": {
														"name": "Exported",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['fax_no']"
													},
													"sink": {
														"name": "fax_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['GetLastestPrice']"
													},
													"sink": {
														"name": "GetLastestPrice",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['HasAttachment']"
													},
													"sink": {
														"name": "HasAttachment",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['invoice_no']"
													},
													"sink": {
														"name": "invoice_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['InvoiceDescription']"
													},
													"sink": {
														"name": "InvoiceDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['job_end_time']"
													},
													"sink": {
														"name": "job_end_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['job_hours']"
													},
													"sink": {
														"name": "job_hours",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['job_serviced_date']"
													},
													"sink": {
														"name": "job_serviced_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['job_start_time']"
													},
													"sink": {
														"name": "job_start_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['jrl_no']"
													},
													"sink": {
														"name": "jrl_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['linked_trans_no']"
													},
													"sink": {
														"name": "linked_trans_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['linked_trans_seq_no']"
													},
													"sink": {
														"name": "linked_trans_seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['map_reference']"
													},
													"sink": {
														"name": "map_reference",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['mdt_cash_payment']"
													},
													"sink": {
														"name": "mdt_cash_payment",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['meters_collected']"
													},
													"sink": {
														"name": "meters_collected",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['multi_total_price']"
													},
													"sink": {
														"name": "multi_total_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['multi_total_price_ex_tax']"
													},
													"sink": {
														"name": "multi_total_price_ex_tax",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['multi_total_tax']"
													},
													"sink": {
														"name": "multi_total_tax",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['OldServType']"
													},
													"sink": {
														"name": "OldServType",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['open_flag']"
													},
													"sink": {
														"name": "open_flag",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['order_no']"
													},
													"sink": {
														"name": "order_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['p_year']"
													},
													"sink": {
														"name": "p_year",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['paid']"
													},
													"sink": {
														"name": "paid",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['period']"
													},
													"sink": {
														"name": "period",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['phone_2']"
													},
													"sink": {
														"name": "phone_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PlannedEndTime']"
													},
													"sink": {
														"name": "PlannedEndTime",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PlannedStartTime']"
													},
													"sink": {
														"name": "PlannedStartTime",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['po_no']"
													},
													"sink": {
														"name": "po_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['prev_trans_status']"
													},
													"sink": {
														"name": "prev_trans_status",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['price_line_no']"
													},
													"sink": {
														"name": "price_line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['price_rate']"
													},
													"sink": {
														"name": "price_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Priority']"
													},
													"sink": {
														"name": "Priority",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ProfitCentre']"
													},
													"sink": {
														"name": "ProfitCentre",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['prorated_tip_cost']"
													},
													"sink": {
														"name": "prorated_tip_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['rcti_batch']"
													},
													"sink": {
														"name": "rcti_batch",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rcti_no']"
													},
													"sink": {
														"name": "rcti_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['reason_code']"
													},
													"sink": {
														"name": "reason_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['removal_serial_no']"
													},
													"sink": {
														"name": "removal_serial_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['removal_site_number']"
													},
													"sink": {
														"name": "removal_site_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['removal_site_type']"
													},
													"sink": {
														"name": "removal_site_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_1']"
													},
													"sink": {
														"name": "route_directions_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_2']"
													},
													"sink": {
														"name": "route_directions_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_3']"
													},
													"sink": {
														"name": "route_directions_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_4']"
													},
													"sink": {
														"name": "route_directions_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['run_gen_batch']"
													},
													"sink": {
														"name": "run_gen_batch",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SendTipFeeAttachments']"
													},
													"sink": {
														"name": "SendTipFeeAttachments",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['sent_flag']"
													},
													"sink": {
														"name": "sent_flag",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_addr_1']"
													},
													"sink": {
														"name": "serv_addr_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_addr_2']"
													},
													"sink": {
														"name": "serv_addr_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_city']"
													},
													"sink": {
														"name": "serv_city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_contact']"
													},
													"sink": {
														"name": "serv_contact",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_country']"
													},
													"sink": {
														"name": "serv_country",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc_1']"
													},
													"sink": {
														"name": "serv_desc_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc_2']"
													},
													"sink": {
														"name": "serv_desc_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc_3']"
													},
													"sink": {
														"name": "serv_desc_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc_4']"
													},
													"sink": {
														"name": "serv_desc_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_name']"
													},
													"sink": {
														"name": "serv_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_no']"
													},
													"sink": {
														"name": "serv_no",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['serv_phone']"
													},
													"sink": {
														"name": "serv_phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_property_name']"
													},
													"sink": {
														"name": "serv_property_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_state']"
													},
													"sink": {
														"name": "serv_state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_time_code']"
													},
													"sink": {
														"name": "serv_time_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_type']"
													},
													"sink": {
														"name": "serv_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_zip']"
													},
													"sink": {
														"name": "serv_zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['service_line_no']"
													},
													"sink": {
														"name": "service_line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['site_number']"
													},
													"sink": {
														"name": "site_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['status']"
													},
													"sink": {
														"name": "status",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['temp_code']"
													},
													"sink": {
														"name": "temp_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TempLedgerAccount']"
													},
													"sink": {
														"name": "TempLedgerAccount",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_required']"
													},
													"sink": {
														"name": "ticket_required",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['tip_fee']"
													},
													"sink": {
														"name": "tip_fee",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_price']"
													},
													"sink": {
														"name": "total_price",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_price_ex_tax']"
													},
													"sink": {
														"name": "total_price_ex_tax",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trans_date']"
													},
													"sink": {
														"name": "trans_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['trans_entry_date']"
													},
													"sink": {
														"name": "trans_entry_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['trans_entry_id']"
													},
													"sink": {
														"name": "trans_entry_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trans_entry_time']"
													},
													"sink": {
														"name": "trans_entry_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trans_no']"
													},
													"sink": {
														"name": "trans_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['trans_seq_no']"
													},
													"sink": {
														"name": "trans_seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['trans_update_date']"
													},
													"sink": {
														"name": "trans_update_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['trans_update_id']"
													},
													"sink": {
														"name": "trans_update_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trans_update_time']"
													},
													"sink": {
														"name": "trans_update_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['truck_no']"
													},
													"sink": {
														"name": "truck_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['updated']"
													},
													"sink": {
														"name": "updated",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['usePriceCode']"
													},
													"sink": {
														"name": "usePriceCode",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['user_id']"
													},
													"sink": {
														"name": "user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['vehicle_class']"
													},
													"sink": {
														"name": "vehicle_class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WasteOutcome']"
													},
													"sink": {
														"name": "WasteOutcome",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_equip_codes']"
													},
													"sink": {
														"name": "we_equip_codes",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_helpers']"
													},
													"sink": {
														"name": "we_helpers",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_price']"
													},
													"sink": {
														"name": "we_price",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['we_price_code']"
													},
													"sink": {
														"name": "we_price_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_price_discount_label']"
													},
													"sink": {
														"name": "we_price_discount_label",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_tax']"
													},
													"sink": {
														"name": "we_tax",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['zone_no']"
													},
													"sink": {
														"name": "zone_no",
														"type": "Int32"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "booking",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "booking",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('booking_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Customer to DB",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"modifiedDatetimeStart": "2022-12-21T00:00:00.335Z",
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['accounting_acc_no']"
													},
													"sink": {
														"name": "accounting_acc_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['accounting_bal_due_days']"
													},
													"sink": {
														"name": "accounting_bal_due_days",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['accounting_cust_id']"
													},
													"sink": {
														"name": "accounting_cust_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['accounting_vendor_id']"
													},
													"sink": {
														"name": "accounting_vendor_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_1']"
													},
													"sink": {
														"name": "address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_2']"
													},
													"sink": {
														"name": "address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alternate_id']"
													},
													"sink": {
														"name": "alternate_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['anzsic_code']"
													},
													"sink": {
														"name": "anzsic_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['approval_contact']"
													},
													"sink": {
														"name": "approval_contact",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['approval_email']"
													},
													"sink": {
														"name": "approval_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['approval_phone']"
													},
													"sink": {
														"name": "approval_phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['apt_no']"
													},
													"sink": {
														"name": "apt_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AttachmentCategories']"
													},
													"sink": {
														"name": "AttachmentCategories",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AutoStopCreditOff']"
													},
													"sink": {
														"name": "AutoStopCreditOff",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['AutoStopCreditOn']"
													},
													"sink": {
														"name": "AutoStopCreditOn",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['bank_acct_no']"
													},
													"sink": {
														"name": "bank_acct_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bank_name']"
													},
													"sink": {
														"name": "bank_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_cycle']"
													},
													"sink": {
														"name": "bill_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_to_swt']"
													},
													"sink": {
														"name": "bill_to_swt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['book_alt_ref1']"
													},
													"sink": {
														"name": "book_alt_ref1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['book_alt_ref2']"
													},
													"sink": {
														"name": "book_alt_ref2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['BusinessType']"
													},
													"sink": {
														"name": "BusinessType",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cash_account']"
													},
													"sink": {
														"name": "cash_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cash_cardname']"
													},
													"sink": {
														"name": "cash_cardname",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cash_expiry']"
													},
													"sink": {
														"name": "cash_expiry",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cash_method']"
													},
													"sink": {
														"name": "cash_method",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['city']"
													},
													"sink": {
														"name": "city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_1']"
													},
													"sink": {
														"name": "classification_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_2']"
													},
													"sink": {
														"name": "classification_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_3']"
													},
													"sink": {
														"name": "classification_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_4']"
													},
													"sink": {
														"name": "classification_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_5']"
													},
													"sink": {
														"name": "classification_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_6']"
													},
													"sink": {
														"name": "classification_6",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_7']"
													},
													"sink": {
														"name": "classification_7",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_8']"
													},
													"sink": {
														"name": "classification_8",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_9']"
													},
													"sink": {
														"name": "classification_9",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_10']"
													},
													"sink": {
														"name": "classification_10",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contribution_entitlement']"
													},
													"sink": {
														"name": "contribution_entitlement",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['contribution_entitlement_total']"
													},
													"sink": {
														"name": "contribution_entitlement_total",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['coord_date']"
													},
													"sink": {
														"name": "coord_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['coord_time']"
													},
													"sink": {
														"name": "coord_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_type']"
													},
													"sink": {
														"name": "coord_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['country_code']"
													},
													"sink": {
														"name": "country_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['county']"
													},
													"sink": {
														"name": "county",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_date']"
													},
													"sink": {
														"name": "create_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['credit_contact']"
													},
													"sink": {
														"name": "credit_contact",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['credit_email']"
													},
													"sink": {
														"name": "credit_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['credit_limit']"
													},
													"sink": {
														"name": "credit_limit",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['credit_limit_warn_amt']"
													},
													"sink": {
														"name": "credit_limit_warn_amt",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['credit_phone']"
													},
													"sink": {
														"name": "credit_phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CTSName']"
													},
													"sink": {
														"name": "CTSName",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CTSNumber']"
													},
													"sink": {
														"name": "CTSNumber",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['currency_code']"
													},
													"sink": {
														"name": "currency_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_1']"
													},
													"sink": {
														"name": "cust_class_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_2']"
													},
													"sink": {
														"name": "cust_class_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_3']"
													},
													"sink": {
														"name": "cust_class_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_4']"
													},
													"sink": {
														"name": "cust_class_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_5']"
													},
													"sink": {
														"name": "cust_class_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_group']"
													},
													"sink": {
														"name": "cust_group",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_number']"
													},
													"sink": {
														"name": "cust_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['cust_seq_no']"
													},
													"sink": {
														"name": "cust_seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['cust_type']"
													},
													"sink": {
														"name": "cust_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer_class']"
													},
													"sink": {
														"name": "customer_class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cut_off_swt']"
													},
													"sink": {
														"name": "cut_off_swt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_closed_1']"
													},
													"sink": {
														"name": "day_closed_1",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_2']"
													},
													"sink": {
														"name": "day_closed_2",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_3']"
													},
													"sink": {
														"name": "day_closed_3",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_4']"
													},
													"sink": {
														"name": "day_closed_4",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_5']"
													},
													"sink": {
														"name": "day_closed_5",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_6']"
													},
													"sink": {
														"name": "day_closed_6",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_7']"
													},
													"sink": {
														"name": "day_closed_7",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_1']"
													},
													"sink": {
														"name": "day_not_after_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_2']"
													},
													"sink": {
														"name": "day_not_after_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_3']"
													},
													"sink": {
														"name": "day_not_after_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_4']"
													},
													"sink": {
														"name": "day_not_after_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_5']"
													},
													"sink": {
														"name": "day_not_after_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_6']"
													},
													"sink": {
														"name": "day_not_after_6",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_7']"
													},
													"sink": {
														"name": "day_not_after_7",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_1']"
													},
													"sink": {
														"name": "day_not_before_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_2']"
													},
													"sink": {
														"name": "day_not_before_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_3']"
													},
													"sink": {
														"name": "day_not_before_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_4']"
													},
													"sink": {
														"name": "day_not_before_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_5']"
													},
													"sink": {
														"name": "day_not_before_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_6']"
													},
													"sink": {
														"name": "day_not_before_6",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_7']"
													},
													"sink": {
														"name": "day_not_before_7",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['default_tax_perc']"
													},
													"sink": {
														"name": "default_tax_perc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_site']"
													},
													"sink": {
														"name": "disposal_site",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['docket_req']"
													},
													"sink": {
														"name": "docket_req",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['drawer']"
													},
													"sink": {
														"name": "drawer",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['email_address']"
													},
													"sink": {
														"name": "email_address",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['fax_no']"
													},
													"sink": {
														"name": "fax_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['FilteredWithAttributes']"
													},
													"sink": {
														"name": "FilteredWithAttributes",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['first_dd_date']"
													},
													"sink": {
														"name": "first_dd_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['government_no']"
													},
													"sink": {
														"name": "government_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['historical_date']"
													},
													"sink": {
														"name": "historical_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['house_no']"
													},
													"sink": {
														"name": "house_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['house_no_text']"
													},
													"sink": {
														"name": "house_no_text",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['in_collection_area']"
													},
													"sink": {
														"name": "in_collection_area",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['internal_account']"
													},
													"sink": {
														"name": "internal_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['invoice_email']"
													},
													"sink": {
														"name": "invoice_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['invoice_send_method']"
													},
													"sink": {
														"name": "invoice_send_method",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['invoice_send_method_we']"
													},
													"sink": {
														"name": "invoice_send_method_we",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['InvoiceStyle']"
													},
													"sink": {
														"name": "InvoiceStyle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['is_rcti']"
													},
													"sink": {
														"name": "is_rcti",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['LastPaymentDate']"
													},
													"sink": {
														"name": "LastPaymentDate",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['lot_no']"
													},
													"sink": {
														"name": "lot_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['map_reference']"
													},
													"sink": {
														"name": "map_reference",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['module']"
													},
													"sink": {
														"name": "module",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MultiSiteOneEmail']"
													},
													"sink": {
														"name": "MultiSiteOneEmail",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['name']"
													},
													"sink": {
														"name": "name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['NoService']"
													},
													"sink": {
														"name": "NoService",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['par_billto_cust_number']"
													},
													"sink": {
														"name": "par_billto_cust_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['parcel_key']"
													},
													"sink": {
														"name": "parcel_key",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['phone']"
													},
													"sink": {
														"name": "phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Phone2']"
													},
													"sink": {
														"name": "Phone2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['po_no']"
													},
													"sink": {
														"name": "po_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['POChain']"
													},
													"sink": {
														"name": "POChain",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['possession_date']"
													},
													"sink": {
														"name": "possession_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['postal_address_1']"
													},
													"sink": {
														"name": "postal_address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_address_2']"
													},
													"sink": {
														"name": "postal_address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_city']"
													},
													"sink": {
														"name": "postal_city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_country_code']"
													},
													"sink": {
														"name": "postal_country_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_county']"
													},
													"sink": {
														"name": "postal_county",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_name']"
													},
													"sink": {
														"name": "postal_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_property_name']"
													},
													"sink": {
														"name": "postal_property_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_state']"
													},
													"sink": {
														"name": "postal_state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_zip']"
													},
													"sink": {
														"name": "postal_zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['property_name']"
													},
													"sink": {
														"name": "property_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['protected_from']"
													},
													"sink": {
														"name": "protected_from",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['protected_to']"
													},
													"sink": {
														"name": "protected_to",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['rate_account_number']"
													},
													"sink": {
														"name": "rate_account_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rcti_email']"
													},
													"sink": {
														"name": "rcti_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['registration_date']"
													},
													"sink": {
														"name": "registration_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['renter_owner_swt']"
													},
													"sink": {
														"name": "renter_owner_swt",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rp_master']"
													},
													"sink": {
														"name": "rp_master",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['rp_number']"
													},
													"sink": {
														"name": "rp_number",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['sales_id']"
													},
													"sink": {
														"name": "sales_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['sales_territory']"
													},
													"sink": {
														"name": "sales_territory",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SecondaryZones']"
													},
													"sink": {
														"name": "SecondaryZones",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SendDocketsWithInvoice']"
													},
													"sink": {
														"name": "SendDocketsWithInvoice",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['serv_contact']"
													},
													"sink": {
														"name": "serv_contact",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SignatureMandatoryOnMDT']"
													},
													"sink": {
														"name": "SignatureMandatoryOnMDT",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['stat']"
													},
													"sink": {
														"name": "stat",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['state']"
													},
													"sink": {
														"name": "state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['statement_email']"
													},
													"sink": {
														"name": "statement_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['street_code']"
													},
													"sink": {
														"name": "street_code",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['street_section']"
													},
													"sink": {
														"name": "street_section",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['temp_susp_ed']"
													},
													"sink": {
														"name": "temp_susp_ed",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['temp_susp_sd']"
													},
													"sink": {
														"name": "temp_susp_sd",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['terms_code']"
													},
													"sink": {
														"name": "terms_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['town_code']"
													},
													"sink": {
														"name": "town_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trade_name']"
													},
													"sink": {
														"name": "trade_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UsePOChain']"
													},
													"sink": {
														"name": "UsePOChain",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['waste_precinct']"
													},
													"sink": {
														"name": "waste_precinct",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zip']"
													},
													"sink": {
														"name": "zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zone_code']"
													},
													"sink": {
														"name": "zone_code",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "customer",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "customer",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('Customer_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Service to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Booking to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_serv_1']"
													},
													"sink": {
														"name": "alt_ref_serv_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_serv_2']"
													},
													"sink": {
														"name": "alt_ref_serv_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['application_id']"
													},
													"sink": {
														"name": "application_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ApplyMinimumBookingPriceTo']"
													},
													"sink": {
														"name": "ApplyMinimumBookingPriceTo",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_cycle']"
													},
													"sink": {
														"name": "bill_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BillingQtySwitch']"
													},
													"sink": {
														"name": "BillingQtySwitch",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['budget_lifts']"
													},
													"sink": {
														"name": "budget_lifts",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['cancel_serv_date']"
													},
													"sink": {
														"name": "cancel_serv_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['chargeable']"
													},
													"sink": {
														"name": "chargeable",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['container_type']"
													},
													"sink": {
														"name": "container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['containers']"
													},
													"sink": {
														"name": "containers",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['contract_desc_1']"
													},
													"sink": {
														"name": "contract_desc_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_desc_2']"
													},
													"sink": {
														"name": "contract_desc_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_desc_3']"
													},
													"sink": {
														"name": "contract_desc_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_desc_4']"
													},
													"sink": {
														"name": "contract_desc_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_end_date']"
													},
													"sink": {
														"name": "contract_end_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['contract_no']"
													},
													"sink": {
														"name": "contract_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_str_date']"
													},
													"sink": {
														"name": "contract_str_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['contractor_no']"
													},
													"sink": {
														"name": "contractor_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['currency_code']"
													},
													"sink": {
														"name": "currency_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['destruction_certificate_required']"
													},
													"sink": {
														"name": "destruction_certificate_required",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc']"
													},
													"sink": {
														"name": "disposal_charge_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc2']"
													},
													"sink": {
														"name": "disposal_charge_desc2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc3']"
													},
													"sink": {
														"name": "disposal_charge_desc3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc_ex']"
													},
													"sink": {
														"name": "disposal_charge_desc_ex",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate']"
													},
													"sink": {
														"name": "disposal_charge_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate2']"
													},
													"sink": {
														"name": "disposal_charge_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate3']"
													},
													"sink": {
														"name": "disposal_charge_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex2']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex3']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type']"
													},
													"sink": {
														"name": "disposal_charge_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type2']"
													},
													"sink": {
														"name": "disposal_charge_type2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type3']"
													},
													"sink": {
														"name": "disposal_charge_type3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex']"
													},
													"sink": {
														"name": "disposal_charge_type_ex",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex2']"
													},
													"sink": {
														"name": "disposal_charge_type_ex2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex3']"
													},
													"sink": {
														"name": "disposal_charge_type_ex3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_default_weight']"
													},
													"sink": {
														"name": "disposal_default_weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_default_weight_max']"
													},
													"sink": {
														"name": "disposal_default_weight_max",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_default_weight_min']"
													},
													"sink": {
														"name": "disposal_default_weight_min",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_incl_charge']"
													},
													"sink": {
														"name": "disposal_incl_charge",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Disposal_Levy1Desc']"
													},
													"sink": {
														"name": "Disposal_Levy1Desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Disposal_Levy1Rate']"
													},
													"sink": {
														"name": "Disposal_Levy1Rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Disposal_Levy1Type']"
													},
													"sink": {
														"name": "Disposal_Levy1Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_site']"
													},
													"sink": {
														"name": "disposal_site",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_unit_meas']"
													},
													"sink": {
														"name": "disposal_unit_meas",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex",
														"type": "Double"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex2']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex3']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Disposal_weight_min']"
													},
													"sink": {
														"name": "Disposal_weight_min",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['facility_code']"
													},
													"sink": {
														"name": "facility_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['facility_number']"
													},
													"sink": {
														"name": "facility_number",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['float_next_date']"
													},
													"sink": {
														"name": "float_next_date",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['frequency']"
													},
													"sink": {
														"name": "frequency",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['indemnification_on_file']"
													},
													"sink": {
														"name": "indemnification_on_file",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['initial_serv_date']"
													},
													"sink": {
														"name": "initial_serv_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['InvoiceDescription']"
													},
													"sink": {
														"name": "InvoiceDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['last_bill_date']"
													},
													"sink": {
														"name": "last_bill_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['line_no']"
													},
													"sink": {
														"name": "line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['line_notes_1']"
													},
													"sink": {
														"name": "line_notes_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_notes_2']"
													},
													"sink": {
														"name": "line_notes_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_notes_3']"
													},
													"sink": {
														"name": "line_notes_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_notes_4']"
													},
													"sink": {
														"name": "line_notes_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['next_bill_date']"
													},
													"sink": {
														"name": "next_bill_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['next_care_cert_due']"
													},
													"sink": {
														"name": "next_care_cert_due",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['owned_flag']"
													},
													"sink": {
														"name": "owned_flag",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['ParentService']"
													},
													"sink": {
														"name": "ParentService",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['pickup_days']"
													},
													"sink": {
														"name": "pickup_days",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['po_no']"
													},
													"sink": {
														"name": "po_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['POChain']"
													},
													"sink": {
														"name": "POChain",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['pref_serv_time']"
													},
													"sink": {
														"name": "pref_serv_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['price_increase_exempt_date']"
													},
													"sink": {
														"name": "price_increase_exempt_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['rate_exempt']"
													},
													"sink": {
														"name": "rate_exempt",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['rent_days']"
													},
													"sink": {
														"name": "rent_days",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rent_free_days']"
													},
													"sink": {
														"name": "rent_free_days",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['repeating_loads']"
													},
													"sink": {
														"name": "repeating_loads",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['route']"
													},
													"sink": {
														"name": "route",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_collection']"
													},
													"sink": {
														"name": "route_collection",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['route_cycle']"
													},
													"sink": {
														"name": "route_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_1']"
													},
													"sink": {
														"name": "route_directions_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_2']"
													},
													"sink": {
														"name": "route_directions_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_3']"
													},
													"sink": {
														"name": "route_directions_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_4']"
													},
													"sink": {
														"name": "route_directions_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['sales_id_1']"
													},
													"sink": {
														"name": "sales_id_1",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['sch_end_time']"
													},
													"sink": {
														"name": "sch_end_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['sch_start_time']"
													},
													"sink": {
														"name": "sch_start_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SendTipFeeAttachments']"
													},
													"sink": {
														"name": "SendTipFeeAttachments",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_type']"
													},
													"sink": {
														"name": "serv_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SharedService']"
													},
													"sink": {
														"name": "SharedService",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['site_location_ref_no']"
													},
													"sink": {
														"name": "site_location_ref_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['subcontractor_line_no']"
													},
													"sink": {
														"name": "subcontractor_line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['temp_code']"
													},
													"sink": {
														"name": "temp_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_required']"
													},
													"sink": {
														"name": "ticket_required",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Time_at_site']"
													},
													"sink": {
														"name": "Time_at_site",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UseForAllSites']"
													},
													"sink": {
														"name": "UseForAllSites",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['UsePOChain']"
													},
													"sink": {
														"name": "UsePOChain",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_price_code']"
													},
													"sink": {
														"name": "we_price_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WeightLimitSwitch']"
													},
													"sink": {
														"name": "WeightLimitSwitch",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "service",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "service",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('service_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Scheduled Service to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Service to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"preCopyScript": "delete from scheduled_service_wsgvic",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['cont_number']"
													},
													"sink": {
														"name": "cont_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['display_order']"
													},
													"sink": {
														"name": "display_order",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['EndDate']"
													},
													"sink": {
														"name": "EndDate",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['ending_house']"
													},
													"sink": {
														"name": "ending_house",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['expected_metres']"
													},
													"sink": {
														"name": "expected_metres",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['first_service_date']"
													},
													"sink": {
														"name": "first_service_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['last_mdt_seq']"
													},
													"sink": {
														"name": "last_mdt_seq",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['line_no']"
													},
													"sink": {
														"name": "line_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_type']"
													},
													"sink": {
														"name": "line_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['navigation']"
													},
													"sink": {
														"name": "navigation",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['next_service_date']"
													},
													"sink": {
														"name": "next_service_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['route_line']"
													},
													"sink": {
														"name": "route_line",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['route_msg']"
													},
													"sink": {
														"name": "route_msg",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['schedule_no']"
													},
													"sink": {
														"name": "schedule_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['section']"
													},
													"sink": {
														"name": "section",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['segment_length']"
													},
													"sink": {
														"name": "segment_length",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['StartDate']"
													},
													"sink": {
														"name": "StartDate",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['street_code']"
													},
													"sink": {
														"name": "street_code",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "scheduledservice",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "scheduled_service",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('scheduled_service_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Tip Fee to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Scheduled Service to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"preCopyScript": {
												"value": "delete from @{concat('tip_fee_',item())}",
												"type": "Expression"
											},
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_qty']"
													},
													"sink": {
														"name": "alt_qty",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['alt_qty_unit']"
													},
													"sink": {
														"name": "alt_qty_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['booking']"
													},
													"sink": {
														"name": "booking",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['cont_id']"
													},
													"sink": {
														"name": "cont_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_date']"
													},
													"sink": {
														"name": "coord_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['coord_time']"
													},
													"sink": {
														"name": "coord_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_type']"
													},
													"sink": {
														"name": "coord_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['date_accrual']"
													},
													"sink": {
														"name": "date_accrual",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['date_approved']"
													},
													"sink": {
														"name": "date_approved",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['date_paid']"
													},
													"sink": {
														"name": "date_paid",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc']"
													},
													"sink": {
														"name": "disposal_charge_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc2']"
													},
													"sink": {
														"name": "disposal_charge_desc2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc3']"
													},
													"sink": {
														"name": "disposal_charge_desc3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate']"
													},
													"sink": {
														"name": "disposal_charge_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate2']"
													},
													"sink": {
														"name": "disposal_charge_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate3']"
													},
													"sink": {
														"name": "disposal_charge_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex2']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex3']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type']"
													},
													"sink": {
														"name": "disposal_charge_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type2']"
													},
													"sink": {
														"name": "disposal_charge_type2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type3']"
													},
													"sink": {
														"name": "disposal_charge_type3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex']"
													},
													"sink": {
														"name": "disposal_charge_type_ex",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex2']"
													},
													"sink": {
														"name": "disposal_charge_type_ex2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex3']"
													},
													"sink": {
														"name": "disposal_charge_type_ex3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate']"
													},
													"sink": {
														"name": "disposal_cost_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate2']"
													},
													"sink": {
														"name": "disposal_cost_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate3']"
													},
													"sink": {
														"name": "disposal_cost_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate_ex']"
													},
													"sink": {
														"name": "disposal_cost_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate_type']"
													},
													"sink": {
														"name": "disposal_cost_rate_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_date']"
													},
													"sink": {
														"name": "disposal_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['disposal_incl_charge']"
													},
													"sink": {
														"name": "disposal_incl_charge",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_site']"
													},
													"sink": {
														"name": "disposal_site",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex2']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex3']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['DisposalServiceFunction']"
													},
													"sink": {
														"name": "DisposalServiceFunction",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['docket_no']"
													},
													"sink": {
														"name": "docket_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ExternalWeight']"
													},
													"sink": {
														"name": "ExternalWeight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['invoice_number']"
													},
													"sink": {
														"name": "invoice_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Levy1Desc']"
													},
													"sink": {
														"name": "Levy1Desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Levy1Rate']"
													},
													"sink": {
														"name": "Levy1Rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Levy1Type']"
													},
													"sink": {
														"name": "Levy1Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['odometer']"
													},
													"sink": {
														"name": "odometer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['plate_no']"
													},
													"sink": {
														"name": "plate_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route']"
													},
													"sink": {
														"name": "route",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_date']"
													},
													"sink": {
														"name": "route_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['route_summary']"
													},
													"sink": {
														"name": "route_summary",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['seq_no']"
													},
													"sink": {
														"name": "seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['serial_no']"
													},
													"sink": {
														"name": "serial_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_number']"
													},
													"sink": {
														"name": "ticket_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_number_old']"
													},
													"sink": {
														"name": "ticket_number_old",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['tip_in_time']"
													},
													"sink": {
														"name": "tip_in_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_out_time']"
													},
													"sink": {
														"name": "tip_out_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_sub_loc_no']"
													},
													"sink": {
														"name": "tip_sub_loc_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_visit_time']"
													},
													"sink": {
														"name": "tip_visit_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_charge']"
													},
													"sink": {
														"name": "total_charge",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_cost']"
													},
													"sink": {
														"name": "total_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_cost_entered']"
													},
													"sink": {
														"name": "total_cost_entered",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['trans_no']"
													},
													"sink": {
														"name": "trans_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['trans_seq']"
													},
													"sink": {
														"name": "trans_seq",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['transmit_no']"
													},
													"sink": {
														"name": "transmit_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['truck']"
													},
													"sink": {
														"name": "truck",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['user_approved']"
													},
													"sink": {
														"name": "user_approved",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['volume']"
													},
													"sink": {
														"name": "volume",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['volume_unit']"
													},
													"sink": {
														"name": "volume_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['weight']"
													},
													"sink": {
														"name": "weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_max']"
													},
													"sink": {
														"name": "weight_max",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_min']"
													},
													"sink": {
														"name": "weight_min",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_orig']"
													},
													"sink": {
														"name": "weight_orig",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_unit']"
													},
													"sink": {
														"name": "weight_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WeightIn']"
													},
													"sink": {
														"name": "WeightIn",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['WeightOut']"
													},
													"sink": {
														"name": "WeightOut",
														"type": "Decimal"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "tipfee",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "tip_fee",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('tip_fee_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Route Tip Fee to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Tip Fee to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_qty']"
													},
													"sink": {
														"name": "alt_qty",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['alt_qty_unit']"
													},
													"sink": {
														"name": "alt_qty_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['cont_id']"
													},
													"sink": {
														"name": "cont_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_date']"
													},
													"sink": {
														"name": "coord_date",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_time']"
													},
													"sink": {
														"name": "coord_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_type']"
													},
													"sink": {
														"name": "coord_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['date_accrual']"
													},
													"sink": {
														"name": "date_accrual",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['date_approved']"
													},
													"sink": {
														"name": "date_approved",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['date_paid']"
													},
													"sink": {
														"name": "date_paid",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc']"
													},
													"sink": {
														"name": "disposal_charge_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc2']"
													},
													"sink": {
														"name": "disposal_charge_desc2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc3']"
													},
													"sink": {
														"name": "disposal_charge_desc3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate']"
													},
													"sink": {
														"name": "disposal_charge_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate2']"
													},
													"sink": {
														"name": "disposal_charge_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate3']"
													},
													"sink": {
														"name": "disposal_charge_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex2']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex3']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type']"
													},
													"sink": {
														"name": "disposal_charge_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type2']"
													},
													"sink": {
														"name": "disposal_charge_type2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type3']"
													},
													"sink": {
														"name": "disposal_charge_type3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex']"
													},
													"sink": {
														"name": "disposal_charge_type_ex",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex2']"
													},
													"sink": {
														"name": "disposal_charge_type_ex2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex3']"
													},
													"sink": {
														"name": "disposal_charge_type_ex3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate']"
													},
													"sink": {
														"name": "disposal_cost_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate2']"
													},
													"sink": {
														"name": "disposal_cost_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate3']"
													},
													"sink": {
														"name": "disposal_cost_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate_ex']"
													},
													"sink": {
														"name": "disposal_cost_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate_type']"
													},
													"sink": {
														"name": "disposal_cost_rate_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_date']"
													},
													"sink": {
														"name": "disposal_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['disposal_incl_charge']"
													},
													"sink": {
														"name": "disposal_incl_charge",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_site']"
													},
													"sink": {
														"name": "disposal_site",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex2']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex3']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['DisposalServiceFunction']"
													},
													"sink": {
														"name": "DisposalServiceFunction",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['docket_no']"
													},
													"sink": {
														"name": "docket_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ExternalWeight']"
													},
													"sink": {
														"name": "ExternalWeight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['invoice_number']"
													},
													"sink": {
														"name": "invoice_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Levy1Desc']"
													},
													"sink": {
														"name": "Levy1Desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Levy1Rate']"
													},
													"sink": {
														"name": "Levy1Rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Levy1Type']"
													},
													"sink": {
														"name": "Levy1Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['odometer']"
													},
													"sink": {
														"name": "odometer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['plate_no']"
													},
													"sink": {
														"name": "plate_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route']"
													},
													"sink": {
														"name": "route",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_date']"
													},
													"sink": {
														"name": "route_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['route_summary']"
													},
													"sink": {
														"name": "route_summary",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['seq_no']"
													},
													"sink": {
														"name": "seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['serial_no']"
													},
													"sink": {
														"name": "serial_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_number']"
													},
													"sink": {
														"name": "ticket_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_number_old']"
													},
													"sink": {
														"name": "ticket_number_old",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['tip_in_time']"
													},
													"sink": {
														"name": "tip_in_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_out_time']"
													},
													"sink": {
														"name": "tip_out_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_sub_loc_no']"
													},
													"sink": {
														"name": "tip_sub_loc_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_visit_time']"
													},
													"sink": {
														"name": "tip_visit_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_charge']"
													},
													"sink": {
														"name": "total_charge",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_cost']"
													},
													"sink": {
														"name": "total_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_cost_entered']"
													},
													"sink": {
														"name": "total_cost_entered",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['trans_no']"
													},
													"sink": {
														"name": "trans_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['trans_seq']"
													},
													"sink": {
														"name": "trans_seq",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['transmit_no']"
													},
													"sink": {
														"name": "transmit_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['truck']"
													},
													"sink": {
														"name": "truck",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['user_approved']"
													},
													"sink": {
														"name": "user_approved",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['volume']"
													},
													"sink": {
														"name": "volume",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['volume_unit']"
													},
													"sink": {
														"name": "volume_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['weight']"
													},
													"sink": {
														"name": "weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_max']"
													},
													"sink": {
														"name": "weight_max",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_min']"
													},
													"sink": {
														"name": "weight_min",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_orig']"
													},
													"sink": {
														"name": "weight_orig",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_unit']"
													},
													"sink": {
														"name": "weight_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WeightIn']"
													},
													"sink": {
														"name": "WeightIn",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['WeightOut']"
													},
													"sink": {
														"name": "WeightOut",
														"type": "Decimal"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "routetipfee",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "route_tip_fee",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('route_tip_fee_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Route_Summary to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Route Tip Fee to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Bookings']"
													},
													"sink": {
														"name": "Bookings",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Confirmed']"
													},
													"sink": {
														"name": "Confirmed",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['depot']"
													},
													"sink": {
														"name": "depot",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Failed']"
													},
													"sink": {
														"name": "Failed",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['labour_rate_per_hour']"
													},
													"sink": {
														"name": "labour_rate_per_hour",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['labour_rate_per_hour_ot']"
													},
													"sink": {
														"name": "labour_rate_per_hour_ot",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['labour_rate_per_hour_ot2']"
													},
													"sink": {
														"name": "labour_rate_per_hour_ot2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['mdt_no']"
													},
													"sink": {
														"name": "mdt_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['mileage_from_tip']"
													},
													"sink": {
														"name": "mileage_from_tip",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['mileage_to_tip']"
													},
													"sink": {
														"name": "mileage_to_tip",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['normal_labour_hrs']"
													},
													"sink": {
														"name": "normal_labour_hrs",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['notes']"
													},
													"sink": {
														"name": "notes",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['odometer_finish']"
													},
													"sink": {
														"name": "odometer_finish",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['odometer_start']"
													},
													"sink": {
														"name": "odometer_start",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Outstanding']"
													},
													"sink": {
														"name": "Outstanding",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['overtime_labour_hrs']"
													},
													"sink": {
														"name": "overtime_labour_hrs",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['overtime_labour_hrs2']"
													},
													"sink": {
														"name": "overtime_labour_hrs2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['route_date']"
													},
													"sink": {
														"name": "route_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['RouteDescription']"
													},
													"sink": {
														"name": "RouteDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['run_hours']"
													},
													"sink": {
														"name": "run_hours",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['run_meter_finish']"
													},
													"sink": {
														"name": "run_meter_finish",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['run_meter_start']"
													},
													"sink": {
														"name": "run_meter_start",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Sent']"
													},
													"sink": {
														"name": "Sent",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['StatusPercent']"
													},
													"sink": {
														"name": "StatusPercent",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['team_no']"
													},
													"sink": {
														"name": "team_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['time_finish']"
													},
													"sink": {
														"name": "time_finish",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['time_start']"
													},
													"sink": {
														"name": "time_start",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['time_to_tip']"
													},
													"sink": {
														"name": "time_to_tip",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tips_visited']"
													},
													"sink": {
														"name": "tips_visited",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_additional_charge']"
													},
													"sink": {
														"name": "total_additional_charge",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_containers_scheduled']"
													},
													"sink": {
														"name": "total_containers_scheduled",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_containers_serviced']"
													},
													"sink": {
														"name": "total_containers_serviced",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_containers_serviced_old']"
													},
													"sink": {
														"name": "total_containers_serviced_old",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_cubic_meters']"
													},
													"sink": {
														"name": "total_cubic_meters",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_disposal_rebate_costs']"
													},
													"sink": {
														"name": "total_disposal_rebate_costs",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_down_time']"
													},
													"sink": {
														"name": "total_down_time",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_engine_hours']"
													},
													"sink": {
														"name": "total_engine_hours",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_fuel_cost']"
													},
													"sink": {
														"name": "total_fuel_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_fuel_used']"
													},
													"sink": {
														"name": "total_fuel_used",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_kilometers']"
													},
													"sink": {
														"name": "total_kilometers",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_kilometers_gps']"
													},
													"sink": {
														"name": "total_kilometers_gps",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_metric_tons']"
													},
													"sink": {
														"name": "total_metric_tons",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_no_of_main_jobs']"
													},
													"sink": {
														"name": "total_no_of_main_jobs",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_no_of_messages']"
													},
													"sink": {
														"name": "total_no_of_messages",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_no_of_sections']"
													},
													"sink": {
														"name": "total_no_of_sections",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_normal_labour_cost']"
													},
													"sink": {
														"name": "total_normal_labour_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_oil_cost']"
													},
													"sink": {
														"name": "total_oil_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_oil_used']"
													},
													"sink": {
														"name": "total_oil_used",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_overtime_labour_cost']"
													},
													"sink": {
														"name": "total_overtime_labour_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_overtime_labour_cost2']"
													},
													"sink": {
														"name": "total_overtime_labour_cost2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_rcti_costs']"
													},
													"sink": {
														"name": "total_rcti_costs",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_revenue']"
													},
													"sink": {
														"name": "total_revenue",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_run_mileage']"
													},
													"sink": {
														"name": "total_run_mileage",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_run_time']"
													},
													"sink": {
														"name": "total_run_time",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_stops_completed']"
													},
													"sink": {
														"name": "total_stops_completed",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_stops_scheduled']"
													},
													"sink": {
														"name": "total_stops_scheduled",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_subcontr_cost']"
													},
													"sink": {
														"name": "total_subcontr_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_tip_time']"
													},
													"sink": {
														"name": "total_tip_time",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_tip_wait_time']"
													},
													"sink": {
														"name": "total_tip_wait_time",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_tipping_charges']"
													},
													"sink": {
														"name": "total_tipping_charges",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_tipping_costs']"
													},
													"sink": {
														"name": "total_tipping_costs",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_veh_cost_hour']"
													},
													"sink": {
														"name": "total_veh_cost_hour",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_veh_cost_klm']"
													},
													"sink": {
														"name": "total_veh_cost_klm",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_veh_cost_klm_gps']"
													},
													"sink": {
														"name": "total_veh_cost_klm_gps",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['truck_no']"
													},
													"sink": {
														"name": "truck_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UnSent']"
													},
													"sink": {
														"name": "UnSent",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['unused_time']"
													},
													"sink": {
														"name": "unused_time",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['veh_cost_per_hr']"
													},
													"sink": {
														"name": "veh_cost_per_hr",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['veh_cost_per_klm']"
													},
													"sink": {
														"name": "veh_cost_per_klm",
														"type": "Decimal"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "routesummary",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "route_summary",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('route_summary_',item())",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "scheduled Service to Data Lake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "For Each Entity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "WSGNSW_Date",
								"type": "DatasetReference",
								"parameters": {
									"API_Instance": {
										"value": "customer/scheduled_service",
										"type": "Expression"
									},
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "scheduledservice",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "scheduled_service",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgnsw",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Route Tip Fee to Data Lake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "scheduled Service to Data Lake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "WSGNSW_Date",
								"type": "DatasetReference",
								"parameters": {
									"API_Instance": {
										"value": "vehicle/route_tip_fee",
										"type": "Expression"
									},
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "routetipfee",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "route_tip_fee",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgnsw",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Tip Fee to Data Lake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Route Tip Fee to Data Lake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "WSGNSW_Date",
								"type": "DatasetReference",
								"parameters": {
									"API_Instance": {
										"value": "vehicle/tip_fee",
										"type": "Expression"
									},
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "tipfee",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "tip_fee",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgnsw",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Tip Fee to Data Lake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "WSGNSW_Date",
								"type": "DatasetReference",
								"parameters": {
									"API_Instance": {
										"value": "vehicle/route_summary",
										"type": "Expression"
									},
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "routesummary",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "route_summary",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgnsw",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"Entity": {
						"type": "Array",
						"defaultValue": [
							"customer/customer",
							"booking/booking",
							"customer/service"
						]
					},
					"Instance": {
						"type": "Array",
						"defaultValue": [
							"wsgnsw"
						]
					},
					"StartDate": {
						"type": "String"
					},
					"EndDate": {
						"type": "String"
					},
					"Debug": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:59Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/WSGNSW_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_WSG_DateQuery_wsgvic')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "For Each Entity",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('Entity')",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Copy WSG VIC to Data Lake",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set StartDate",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Set End Date",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Set Debug",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true",
												"EndCondition:$.has_more": "Const:false",
												"QueryParameters.$start": "$.next_result"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "RestAPI_Date",
											"type": "DatasetReference",
											"parameters": {
												"pStartDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"pEndDate": {
													"value": "@pipeline().parameters.pEndDate",
													"type": "Expression"
												},
												"API_Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"Instance": {
													"value": "wsgvic",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Set StartDate",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "StartDate",
										"value": {
											"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set End Date",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "EndDate",
										"value": {
											"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'yyyy-MM-dd')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set Debug",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "Debug",
										"value": {
											"value": "@concat(item(),'$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "For Each Instance",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Tip Fee to Data Lake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('Instance')",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Booking to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Route to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['add_chg_changed']"
													},
													"sink": {
														"name": "add_chg_changed",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['admin_status']"
													},
													"sink": {
														"name": "admin_status",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_1']"
													},
													"sink": {
														"name": "alt_ref_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_2']"
													},
													"sink": {
														"name": "alt_ref_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_serv_1']"
													},
													"sink": {
														"name": "alt_ref_serv_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_serv_2']"
													},
													"sink": {
														"name": "alt_ref_serv_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['application_id']"
													},
													"sink": {
														"name": "application_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_address_1']"
													},
													"sink": {
														"name": "bill_address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_address_2']"
													},
													"sink": {
														"name": "bill_address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_city']"
													},
													"sink": {
														"name": "bill_city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_name']"
													},
													"sink": {
														"name": "bill_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_property_name']"
													},
													"sink": {
														"name": "bill_property_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_state']"
													},
													"sink": {
														"name": "bill_state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_to_swt']"
													},
													"sink": {
														"name": "bill_to_swt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_zip']"
													},
													"sink": {
														"name": "bill_zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bin_attributes']"
													},
													"sink": {
														"name": "bin_attributes",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bins_collected']"
													},
													"sink": {
														"name": "bins_collected",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['booking_custom_price']"
													},
													"sink": {
														"name": "booking_custom_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['booking_id']"
													},
													"sink": {
														"name": "booking_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['booking_update_flag']"
													},
													"sink": {
														"name": "booking_update_flag",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['chargeable']"
													},
													"sink": {
														"name": "chargeable",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['cont_id']"
													},
													"sink": {
														"name": "cont_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_id']"
													},
													"sink": {
														"name": "container_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_size']"
													},
													"sink": {
														"name": "container_size",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['container_type']"
													},
													"sink": {
														"name": "container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_weight']"
													},
													"sink": {
														"name": "container_weight",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['containers']"
													},
													"sink": {
														"name": "containers",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['coord_date']"
													},
													"sink": {
														"name": "coord_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['coord_time']"
													},
													"sink": {
														"name": "coord_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_type']"
													},
													"sink": {
														"name": "coord_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['currency_code']"
													},
													"sink": {
														"name": "currency_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_cust_ref']"
													},
													"sink": {
														"name": "cust_cust_ref",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer_class']"
													},
													"sink": {
														"name": "customer_class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer_service_line_no']"
													},
													"sink": {
														"name": "customer_service_line_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['default_weight']"
													},
													"sink": {
														"name": "default_weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['delivery_serial_no']"
													},
													"sink": {
														"name": "delivery_serial_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['delivery_site_number']"
													},
													"sink": {
														"name": "delivery_site_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['delivery_site_type']"
													},
													"sink": {
														"name": "delivery_site_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Department']"
													},
													"sink": {
														"name": "Department",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['destruction_batch_no']"
													},
													"sink": {
														"name": "destruction_batch_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['destruction_certificate_required']"
													},
													"sink": {
														"name": "destruction_certificate_required",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type']"
													},
													"sink": {
														"name": "disposal_charge_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_incl_charge']"
													},
													"sink": {
														"name": "disposal_incl_charge",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_ticket']"
													},
													"sink": {
														"name": "disposal_ticket",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['driver_comments']"
													},
													"sink": {
														"name": "driver_comments",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_docket_no']"
													},
													"sink": {
														"name": "driver_docket_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['driver_seq_no']"
													},
													"sink": {
														"name": "driver_seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['eba_codes']"
													},
													"sink": {
														"name": "eba_codes",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['email_address']"
													},
													"sink": {
														"name": "email_address",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Exported']"
													},
													"sink": {
														"name": "Exported",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['fax_no']"
													},
													"sink": {
														"name": "fax_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['GetLastestPrice']"
													},
													"sink": {
														"name": "GetLastestPrice",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['HasAttachment']"
													},
													"sink": {
														"name": "HasAttachment",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['invoice_no']"
													},
													"sink": {
														"name": "invoice_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['InvoiceDescription']"
													},
													"sink": {
														"name": "InvoiceDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['job_end_time']"
													},
													"sink": {
														"name": "job_end_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['job_hours']"
													},
													"sink": {
														"name": "job_hours",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['job_serviced_date']"
													},
													"sink": {
														"name": "job_serviced_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['job_start_time']"
													},
													"sink": {
														"name": "job_start_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['jrl_no']"
													},
													"sink": {
														"name": "jrl_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['linked_trans_no']"
													},
													"sink": {
														"name": "linked_trans_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['linked_trans_seq_no']"
													},
													"sink": {
														"name": "linked_trans_seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['map_reference']"
													},
													"sink": {
														"name": "map_reference",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['mdt_cash_payment']"
													},
													"sink": {
														"name": "mdt_cash_payment",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['meters_collected']"
													},
													"sink": {
														"name": "meters_collected",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['multi_total_price']"
													},
													"sink": {
														"name": "multi_total_price",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['multi_total_price_ex_tax']"
													},
													"sink": {
														"name": "multi_total_price_ex_tax",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['multi_total_tax']"
													},
													"sink": {
														"name": "multi_total_tax",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['OldServType']"
													},
													"sink": {
														"name": "OldServType",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['open_flag']"
													},
													"sink": {
														"name": "open_flag",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['order_no']"
													},
													"sink": {
														"name": "order_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['p_year']"
													},
													"sink": {
														"name": "p_year",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['paid']"
													},
													"sink": {
														"name": "paid",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['period']"
													},
													"sink": {
														"name": "period",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['phone_2']"
													},
													"sink": {
														"name": "phone_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PlannedEndTime']"
													},
													"sink": {
														"name": "PlannedEndTime",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['PlannedStartTime']"
													},
													"sink": {
														"name": "PlannedStartTime",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['po_no']"
													},
													"sink": {
														"name": "po_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['prev_trans_status']"
													},
													"sink": {
														"name": "prev_trans_status",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['price_line_no']"
													},
													"sink": {
														"name": "price_line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['price_rate']"
													},
													"sink": {
														"name": "price_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Priority']"
													},
													"sink": {
														"name": "Priority",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ProfitCentre']"
													},
													"sink": {
														"name": "ProfitCentre",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['prorated_tip_cost']"
													},
													"sink": {
														"name": "prorated_tip_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['rcti_batch']"
													},
													"sink": {
														"name": "rcti_batch",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rcti_no']"
													},
													"sink": {
														"name": "rcti_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['reason_code']"
													},
													"sink": {
														"name": "reason_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['removal_serial_no']"
													},
													"sink": {
														"name": "removal_serial_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['removal_site_number']"
													},
													"sink": {
														"name": "removal_site_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['removal_site_type']"
													},
													"sink": {
														"name": "removal_site_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_1']"
													},
													"sink": {
														"name": "route_directions_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_2']"
													},
													"sink": {
														"name": "route_directions_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_3']"
													},
													"sink": {
														"name": "route_directions_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_4']"
													},
													"sink": {
														"name": "route_directions_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['run_gen_batch']"
													},
													"sink": {
														"name": "run_gen_batch",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SendTipFeeAttachments']"
													},
													"sink": {
														"name": "SendTipFeeAttachments",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['sent_flag']"
													},
													"sink": {
														"name": "sent_flag",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_addr_1']"
													},
													"sink": {
														"name": "serv_addr_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_addr_2']"
													},
													"sink": {
														"name": "serv_addr_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_city']"
													},
													"sink": {
														"name": "serv_city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_contact']"
													},
													"sink": {
														"name": "serv_contact",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_country']"
													},
													"sink": {
														"name": "serv_country",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc_1']"
													},
													"sink": {
														"name": "serv_desc_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc_2']"
													},
													"sink": {
														"name": "serv_desc_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc_3']"
													},
													"sink": {
														"name": "serv_desc_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc_4']"
													},
													"sink": {
														"name": "serv_desc_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_name']"
													},
													"sink": {
														"name": "serv_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_no']"
													},
													"sink": {
														"name": "serv_no",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['serv_phone']"
													},
													"sink": {
														"name": "serv_phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_property_name']"
													},
													"sink": {
														"name": "serv_property_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_state']"
													},
													"sink": {
														"name": "serv_state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_time_code']"
													},
													"sink": {
														"name": "serv_time_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_type']"
													},
													"sink": {
														"name": "serv_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_zip']"
													},
													"sink": {
														"name": "serv_zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['service_line_no']"
													},
													"sink": {
														"name": "service_line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['site_number']"
													},
													"sink": {
														"name": "site_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['status']"
													},
													"sink": {
														"name": "status",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['temp_code']"
													},
													"sink": {
														"name": "temp_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TempLedgerAccount']"
													},
													"sink": {
														"name": "TempLedgerAccount",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_required']"
													},
													"sink": {
														"name": "ticket_required",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['tip_fee']"
													},
													"sink": {
														"name": "tip_fee",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_price']"
													},
													"sink": {
														"name": "total_price",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_price_ex_tax']"
													},
													"sink": {
														"name": "total_price_ex_tax",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trans_date']"
													},
													"sink": {
														"name": "trans_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['trans_entry_date']"
													},
													"sink": {
														"name": "trans_entry_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['trans_entry_id']"
													},
													"sink": {
														"name": "trans_entry_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trans_entry_time']"
													},
													"sink": {
														"name": "trans_entry_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trans_no']"
													},
													"sink": {
														"name": "trans_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['trans_seq_no']"
													},
													"sink": {
														"name": "trans_seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['trans_update_date']"
													},
													"sink": {
														"name": "trans_update_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['trans_update_id']"
													},
													"sink": {
														"name": "trans_update_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trans_update_time']"
													},
													"sink": {
														"name": "trans_update_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['truck_no']"
													},
													"sink": {
														"name": "truck_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['updated']"
													},
													"sink": {
														"name": "updated",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['usePriceCode']"
													},
													"sink": {
														"name": "usePriceCode",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['user_id']"
													},
													"sink": {
														"name": "user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['vehicle_class']"
													},
													"sink": {
														"name": "vehicle_class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WasteOutcome']"
													},
													"sink": {
														"name": "WasteOutcome",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_equip_codes']"
													},
													"sink": {
														"name": "we_equip_codes",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_helpers']"
													},
													"sink": {
														"name": "we_helpers",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_price']"
													},
													"sink": {
														"name": "we_price",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['we_price_code']"
													},
													"sink": {
														"name": "we_price_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_price_discount_label']"
													},
													"sink": {
														"name": "we_price_discount_label",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_tax']"
													},
													"sink": {
														"name": "we_tax",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['zone_no']"
													},
													"sink": {
														"name": "zone_no",
														"type": "Int32"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "booking",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "booking",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('booking_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Customer to DB",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"modifiedDatetimeStart": "2022-12-21T00:00:00.335Z",
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"dataIntegrationUnits": 2,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['accounting_acc_no']"
													},
													"sink": {
														"name": "accounting_acc_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['accounting_bal_due_days']"
													},
													"sink": {
														"name": "accounting_bal_due_days",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['accounting_cust_id']"
													},
													"sink": {
														"name": "accounting_cust_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['accounting_vendor_id']"
													},
													"sink": {
														"name": "accounting_vendor_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_1']"
													},
													"sink": {
														"name": "address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_2']"
													},
													"sink": {
														"name": "address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alternate_id']"
													},
													"sink": {
														"name": "alternate_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['anzsic_code']"
													},
													"sink": {
														"name": "anzsic_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['approval_contact']"
													},
													"sink": {
														"name": "approval_contact",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['approval_email']"
													},
													"sink": {
														"name": "approval_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['approval_phone']"
													},
													"sink": {
														"name": "approval_phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['apt_no']"
													},
													"sink": {
														"name": "apt_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AttachmentCategories']"
													},
													"sink": {
														"name": "AttachmentCategories",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['AutoStopCreditOff']"
													},
													"sink": {
														"name": "AutoStopCreditOff",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['AutoStopCreditOn']"
													},
													"sink": {
														"name": "AutoStopCreditOn",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['bank_acct_no']"
													},
													"sink": {
														"name": "bank_acct_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bank_name']"
													},
													"sink": {
														"name": "bank_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_cycle']"
													},
													"sink": {
														"name": "bill_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_to_swt']"
													},
													"sink": {
														"name": "bill_to_swt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['book_alt_ref1']"
													},
													"sink": {
														"name": "book_alt_ref1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['book_alt_ref2']"
													},
													"sink": {
														"name": "book_alt_ref2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['BusinessType']"
													},
													"sink": {
														"name": "BusinessType",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cash_account']"
													},
													"sink": {
														"name": "cash_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cash_cardname']"
													},
													"sink": {
														"name": "cash_cardname",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cash_expiry']"
													},
													"sink": {
														"name": "cash_expiry",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cash_method']"
													},
													"sink": {
														"name": "cash_method",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['city']"
													},
													"sink": {
														"name": "city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_1']"
													},
													"sink": {
														"name": "classification_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_2']"
													},
													"sink": {
														"name": "classification_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_3']"
													},
													"sink": {
														"name": "classification_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_4']"
													},
													"sink": {
														"name": "classification_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_5']"
													},
													"sink": {
														"name": "classification_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_6']"
													},
													"sink": {
														"name": "classification_6",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_7']"
													},
													"sink": {
														"name": "classification_7",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_8']"
													},
													"sink": {
														"name": "classification_8",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_9']"
													},
													"sink": {
														"name": "classification_9",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification_10']"
													},
													"sink": {
														"name": "classification_10",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contribution_entitlement']"
													},
													"sink": {
														"name": "contribution_entitlement",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['contribution_entitlement_total']"
													},
													"sink": {
														"name": "contribution_entitlement_total",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['coord_date']"
													},
													"sink": {
														"name": "coord_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['coord_time']"
													},
													"sink": {
														"name": "coord_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_type']"
													},
													"sink": {
														"name": "coord_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['country_code']"
													},
													"sink": {
														"name": "country_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['county']"
													},
													"sink": {
														"name": "county",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_date']"
													},
													"sink": {
														"name": "create_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['credit_contact']"
													},
													"sink": {
														"name": "credit_contact",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['credit_email']"
													},
													"sink": {
														"name": "credit_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['credit_limit']"
													},
													"sink": {
														"name": "credit_limit",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['credit_limit_warn_amt']"
													},
													"sink": {
														"name": "credit_limit_warn_amt",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['credit_phone']"
													},
													"sink": {
														"name": "credit_phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CTSName']"
													},
													"sink": {
														"name": "CTSName",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CTSNumber']"
													},
													"sink": {
														"name": "CTSNumber",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['currency_code']"
													},
													"sink": {
														"name": "currency_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_1']"
													},
													"sink": {
														"name": "cust_class_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_2']"
													},
													"sink": {
														"name": "cust_class_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_3']"
													},
													"sink": {
														"name": "cust_class_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_4']"
													},
													"sink": {
														"name": "cust_class_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_class_5']"
													},
													"sink": {
														"name": "cust_class_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_group']"
													},
													"sink": {
														"name": "cust_group",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cust_number']"
													},
													"sink": {
														"name": "cust_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['cust_seq_no']"
													},
													"sink": {
														"name": "cust_seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['cust_type']"
													},
													"sink": {
														"name": "cust_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer_class']"
													},
													"sink": {
														"name": "customer_class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cut_off_swt']"
													},
													"sink": {
														"name": "cut_off_swt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_closed_1']"
													},
													"sink": {
														"name": "day_closed_1",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_2']"
													},
													"sink": {
														"name": "day_closed_2",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_3']"
													},
													"sink": {
														"name": "day_closed_3",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_4']"
													},
													"sink": {
														"name": "day_closed_4",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_5']"
													},
													"sink": {
														"name": "day_closed_5",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_6']"
													},
													"sink": {
														"name": "day_closed_6",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_closed_7']"
													},
													"sink": {
														"name": "day_closed_7",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_1']"
													},
													"sink": {
														"name": "day_not_after_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_2']"
													},
													"sink": {
														"name": "day_not_after_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_3']"
													},
													"sink": {
														"name": "day_not_after_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_4']"
													},
													"sink": {
														"name": "day_not_after_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_5']"
													},
													"sink": {
														"name": "day_not_after_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_6']"
													},
													"sink": {
														"name": "day_not_after_6",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_after_7']"
													},
													"sink": {
														"name": "day_not_after_7",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_1']"
													},
													"sink": {
														"name": "day_not_before_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_2']"
													},
													"sink": {
														"name": "day_not_before_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_3']"
													},
													"sink": {
														"name": "day_not_before_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_4']"
													},
													"sink": {
														"name": "day_not_before_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_5']"
													},
													"sink": {
														"name": "day_not_before_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_6']"
													},
													"sink": {
														"name": "day_not_before_6",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['day_not_before_7']"
													},
													"sink": {
														"name": "day_not_before_7",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['default_tax_perc']"
													},
													"sink": {
														"name": "default_tax_perc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_site']"
													},
													"sink": {
														"name": "disposal_site",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['docket_req']"
													},
													"sink": {
														"name": "docket_req",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['drawer']"
													},
													"sink": {
														"name": "drawer",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['email_address']"
													},
													"sink": {
														"name": "email_address",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['fax_no']"
													},
													"sink": {
														"name": "fax_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['FilteredWithAttributes']"
													},
													"sink": {
														"name": "FilteredWithAttributes",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['first_dd_date']"
													},
													"sink": {
														"name": "first_dd_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['government_no']"
													},
													"sink": {
														"name": "government_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['historical_date']"
													},
													"sink": {
														"name": "historical_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['house_no']"
													},
													"sink": {
														"name": "house_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['house_no_text']"
													},
													"sink": {
														"name": "house_no_text",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['in_collection_area']"
													},
													"sink": {
														"name": "in_collection_area",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['internal_account']"
													},
													"sink": {
														"name": "internal_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['invoice_email']"
													},
													"sink": {
														"name": "invoice_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['invoice_send_method']"
													},
													"sink": {
														"name": "invoice_send_method",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['invoice_send_method_we']"
													},
													"sink": {
														"name": "invoice_send_method_we",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['InvoiceStyle']"
													},
													"sink": {
														"name": "InvoiceStyle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['is_rcti']"
													},
													"sink": {
														"name": "is_rcti",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['LastPaymentDate']"
													},
													"sink": {
														"name": "LastPaymentDate",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['lot_no']"
													},
													"sink": {
														"name": "lot_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['map_reference']"
													},
													"sink": {
														"name": "map_reference",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['module']"
													},
													"sink": {
														"name": "module",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MultiSiteOneEmail']"
													},
													"sink": {
														"name": "MultiSiteOneEmail",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['name']"
													},
													"sink": {
														"name": "name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['NoService']"
													},
													"sink": {
														"name": "NoService",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['par_billto_cust_number']"
													},
													"sink": {
														"name": "par_billto_cust_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['parcel_key']"
													},
													"sink": {
														"name": "parcel_key",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['phone']"
													},
													"sink": {
														"name": "phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Phone2']"
													},
													"sink": {
														"name": "Phone2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['po_no']"
													},
													"sink": {
														"name": "po_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['POChain']"
													},
													"sink": {
														"name": "POChain",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['possession_date']"
													},
													"sink": {
														"name": "possession_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['postal_address_1']"
													},
													"sink": {
														"name": "postal_address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_address_2']"
													},
													"sink": {
														"name": "postal_address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_city']"
													},
													"sink": {
														"name": "postal_city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_country_code']"
													},
													"sink": {
														"name": "postal_country_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_county']"
													},
													"sink": {
														"name": "postal_county",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_name']"
													},
													"sink": {
														"name": "postal_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_property_name']"
													},
													"sink": {
														"name": "postal_property_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_state']"
													},
													"sink": {
														"name": "postal_state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['postal_zip']"
													},
													"sink": {
														"name": "postal_zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['property_name']"
													},
													"sink": {
														"name": "property_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['protected_from']"
													},
													"sink": {
														"name": "protected_from",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['protected_to']"
													},
													"sink": {
														"name": "protected_to",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['rate_account_number']"
													},
													"sink": {
														"name": "rate_account_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rcti_email']"
													},
													"sink": {
														"name": "rcti_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['registration_date']"
													},
													"sink": {
														"name": "registration_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['renter_owner_swt']"
													},
													"sink": {
														"name": "renter_owner_swt",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rp_master']"
													},
													"sink": {
														"name": "rp_master",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['rp_number']"
													},
													"sink": {
														"name": "rp_number",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['sales_id']"
													},
													"sink": {
														"name": "sales_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['sales_territory']"
													},
													"sink": {
														"name": "sales_territory",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SecondaryZones']"
													},
													"sink": {
														"name": "SecondaryZones",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SendDocketsWithInvoice']"
													},
													"sink": {
														"name": "SendDocketsWithInvoice",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['serv_contact']"
													},
													"sink": {
														"name": "serv_contact",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SignatureMandatoryOnMDT']"
													},
													"sink": {
														"name": "SignatureMandatoryOnMDT",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['stat']"
													},
													"sink": {
														"name": "stat",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['state']"
													},
													"sink": {
														"name": "state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['statement_email']"
													},
													"sink": {
														"name": "statement_email",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['street_code']"
													},
													"sink": {
														"name": "street_code",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['street_section']"
													},
													"sink": {
														"name": "street_section",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['temp_susp_ed']"
													},
													"sink": {
														"name": "temp_susp_ed",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['temp_susp_sd']"
													},
													"sink": {
														"name": "temp_susp_sd",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['terms_code']"
													},
													"sink": {
														"name": "terms_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['town_code']"
													},
													"sink": {
														"name": "town_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['trade_name']"
													},
													"sink": {
														"name": "trade_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UsePOChain']"
													},
													"sink": {
														"name": "UsePOChain",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['waste_precinct']"
													},
													"sink": {
														"name": "waste_precinct",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zip']"
													},
													"sink": {
														"name": "zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zone_code']"
													},
													"sink": {
														"name": "zone_code",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "customer",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "customer",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('Customer_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Route to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Customer to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['area_type']"
													},
													"sink": {
														"name": "area_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['display_order']"
													},
													"sink": {
														"name": "display_order",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['driver_list']"
													},
													"sink": {
														"name": "driver_list",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['equipment_set']"
													},
													"sink": {
														"name": "equipment_set",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Friday']"
													},
													"sink": {
														"name": "Friday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['G_Cal_ID']"
													},
													"sink": {
														"name": "G_Cal_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['G_Event_ID']"
													},
													"sink": {
														"name": "G_Event_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['InvoiceCustomer']"
													},
													"sink": {
														"name": "InvoiceCustomer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['InvoiceService']"
													},
													"sink": {
														"name": "InvoiceService",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['labour_rate_per_hour']"
													},
													"sink": {
														"name": "labour_rate_per_hour",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['mdt_enabled']"
													},
													"sink": {
														"name": "mdt_enabled",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Monday']"
													},
													"sink": {
														"name": "Monday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['next_service_date']"
													},
													"sink": {
														"name": "next_service_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['num_employees']"
													},
													"sink": {
														"name": "num_employees",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ReSequenceType']"
													},
													"sink": {
														"name": "ReSequenceType",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_brws_desc']"
													},
													"sink": {
														"name": "route_brws_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_cycle']"
													},
													"sink": {
														"name": "route_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_description']"
													},
													"sink": {
														"name": "route_description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_inv_desc']"
													},
													"sink": {
														"name": "route_inv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_MDT_desc']"
													},
													"sink": {
														"name": "route_MDT_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_type']"
													},
													"sink": {
														"name": "route_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Saturday']"
													},
													"sink": {
														"name": "Saturday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Sunday']"
													},
													"sink": {
														"name": "Sunday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['supervisor_no']"
													},
													"sink": {
														"name": "supervisor_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['team_no']"
													},
													"sink": {
														"name": "team_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Thursday']"
													},
													"sink": {
														"name": "Thursday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['truck_no']"
													},
													"sink": {
														"name": "truck_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Tuesday']"
													},
													"sink": {
														"name": "Tuesday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Wednesday']"
													},
													"sink": {
														"name": "Wednesday",
														"type": "Boolean"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "route",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "route",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('route_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Service to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Booking to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_serv_1']"
													},
													"sink": {
														"name": "alt_ref_serv_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_ref_serv_2']"
													},
													"sink": {
														"name": "alt_ref_serv_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['application_id']"
													},
													"sink": {
														"name": "application_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ApplyMinimumBookingPriceTo']"
													},
													"sink": {
														"name": "ApplyMinimumBookingPriceTo",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bill_cycle']"
													},
													"sink": {
														"name": "bill_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BillingQtySwitch']"
													},
													"sink": {
														"name": "BillingQtySwitch",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['budget_lifts']"
													},
													"sink": {
														"name": "budget_lifts",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['cancel_serv_date']"
													},
													"sink": {
														"name": "cancel_serv_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['chargeable']"
													},
													"sink": {
														"name": "chargeable",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['container_type']"
													},
													"sink": {
														"name": "container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['containers']"
													},
													"sink": {
														"name": "containers",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['contract_desc_1']"
													},
													"sink": {
														"name": "contract_desc_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_desc_2']"
													},
													"sink": {
														"name": "contract_desc_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_desc_3']"
													},
													"sink": {
														"name": "contract_desc_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_desc_4']"
													},
													"sink": {
														"name": "contract_desc_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_end_date']"
													},
													"sink": {
														"name": "contract_end_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['contract_no']"
													},
													"sink": {
														"name": "contract_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contract_str_date']"
													},
													"sink": {
														"name": "contract_str_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['contractor_no']"
													},
													"sink": {
														"name": "contractor_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['currency_code']"
													},
													"sink": {
														"name": "currency_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['destruction_certificate_required']"
													},
													"sink": {
														"name": "destruction_certificate_required",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc']"
													},
													"sink": {
														"name": "disposal_charge_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc2']"
													},
													"sink": {
														"name": "disposal_charge_desc2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc3']"
													},
													"sink": {
														"name": "disposal_charge_desc3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc_ex']"
													},
													"sink": {
														"name": "disposal_charge_desc_ex",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate']"
													},
													"sink": {
														"name": "disposal_charge_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate2']"
													},
													"sink": {
														"name": "disposal_charge_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate3']"
													},
													"sink": {
														"name": "disposal_charge_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex2']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex3']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type']"
													},
													"sink": {
														"name": "disposal_charge_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type2']"
													},
													"sink": {
														"name": "disposal_charge_type2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type3']"
													},
													"sink": {
														"name": "disposal_charge_type3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex']"
													},
													"sink": {
														"name": "disposal_charge_type_ex",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex2']"
													},
													"sink": {
														"name": "disposal_charge_type_ex2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex3']"
													},
													"sink": {
														"name": "disposal_charge_type_ex3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_default_weight']"
													},
													"sink": {
														"name": "disposal_default_weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_default_weight_max']"
													},
													"sink": {
														"name": "disposal_default_weight_max",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_default_weight_min']"
													},
													"sink": {
														"name": "disposal_default_weight_min",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_incl_charge']"
													},
													"sink": {
														"name": "disposal_incl_charge",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Disposal_Levy1Desc']"
													},
													"sink": {
														"name": "Disposal_Levy1Desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Disposal_Levy1Rate']"
													},
													"sink": {
														"name": "Disposal_Levy1Rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Disposal_Levy1Type']"
													},
													"sink": {
														"name": "Disposal_Levy1Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_site']"
													},
													"sink": {
														"name": "disposal_site",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_unit_meas']"
													},
													"sink": {
														"name": "disposal_unit_meas",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex",
														"type": "Double"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex2']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex3']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Disposal_weight_min']"
													},
													"sink": {
														"name": "Disposal_weight_min",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['facility_code']"
													},
													"sink": {
														"name": "facility_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['facility_number']"
													},
													"sink": {
														"name": "facility_number",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['float_next_date']"
													},
													"sink": {
														"name": "float_next_date",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['frequency']"
													},
													"sink": {
														"name": "frequency",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['indemnification_on_file']"
													},
													"sink": {
														"name": "indemnification_on_file",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['initial_serv_date']"
													},
													"sink": {
														"name": "initial_serv_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['InvoiceDescription']"
													},
													"sink": {
														"name": "InvoiceDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['last_bill_date']"
													},
													"sink": {
														"name": "last_bill_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['line_no']"
													},
													"sink": {
														"name": "line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['line_notes_1']"
													},
													"sink": {
														"name": "line_notes_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_notes_2']"
													},
													"sink": {
														"name": "line_notes_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_notes_3']"
													},
													"sink": {
														"name": "line_notes_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_notes_4']"
													},
													"sink": {
														"name": "line_notes_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['next_bill_date']"
													},
													"sink": {
														"name": "next_bill_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['next_care_cert_due']"
													},
													"sink": {
														"name": "next_care_cert_due",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['owned_flag']"
													},
													"sink": {
														"name": "owned_flag",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['ParentService']"
													},
													"sink": {
														"name": "ParentService",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['pickup_days']"
													},
													"sink": {
														"name": "pickup_days",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['po_no']"
													},
													"sink": {
														"name": "po_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['POChain']"
													},
													"sink": {
														"name": "POChain",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['pref_serv_time']"
													},
													"sink": {
														"name": "pref_serv_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['price_increase_exempt_date']"
													},
													"sink": {
														"name": "price_increase_exempt_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['rate_exempt']"
													},
													"sink": {
														"name": "rate_exempt",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['rent_days']"
													},
													"sink": {
														"name": "rent_days",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['rent_free_days']"
													},
													"sink": {
														"name": "rent_free_days",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['repeating_loads']"
													},
													"sink": {
														"name": "repeating_loads",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['route']"
													},
													"sink": {
														"name": "route",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_collection']"
													},
													"sink": {
														"name": "route_collection",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['route_cycle']"
													},
													"sink": {
														"name": "route_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_1']"
													},
													"sink": {
														"name": "route_directions_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_2']"
													},
													"sink": {
														"name": "route_directions_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_3']"
													},
													"sink": {
														"name": "route_directions_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_directions_4']"
													},
													"sink": {
														"name": "route_directions_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['sales_id_1']"
													},
													"sink": {
														"name": "sales_id_1",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['sch_end_time']"
													},
													"sink": {
														"name": "sch_end_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['sch_start_time']"
													},
													"sink": {
														"name": "sch_start_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SendTipFeeAttachments']"
													},
													"sink": {
														"name": "SendTipFeeAttachments",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_type']"
													},
													"sink": {
														"name": "serv_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SharedService']"
													},
													"sink": {
														"name": "SharedService",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['site_location_ref_no']"
													},
													"sink": {
														"name": "site_location_ref_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['subcontractor_line_no']"
													},
													"sink": {
														"name": "subcontractor_line_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['temp_code']"
													},
													"sink": {
														"name": "temp_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_required']"
													},
													"sink": {
														"name": "ticket_required",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Time_at_site']"
													},
													"sink": {
														"name": "Time_at_site",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UseForAllSites']"
													},
													"sink": {
														"name": "UseForAllSites",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['UsePOChain']"
													},
													"sink": {
														"name": "UsePOChain",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['we_price_code']"
													},
													"sink": {
														"name": "we_price_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WeightLimitSwitch']"
													},
													"sink": {
														"name": "WeightLimitSwitch",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "service",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "service",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('service_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Scheduled Service to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Service to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"preCopyScript": "delete from scheduled_service_wsgvic",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['cont_number']"
													},
													"sink": {
														"name": "cont_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['display_order']"
													},
													"sink": {
														"name": "display_order",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['EndDate']"
													},
													"sink": {
														"name": "EndDate",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['ending_house']"
													},
													"sink": {
														"name": "ending_house",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['expected_metres']"
													},
													"sink": {
														"name": "expected_metres",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['first_service_date']"
													},
													"sink": {
														"name": "first_service_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['last_mdt_seq']"
													},
													"sink": {
														"name": "last_mdt_seq",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['line_no']"
													},
													"sink": {
														"name": "line_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['line_type']"
													},
													"sink": {
														"name": "line_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['navigation']"
													},
													"sink": {
														"name": "navigation",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['next_service_date']"
													},
													"sink": {
														"name": "next_service_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['route_line']"
													},
													"sink": {
														"name": "route_line",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['route_msg']"
													},
													"sink": {
														"name": "route_msg",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['schedule_no']"
													},
													"sink": {
														"name": "schedule_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['section']"
													},
													"sink": {
														"name": "section",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['segment_length']"
													},
													"sink": {
														"name": "segment_length",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['StartDate']"
													},
													"sink": {
														"name": "StartDate",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['street_code']"
													},
													"sink": {
														"name": "street_code",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "scheduledservice",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "scheduled_service",
													"type": "Expression"
												},
												"Instance": {
													"value": "wsgvic",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('scheduled_service_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Tip Fee to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Scheduled Service to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": true,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_qty']"
													},
													"sink": {
														"name": "alt_qty",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['alt_qty_unit']"
													},
													"sink": {
														"name": "alt_qty_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['booking']"
													},
													"sink": {
														"name": "booking",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['cont_id']"
													},
													"sink": {
														"name": "cont_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_date']"
													},
													"sink": {
														"name": "coord_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['coord_time']"
													},
													"sink": {
														"name": "coord_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_type']"
													},
													"sink": {
														"name": "coord_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['date_accrual']"
													},
													"sink": {
														"name": "date_accrual",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['date_approved']"
													},
													"sink": {
														"name": "date_approved",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['date_paid']"
													},
													"sink": {
														"name": "date_paid",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc']"
													},
													"sink": {
														"name": "disposal_charge_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc2']"
													},
													"sink": {
														"name": "disposal_charge_desc2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc3']"
													},
													"sink": {
														"name": "disposal_charge_desc3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate']"
													},
													"sink": {
														"name": "disposal_charge_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate2']"
													},
													"sink": {
														"name": "disposal_charge_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate3']"
													},
													"sink": {
														"name": "disposal_charge_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex2']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex3']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type']"
													},
													"sink": {
														"name": "disposal_charge_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type2']"
													},
													"sink": {
														"name": "disposal_charge_type2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type3']"
													},
													"sink": {
														"name": "disposal_charge_type3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex']"
													},
													"sink": {
														"name": "disposal_charge_type_ex",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex2']"
													},
													"sink": {
														"name": "disposal_charge_type_ex2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex3']"
													},
													"sink": {
														"name": "disposal_charge_type_ex3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate']"
													},
													"sink": {
														"name": "disposal_cost_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate2']"
													},
													"sink": {
														"name": "disposal_cost_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate3']"
													},
													"sink": {
														"name": "disposal_cost_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate_ex']"
													},
													"sink": {
														"name": "disposal_cost_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate_type']"
													},
													"sink": {
														"name": "disposal_cost_rate_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_date']"
													},
													"sink": {
														"name": "disposal_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['disposal_incl_charge']"
													},
													"sink": {
														"name": "disposal_incl_charge",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_site']"
													},
													"sink": {
														"name": "disposal_site",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex2']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex3']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['DisposalServiceFunction']"
													},
													"sink": {
														"name": "DisposalServiceFunction",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['docket_no']"
													},
													"sink": {
														"name": "docket_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ExternalWeight']"
													},
													"sink": {
														"name": "ExternalWeight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['invoice_number']"
													},
													"sink": {
														"name": "invoice_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Levy1Desc']"
													},
													"sink": {
														"name": "Levy1Desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Levy1Rate']"
													},
													"sink": {
														"name": "Levy1Rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Levy1Type']"
													},
													"sink": {
														"name": "Levy1Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['odometer']"
													},
													"sink": {
														"name": "odometer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['plate_no']"
													},
													"sink": {
														"name": "plate_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route']"
													},
													"sink": {
														"name": "route",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_date']"
													},
													"sink": {
														"name": "route_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['route_summary']"
													},
													"sink": {
														"name": "route_summary",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['seq_no']"
													},
													"sink": {
														"name": "seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['serial_no']"
													},
													"sink": {
														"name": "serial_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_number']"
													},
													"sink": {
														"name": "ticket_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_number_old']"
													},
													"sink": {
														"name": "ticket_number_old",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['tip_in_time']"
													},
													"sink": {
														"name": "tip_in_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_out_time']"
													},
													"sink": {
														"name": "tip_out_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_sub_loc_no']"
													},
													"sink": {
														"name": "tip_sub_loc_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_visit_time']"
													},
													"sink": {
														"name": "tip_visit_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_charge']"
													},
													"sink": {
														"name": "total_charge",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_cost']"
													},
													"sink": {
														"name": "total_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_cost_entered']"
													},
													"sink": {
														"name": "total_cost_entered",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['trans_no']"
													},
													"sink": {
														"name": "trans_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['trans_seq']"
													},
													"sink": {
														"name": "trans_seq",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['transmit_no']"
													},
													"sink": {
														"name": "transmit_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['truck']"
													},
													"sink": {
														"name": "truck",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['user_approved']"
													},
													"sink": {
														"name": "user_approved",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['volume']"
													},
													"sink": {
														"name": "volume",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['volume_unit']"
													},
													"sink": {
														"name": "volume_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['weight']"
													},
													"sink": {
														"name": "weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_max']"
													},
													"sink": {
														"name": "weight_max",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_min']"
													},
													"sink": {
														"name": "weight_min",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_orig']"
													},
													"sink": {
														"name": "weight_orig",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_unit']"
													},
													"sink": {
														"name": "weight_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WeightIn']"
													},
													"sink": {
														"name": "WeightIn",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['WeightOut']"
													},
													"sink": {
														"name": "WeightOut",
														"type": "Decimal"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "tipfee",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "tip_fee",
													"type": "Expression"
												},
												"Instance": {
													"value": "wsgvic",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('tip_fee_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Route Tip Fee to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Tip Fee to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['alt_qty']"
													},
													"sink": {
														"name": "alt_qty",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['alt_qty_unit']"
													},
													"sink": {
														"name": "alt_qty_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['cont_id']"
													},
													"sink": {
														"name": "cont_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_date']"
													},
													"sink": {
														"name": "coord_date",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_time']"
													},
													"sink": {
														"name": "coord_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['coord_type']"
													},
													"sink": {
														"name": "coord_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['customer']"
													},
													"sink": {
														"name": "customer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['date_accrual']"
													},
													"sink": {
														"name": "date_accrual",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['date_approved']"
													},
													"sink": {
														"name": "date_approved",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['date_paid']"
													},
													"sink": {
														"name": "date_paid",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc']"
													},
													"sink": {
														"name": "disposal_charge_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc2']"
													},
													"sink": {
														"name": "disposal_charge_desc2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_desc3']"
													},
													"sink": {
														"name": "disposal_charge_desc3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate']"
													},
													"sink": {
														"name": "disposal_charge_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate2']"
													},
													"sink": {
														"name": "disposal_charge_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate3']"
													},
													"sink": {
														"name": "disposal_charge_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex2']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_rate_ex3']"
													},
													"sink": {
														"name": "disposal_charge_rate_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type']"
													},
													"sink": {
														"name": "disposal_charge_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type2']"
													},
													"sink": {
														"name": "disposal_charge_type2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type3']"
													},
													"sink": {
														"name": "disposal_charge_type3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex']"
													},
													"sink": {
														"name": "disposal_charge_type_ex",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex2']"
													},
													"sink": {
														"name": "disposal_charge_type_ex2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_charge_type_ex3']"
													},
													"sink": {
														"name": "disposal_charge_type_ex3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate']"
													},
													"sink": {
														"name": "disposal_cost_rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate2']"
													},
													"sink": {
														"name": "disposal_cost_rate2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate3']"
													},
													"sink": {
														"name": "disposal_cost_rate3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate_ex']"
													},
													"sink": {
														"name": "disposal_cost_rate_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_cost_rate_type']"
													},
													"sink": {
														"name": "disposal_cost_rate_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disposal_date']"
													},
													"sink": {
														"name": "disposal_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['disposal_incl_charge']"
													},
													"sink": {
														"name": "disposal_incl_charge",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['disposal_site']"
													},
													"sink": {
														"name": "disposal_site",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex2']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['disposal_weight_limit_ex3']"
													},
													"sink": {
														"name": "disposal_weight_limit_ex3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['DisposalServiceFunction']"
													},
													"sink": {
														"name": "DisposalServiceFunction",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['docket_no']"
													},
													"sink": {
														"name": "docket_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ExternalWeight']"
													},
													"sink": {
														"name": "ExternalWeight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['invoice_number']"
													},
													"sink": {
														"name": "invoice_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Levy1Desc']"
													},
													"sink": {
														"name": "Levy1Desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Levy1Rate']"
													},
													"sink": {
														"name": "Levy1Rate",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Levy1Type']"
													},
													"sink": {
														"name": "Levy1Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['odometer']"
													},
													"sink": {
														"name": "odometer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['plate_no']"
													},
													"sink": {
														"name": "plate_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route']"
													},
													"sink": {
														"name": "route",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_date']"
													},
													"sink": {
														"name": "route_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['route_summary']"
													},
													"sink": {
														"name": "route_summary",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['seq_no']"
													},
													"sink": {
														"name": "seq_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['serial_no']"
													},
													"sink": {
														"name": "serial_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_number']"
													},
													"sink": {
														"name": "ticket_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ticket_number_old']"
													},
													"sink": {
														"name": "ticket_number_old",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['tip_in_time']"
													},
													"sink": {
														"name": "tip_in_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_out_time']"
													},
													"sink": {
														"name": "tip_out_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_sub_loc_no']"
													},
													"sink": {
														"name": "tip_sub_loc_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['tip_visit_time']"
													},
													"sink": {
														"name": "tip_visit_time",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['total_charge']"
													},
													"sink": {
														"name": "total_charge",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_cost']"
													},
													"sink": {
														"name": "total_cost",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['total_cost_entered']"
													},
													"sink": {
														"name": "total_cost_entered",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['trans_no']"
													},
													"sink": {
														"name": "trans_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['trans_seq']"
													},
													"sink": {
														"name": "trans_seq",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['transmit_no']"
													},
													"sink": {
														"name": "transmit_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['truck']"
													},
													"sink": {
														"name": "truck",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['user_approved']"
													},
													"sink": {
														"name": "user_approved",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['volume']"
													},
													"sink": {
														"name": "volume",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['volume_unit']"
													},
													"sink": {
														"name": "volume_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['weight']"
													},
													"sink": {
														"name": "weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_max']"
													},
													"sink": {
														"name": "weight_max",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_min']"
													},
													"sink": {
														"name": "weight_min",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_orig']"
													},
													"sink": {
														"name": "weight_orig",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['weight_unit']"
													},
													"sink": {
														"name": "weight_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WeightIn']"
													},
													"sink": {
														"name": "WeightIn",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['WeightOut']"
													},
													"sink": {
														"name": "WeightOut",
														"type": "Decimal"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@pipeline().parameters.pStartDate",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "routetipfee",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "route_tip_fee",
													"type": "Expression"
												},
												"Instance": {
													"value": "wsgvic",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('route_tip_fee_',item())",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "scheduled Service to Data Lake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "For Each Entity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI_Date",
								"type": "DatasetReference",
								"parameters": {
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "customer/scheduled_service",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "scheduledservice",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "scheduled_service",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Route Tip Fee to Data Lake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "scheduled Service to Data Lake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI_Date",
								"type": "DatasetReference",
								"parameters": {
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "vehicle/route_tip_fee",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "routetipfee",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "route_tip_fee",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Tip Fee to Data Lake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Route Tip Fee to Data Lake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI_Date",
								"type": "DatasetReference",
								"parameters": {
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "vehicle/tip_fee",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "tipfee",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "tip_fee",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"Entity": {
						"type": "Array",
						"defaultValue": [
							"customer/customer",
							"booking/booking",
							"vehicle/route",
							"customer/service"
						]
					},
					"Instance": {
						"type": "Array",
						"defaultValue": [
							"wsgvic"
						]
					},
					"StartDate": {
						"type": "String"
					},
					"EndDate": {
						"type": "String"
					},
					"Debug": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_WSG_query')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "For Each Entity",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('Entity')",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 3,
							"activities": [
								{
									"name": "Copy to DataLake WSG VIC",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true",
												"EndCondition:$.has_more": "Const:false",
												"QueryParameters.$start": "$.next_result"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "RestAPI",
											"type": "DatasetReference",
											"parameters": {
												"Dataset": {
													"value": "@split(item(),'.')[1]",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "@split(item(),'.')[0]",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"Instance": {
													"value": "wsgvic",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Copy to DataLake WASTEFLEX",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Copy to DataLake WSG VIC",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true",
												"EndCondition:$.has_more": "Const:false",
												"QueryParameters.$start": "$.next_result"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "WFLEX",
											"type": "DatasetReference",
											"parameters": {
												"Dataset": {
													"value": "@split(item(),'.')[1]",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "@split(item(),'.')[0]",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"Instance": {
													"value": "wflex",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Copy to DataLake WSGNSW",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Copy to DataLake WASTEFLEX",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true",
												"EndCondition:$.has_more": "Const:false",
												"QueryParameters.$start": "$.next_result"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "WSGNSW",
											"type": "DatasetReference",
											"parameters": {
												"Dataset": {
													"value": "@split(item(),'.')[1]",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "@split(item(),'.')[0]",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"Instance": {
													"value": "wsgnsw",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "For Each Instance",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "For Each Entity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('Instance')",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Vehicle to DB",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"truck_no"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['authoristation_no']"
													},
													"sink": {
														"name": "authoristation_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CallSign']"
													},
													"sink": {
														"name": "CallSign",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cert_waste_type']"
													},
													"sink": {
														"name": "cert_waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['class']"
													},
													"sink": {
														"name": "class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_type']"
													},
													"sink": {
														"name": "container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['current_hour_meter']"
													},
													"sink": {
														"name": "current_hour_meter",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['current_odometer']"
													},
													"sink": {
														"name": "current_odometer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['current_reading_date']"
													},
													"sink": {
														"name": "current_reading_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['cust_number']"
													},
													"sink": {
														"name": "cust_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['customer_truck']"
													},
													"sink": {
														"name": "customer_truck",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Disabled']"
													},
													"sink": {
														"name": "Disabled",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['last_pm_code']"
													},
													"sink": {
														"name": "last_pm_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['last_pm_date']"
													},
													"sink": {
														"name": "last_pm_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['last_pm_hour_meter']"
													},
													"sink": {
														"name": "last_pm_hour_meter",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['last_pm_odometer']"
													},
													"sink": {
														"name": "last_pm_odometer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['last_pm_order_no']"
													},
													"sink": {
														"name": "last_pm_order_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['last_waste_type']"
													},
													"sink": {
														"name": "last_waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account_RI']"
													},
													"sink": {
														"name": "ledger_account_RI",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MaximumWeight']"
													},
													"sink": {
														"name": "MaximumWeight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['MDTserial']"
													},
													"sink": {
														"name": "MDTserial",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['min_tonnage']"
													},
													"sink": {
														"name": "min_tonnage",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['plate_no']"
													},
													"sink": {
														"name": "plate_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['registered_gross_mass']"
													},
													"sink": {
														"name": "registered_gross_mass",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_average']"
													},
													"sink": {
														"name": "tare_average",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_date_1']"
													},
													"sink": {
														"name": "tare_date_1",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_2']"
													},
													"sink": {
														"name": "tare_date_2",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_3']"
													},
													"sink": {
														"name": "tare_date_3",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_4']"
													},
													"sink": {
														"name": "tare_date_4",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_5']"
													},
													"sink": {
														"name": "tare_date_5",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_6']"
													},
													"sink": {
														"name": "tare_date_6",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_7']"
													},
													"sink": {
														"name": "tare_date_7",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_8']"
													},
													"sink": {
														"name": "tare_date_8",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_9']"
													},
													"sink": {
														"name": "tare_date_9",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_10']"
													},
													"sink": {
														"name": "tare_date_10",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_expiry']"
													},
													"sink": {
														"name": "tare_expiry",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_1']"
													},
													"sink": {
														"name": "tare_wgt_1",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_2']"
													},
													"sink": {
														"name": "tare_wgt_2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_3']"
													},
													"sink": {
														"name": "tare_wgt_3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_4']"
													},
													"sink": {
														"name": "tare_wgt_4",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_5']"
													},
													"sink": {
														"name": "tare_wgt_5",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_6']"
													},
													"sink": {
														"name": "tare_wgt_6",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_7']"
													},
													"sink": {
														"name": "tare_wgt_7",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_8']"
													},
													"sink": {
														"name": "tare_wgt_8",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_9']"
													},
													"sink": {
														"name": "tare_wgt_9",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_10']"
													},
													"sink": {
														"name": "tare_wgt_10",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['truck_no']"
													},
													"sink": {
														"name": "truck_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['valid_from_date']"
													},
													"sink": {
														"name": "valid_from_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['valid_to_date']"
													},
													"sink": {
														"name": "valid_to_date",
														"type": "DateTime"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "vehicle",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "vehicle",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('vehicle_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Invoice Period to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Vehicle to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"org",
													"period_end_date"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['ar_balances_1']"
													},
													"sink": {
														"name": "ar_balances_1",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['ar_balances_2']"
													},
													"sink": {
														"name": "ar_balances_2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['ar_balances_3']"
													},
													"sink": {
														"name": "ar_balances_3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['ar_balances_4']"
													},
													"sink": {
														"name": "ar_balances_4",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['ar_balances_5']"
													},
													"sink": {
														"name": "ar_balances_5",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['current_period']"
													},
													"sink": {
														"name": "current_period",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['os_code']"
													},
													"sink": {
														"name": "os_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['period_end_date']"
													},
													"sink": {
														"name": "period_end_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['period_no']"
													},
													"sink": {
														"name": "period_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_revenue']"
													},
													"sink": {
														"name": "total_revenue",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['year_no']"
													},
													"sink": {
														"name": "year_no",
														"type": "Int32"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "invoiceperiod",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "invoice_period",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('invoice_period_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Unit of Measure into DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Invoice Period to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"uom"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['Conversion']"
													},
													"sink": {
														"name": "Conversion",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['descr']"
													},
													"sink": {
														"name": "descr",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['level']"
													},
													"sink": {
														"name": "level",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['metric_conversion']"
													},
													"sink": {
														"name": "metric_conversion",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['preferred']"
													},
													"sink": {
														"name": "preferred",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['reference']"
													},
													"sink": {
														"name": "reference",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['type']"
													},
													"sink": {
														"name": "type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['uom']"
													},
													"sink": {
														"name": "uom",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "unit_of_measure",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('unit_of_measure_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Container to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Unit of Measure into DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"container_type"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['AllowZeroQty']"
													},
													"sink": {
														"name": "AllowZeroQty",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['CODPortalDescription']"
													},
													"sink": {
														"name": "CODPortalDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImage']"
													},
													"sink": {
														"name": "CODPortalImage",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImageURL']"
													},
													"sink": {
														"name": "CODPortalImageURL",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['component']"
													},
													"sink": {
														"name": "component",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['cont_brws_desc']"
													},
													"sink": {
														"name": "cont_brws_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cont_inv_desc']"
													},
													"sink": {
														"name": "cont_inv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cont_MDT_desc']"
													},
													"sink": {
														"name": "cont_MDT_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_movement']"
													},
													"sink": {
														"name": "container_movement",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['container_type']"
													},
													"sink": {
														"name": "container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contwt_uom']"
													},
													"sink": {
														"name": "contwt_uom",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['daily_rental']"
													},
													"sink": {
														"name": "daily_rental",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['description']"
													},
													"sink": {
														"name": "description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['height']"
													},
													"sink": {
														"name": "height",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['inventory_item']"
													},
													"sink": {
														"name": "inventory_item",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account_RI']"
													},
													"sink": {
														"name": "ledger_account_RI",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['length']"
													},
													"sink": {
														"name": "length",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['master_container_type']"
													},
													"sink": {
														"name": "master_container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['price_by']"
													},
													"sink": {
														"name": "price_by",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serial_tracking']"
													},
													"sink": {
														"name": "serial_tracking",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['size']"
													},
													"sink": {
														"name": "size",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_weight']"
													},
													"sink": {
														"name": "tare_weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['width']"
													},
													"sink": {
														"name": "width",
														"type": "Int32"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "container",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "container",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('container_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Waste Type to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Container to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"waste_type"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['billing_unit']"
													},
													"sink": {
														"name": "billing_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['class']"
													},
													"sink": {
														"name": "class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalDescription']"
													},
													"sink": {
														"name": "CODPortalDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImage']"
													},
													"sink": {
														"name": "CODPortalImage",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImageURL']"
													},
													"sink": {
														"name": "CODPortalImageURL",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['density']"
													},
													"sink": {
														"name": "density",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['density_uom']"
													},
													"sink": {
														"name": "density_uom",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['epa_code']"
													},
													"sink": {
														"name": "epa_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['hazchem_code']"
													},
													"sink": {
														"name": "hazchem_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['InstructionsServFunc']"
													},
													"sink": {
														"name": "InstructionsServFunc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['landfill_tax_cd']"
													},
													"sink": {
														"name": "landfill_tax_cd",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account_RI']"
													},
													"sink": {
														"name": "ledger_account_RI",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['module_list']"
													},
													"sink": {
														"name": "module_list",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['packing_group']"
													},
													"sink": {
														"name": "packing_group",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['special_instructions']"
													},
													"sink": {
														"name": "special_instructions",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['un_number']"
													},
													"sink": {
														"name": "un_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['uom']"
													},
													"sink": {
														"name": "uom",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_appearance']"
													},
													"sink": {
														"name": "waste_appearance",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_brws_desc']"
													},
													"sink": {
														"name": "waste_brws_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_comp_percent_1']"
													},
													"sink": {
														"name": "waste_comp_percent_1",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['waste_comp_percent_2']"
													},
													"sink": {
														"name": "waste_comp_percent_2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['waste_comp_percent_3']"
													},
													"sink": {
														"name": "waste_comp_percent_3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['waste_comp_percent_4']"
													},
													"sink": {
														"name": "waste_comp_percent_4",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['waste_comp_percent_5']"
													},
													"sink": {
														"name": "waste_comp_percent_5",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['waste_description']"
													},
													"sink": {
														"name": "waste_description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_inv_desc']"
													},
													"sink": {
														"name": "waste_inv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_MDT_desc']"
													},
													"sink": {
														"name": "waste_MDT_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "wastetype",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "waste_type",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('Waste_Type_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Service code into DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Waste Type to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"serv_code"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['billing_qty']"
													},
													"sink": {
														"name": "billing_qty",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bin_count_incremental']"
													},
													"sink": {
														"name": "bin_count_incremental",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['booking_RFID']"
													},
													"sink": {
														"name": "booking_RFID",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Code_Type']"
													},
													"sink": {
														"name": "Code_Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalDescription']"
													},
													"sink": {
														"name": "CODPortalDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImage']"
													},
													"sink": {
														"name": "CODPortalImage",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImageURL']"
													},
													"sink": {
														"name": "CODPortalImageURL",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['colour_default']"
													},
													"sink": {
														"name": "colour_default",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['com_serviced_by_res']"
													},
													"sink": {
														"name": "com_serviced_by_res",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_1']"
													},
													"sink": {
														"name": "DayPlanCount_1",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_2']"
													},
													"sink": {
														"name": "DayPlanCount_2",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_3']"
													},
													"sink": {
														"name": "DayPlanCount_3",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_4']"
													},
													"sink": {
														"name": "DayPlanCount_4",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_5']"
													},
													"sink": {
														"name": "DayPlanCount_5",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_6']"
													},
													"sink": {
														"name": "DayPlanCount_6",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_7']"
													},
													"sink": {
														"name": "DayPlanCount_7",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_8']"
													},
													"sink": {
														"name": "DayPlanCount_8",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_9']"
													},
													"sink": {
														"name": "DayPlanCount_9",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_10']"
													},
													"sink": {
														"name": "DayPlanCount_10",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_1']"
													},
													"sink": {
														"name": "DayPlanRtType_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_2']"
													},
													"sink": {
														"name": "DayPlanRtType_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_3']"
													},
													"sink": {
														"name": "DayPlanRtType_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_4']"
													},
													"sink": {
														"name": "DayPlanRtType_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_5']"
													},
													"sink": {
														"name": "DayPlanRtType_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_6']"
													},
													"sink": {
														"name": "DayPlanRtType_6",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_7']"
													},
													"sink": {
														"name": "DayPlanRtType_7",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_8']"
													},
													"sink": {
														"name": "DayPlanRtType_8",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_9']"
													},
													"sink": {
														"name": "DayPlanRtType_9",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_10']"
													},
													"sink": {
														"name": "DayPlanRtType_10",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DefaultNewBookingStatus']"
													},
													"sink": {
														"name": "DefaultNewBookingStatus",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['description']"
													},
													"sink": {
														"name": "description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['dispatch_future_bkgs']"
													},
													"sink": {
														"name": "dispatch_future_bkgs",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['display_order']"
													},
													"sink": {
														"name": "display_order",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DuplicateBookingWarning']"
													},
													"sink": {
														"name": "DuplicateBookingWarning",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Invoice_cycle']"
													},
													"sink": {
														"name": "Invoice_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['lead_days']"
													},
													"sink": {
														"name": "lead_days",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account_RI']"
													},
													"sink": {
														"name": "ledger_account_RI",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['max_bkgs_per_zone']"
													},
													"sink": {
														"name": "max_bkgs_per_zone",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['serv_brws_desc']"
													},
													"sink": {
														"name": "serv_brws_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_inv_desc']"
													},
													"sink": {
														"name": "serv_inv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_MDT_desc']"
													},
													"sink": {
														"name": "serv_MDT_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Service_Type']"
													},
													"sink": {
														"name": "Service_Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TipSeperateExcess']"
													},
													"sink": {
														"name": "TipSeperateExcess",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WarnForAvailableSchedService']"
													},
													"sink": {
														"name": "WarnForAvailableSchedService",
														"type": "Boolean"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "service_code",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('service_code_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Service Type to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Service code into DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"serv_type"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['colour']"
													},
													"sink": {
														"name": "colour",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['display_order']"
													},
													"sink": {
														"name": "display_order",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['incl_tipping']"
													},
													"sink": {
														"name": "incl_tipping",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['inventory_effect']"
													},
													"sink": {
														"name": "inventory_effect",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MoveLinkedPickup']"
													},
													"sink": {
														"name": "MoveLinkedPickup",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['roll_option']"
													},
													"sink": {
														"name": "roll_option",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_brws_desc']"
													},
													"sink": {
														"name": "serv_brws_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc']"
													},
													"sink": {
														"name": "serv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_inv_desc']"
													},
													"sink": {
														"name": "serv_inv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_MDT_desc']"
													},
													"sink": {
														"name": "serv_MDT_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_type']"
													},
													"sink": {
														"name": "serv_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['skip_weekend']"
													},
													"sink": {
														"name": "skip_weekend",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "service_type",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('service_type_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Branch to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Service Type to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"org"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['default_transporter']"
													},
													"sink": {
														"name": "default_transporter",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Department']"
													},
													"sink": {
														"name": "Department",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Description']"
													},
													"sink": {
														"name": "Description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ExternalBranchCode']"
													},
													"sink": {
														"name": "ExternalBranchCode",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ExternalCompanyCode']"
													},
													"sink": {
														"name": "ExternalCompanyCode",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['org_title']"
													},
													"sink": {
														"name": "org_title",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['parent_org']"
													},
													"sink": {
														"name": "parent_org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Type']"
													},
													"sink": {
														"name": "Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "branch",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('branch_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Employee to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Branch to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['address_1']"
													},
													"sink": {
														"name": "address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_2']"
													},
													"sink": {
														"name": "address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['birth_date']"
													},
													"sink": {
														"name": "birth_date",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Branches']"
													},
													"sink": {
														"name": "Branches",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['car_phone']"
													},
													"sink": {
														"name": "car_phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['childrenRestricted']"
													},
													"sink": {
														"name": "childrenRestricted",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['city']"
													},
													"sink": {
														"name": "city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification']"
													},
													"sink": {
														"name": "classification",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Country']"
													},
													"sink": {
														"name": "Country",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['css_tab_button_size']"
													},
													"sink": {
														"name": "css_tab_button_size",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['css_tab_fillin_size']"
													},
													"sink": {
														"name": "css_tab_fillin_size",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['css_tab_mnu_font_size']"
													},
													"sink": {
														"name": "css_tab_mnu_font_size",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['date_hired']"
													},
													"sink": {
														"name": "date_hired",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_cert1']"
													},
													"sink": {
														"name": "driver_cert1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_cert1_exp_date']"
													},
													"sink": {
														"name": "driver_cert1_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_cert2']"
													},
													"sink": {
														"name": "driver_cert2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_cert2_exp_date']"
													},
													"sink": {
														"name": "driver_cert2_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_cert3']"
													},
													"sink": {
														"name": "driver_cert3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_cert3_exp_date']"
													},
													"sink": {
														"name": "driver_cert3_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_cert4']"
													},
													"sink": {
														"name": "driver_cert4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_cert4_exp_date']"
													},
													"sink": {
														"name": "driver_cert4_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_danger_cert']"
													},
													"sink": {
														"name": "driver_danger_cert",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_emp_type']"
													},
													"sink": {
														"name": "driver_emp_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_ins_exp_date']"
													},
													"sink": {
														"name": "driver_ins_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_lic_class']"
													},
													"sink": {
														"name": "driver_lic_class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_lic_exp_date']"
													},
													"sink": {
														"name": "driver_lic_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_lic_number']"
													},
													"sink": {
														"name": "driver_lic_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_lic_region']"
													},
													"sink": {
														"name": "driver_lic_region",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_ops_type']"
													},
													"sink": {
														"name": "driver_ops_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Driver_status']"
													},
													"sink": {
														"name": "Driver_status",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['email_address']"
													},
													"sink": {
														"name": "email_address",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Fatigue_Type']"
													},
													"sink": {
														"name": "Fatigue_Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['id']"
													},
													"sink": {
														"name": "id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['LastLogin']"
													},
													"sink": {
														"name": "LastLogin",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['name']"
													},
													"sink": {
														"name": "name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['phone']"
													},
													"sink": {
														"name": "phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['RecAdminEmails']"
													},
													"sink": {
														"name": "RecAdminEmails",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['RecAdvertEmails']"
													},
													"sink": {
														"name": "RecAdvertEmails",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['spouse']"
													},
													"sink": {
														"name": "spouse",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['state']"
													},
													"sink": {
														"name": "state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SupportAccount']"
													},
													"sink": {
														"name": "SupportAccount",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['type']"
													},
													"sink": {
														"name": "type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['username']"
													},
													"sink": {
														"name": "username",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zip']"
													},
													"sink": {
														"name": "zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zone_id']"
													},
													"sink": {
														"name": "zone_id",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "employee",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('employee_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Vendor to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Employee to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['address_1']"
													},
													"sink": {
														"name": "address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_1_alt']"
													},
													"sink": {
														"name": "address_1_alt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_2']"
													},
													"sink": {
														"name": "address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_2_alt']"
													},
													"sink": {
														"name": "address_2_alt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch_name']"
													},
													"sink": {
														"name": "branch_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BranchList']"
													},
													"sink": {
														"name": "BranchList",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['city']"
													},
													"sink": {
														"name": "city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification']"
													},
													"sink": {
														"name": "classification",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['depot_list']"
													},
													"sink": {
														"name": "depot_list",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disc_perc']"
													},
													"sink": {
														"name": "disc_perc",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['ea_permit_number']"
													},
													"sink": {
														"name": "ea_permit_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['email_address']"
													},
													"sink": {
														"name": "email_address",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['fax_no']"
													},
													"sink": {
														"name": "fax_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account_RI']"
													},
													"sink": {
														"name": "ledger_account_RI",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['name']"
													},
													"sink": {
														"name": "name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['name_alt']"
													},
													"sink": {
														"name": "name_alt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['phone']"
													},
													"sink": {
														"name": "phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['state']"
													},
													"sink": {
														"name": "state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Time_allowance']"
													},
													"sink": {
														"name": "Time_allowance",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['vendor_no']"
													},
													"sink": {
														"name": "vendor_no",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['vendor_type']"
													},
													"sink": {
														"name": "vendor_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zip']"
													},
													"sink": {
														"name": "zip",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "vendor",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('vendor_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Route to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Vendor to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['area_type']"
													},
													"sink": {
														"name": "area_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['display_order']"
													},
													"sink": {
														"name": "display_order",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['driver_list']"
													},
													"sink": {
														"name": "driver_list",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['equipment_set']"
													},
													"sink": {
														"name": "equipment_set",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Friday']"
													},
													"sink": {
														"name": "Friday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['G_Cal_ID']"
													},
													"sink": {
														"name": "G_Cal_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['G_Event_ID']"
													},
													"sink": {
														"name": "G_Event_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['InvoiceCustomer']"
													},
													"sink": {
														"name": "InvoiceCustomer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['InvoiceService']"
													},
													"sink": {
														"name": "InvoiceService",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['labour_rate_per_hour']"
													},
													"sink": {
														"name": "labour_rate_per_hour",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['mdt_enabled']"
													},
													"sink": {
														"name": "mdt_enabled",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Monday']"
													},
													"sink": {
														"name": "Monday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['next_service_date']"
													},
													"sink": {
														"name": "next_service_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['num_employees']"
													},
													"sink": {
														"name": "num_employees",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ReSequenceType']"
													},
													"sink": {
														"name": "ReSequenceType",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_brws_desc']"
													},
													"sink": {
														"name": "route_brws_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_cycle']"
													},
													"sink": {
														"name": "route_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_description']"
													},
													"sink": {
														"name": "route_description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_inv_desc']"
													},
													"sink": {
														"name": "route_inv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_MDT_desc']"
													},
													"sink": {
														"name": "route_MDT_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_type']"
													},
													"sink": {
														"name": "route_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Saturday']"
													},
													"sink": {
														"name": "Saturday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Sunday']"
													},
													"sink": {
														"name": "Sunday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['supervisor_no']"
													},
													"sink": {
														"name": "supervisor_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['team_no']"
													},
													"sink": {
														"name": "team_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Thursday']"
													},
													"sink": {
														"name": "Thursday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['truck_no']"
													},
													"sink": {
														"name": "truck_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Tuesday']"
													},
													"sink": {
														"name": "Tuesday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Wednesday']"
													},
													"sink": {
														"name": "Wednesday",
														"type": "Boolean"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "route",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "route",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('route_',item())",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"Entity": {
						"type": "Array",
						"defaultValue": [
							"system.system/vendor",
							"system.system/branch",
							"system.system/service_code",
							"system.system/service_type",
							"system.system/employee",
							"system.system/unit_of_measure",
							"wastetype.waste_type/waste_type",
							"vehicle.vehicle/vehicle",
							"invoiceperiod.invoicing/invoice_period",
							"container.container/container",
							"route.vehicle/route"
						]
					},
					"Instance": {
						"type": "Array",
						"defaultValue": [
							"wsgvic"
						]
					}
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/WFLEX')]",
				"[concat(variables('factoryId'), '/datasets/WSGNSW')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_WSG_query_wflex')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "For Each Entity",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('Entity')",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 3,
							"activities": [
								{
									"name": "Copy to DataLake WASTEFLEX",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true",
												"EndCondition:$.has_more": "Const:false",
												"QueryParameters.$start": "$.next_result"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "WFLEX",
											"type": "DatasetReference",
											"parameters": {
												"Dataset": {
													"value": "@split(item(),'.')[1]",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "@split(item(),'.')[0]",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"Instance": {
													"value": "wflex",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "For Each Instance",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "For Each Entity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('Instance')",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Vehicle to DB",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"truck_no"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['authoristation_no']"
													},
													"sink": {
														"name": "authoristation_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CallSign']"
													},
													"sink": {
														"name": "CallSign",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cert_waste_type']"
													},
													"sink": {
														"name": "cert_waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['class']"
													},
													"sink": {
														"name": "class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_type']"
													},
													"sink": {
														"name": "container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['current_hour_meter']"
													},
													"sink": {
														"name": "current_hour_meter",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['current_odometer']"
													},
													"sink": {
														"name": "current_odometer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['current_reading_date']"
													},
													"sink": {
														"name": "current_reading_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['cust_number']"
													},
													"sink": {
														"name": "cust_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['customer_truck']"
													},
													"sink": {
														"name": "customer_truck",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Disabled']"
													},
													"sink": {
														"name": "Disabled",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['last_pm_code']"
													},
													"sink": {
														"name": "last_pm_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['last_pm_date']"
													},
													"sink": {
														"name": "last_pm_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['last_pm_hour_meter']"
													},
													"sink": {
														"name": "last_pm_hour_meter",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['last_pm_odometer']"
													},
													"sink": {
														"name": "last_pm_odometer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['last_pm_order_no']"
													},
													"sink": {
														"name": "last_pm_order_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['last_waste_type']"
													},
													"sink": {
														"name": "last_waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account_RI']"
													},
													"sink": {
														"name": "ledger_account_RI",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MaximumWeight']"
													},
													"sink": {
														"name": "MaximumWeight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['MDTserial']"
													},
													"sink": {
														"name": "MDTserial",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['min_tonnage']"
													},
													"sink": {
														"name": "min_tonnage",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['plate_no']"
													},
													"sink": {
														"name": "plate_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['registered_gross_mass']"
													},
													"sink": {
														"name": "registered_gross_mass",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_average']"
													},
													"sink": {
														"name": "tare_average",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_date_1']"
													},
													"sink": {
														"name": "tare_date_1",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_2']"
													},
													"sink": {
														"name": "tare_date_2",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_3']"
													},
													"sink": {
														"name": "tare_date_3",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_4']"
													},
													"sink": {
														"name": "tare_date_4",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_5']"
													},
													"sink": {
														"name": "tare_date_5",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_6']"
													},
													"sink": {
														"name": "tare_date_6",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_7']"
													},
													"sink": {
														"name": "tare_date_7",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_8']"
													},
													"sink": {
														"name": "tare_date_8",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_9']"
													},
													"sink": {
														"name": "tare_date_9",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_10']"
													},
													"sink": {
														"name": "tare_date_10",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_expiry']"
													},
													"sink": {
														"name": "tare_expiry",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_1']"
													},
													"sink": {
														"name": "tare_wgt_1",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_2']"
													},
													"sink": {
														"name": "tare_wgt_2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_3']"
													},
													"sink": {
														"name": "tare_wgt_3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_4']"
													},
													"sink": {
														"name": "tare_wgt_4",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_5']"
													},
													"sink": {
														"name": "tare_wgt_5",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_6']"
													},
													"sink": {
														"name": "tare_wgt_6",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_7']"
													},
													"sink": {
														"name": "tare_wgt_7",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_8']"
													},
													"sink": {
														"name": "tare_wgt_8",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_9']"
													},
													"sink": {
														"name": "tare_wgt_9",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_10']"
													},
													"sink": {
														"name": "tare_wgt_10",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['truck_no']"
													},
													"sink": {
														"name": "truck_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['valid_from_date']"
													},
													"sink": {
														"name": "valid_from_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['valid_to_date']"
													},
													"sink": {
														"name": "valid_to_date",
														"type": "DateTime"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "vehicle",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "vehicle",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('vehicle_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Unit of Measure into DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Vehicle to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"uom"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['Conversion']"
													},
													"sink": {
														"name": "Conversion",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['descr']"
													},
													"sink": {
														"name": "descr",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['level']"
													},
													"sink": {
														"name": "level",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['metric_conversion']"
													},
													"sink": {
														"name": "metric_conversion",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['preferred']"
													},
													"sink": {
														"name": "preferred",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['reference']"
													},
													"sink": {
														"name": "reference",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['type']"
													},
													"sink": {
														"name": "type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['uom']"
													},
													"sink": {
														"name": "uom",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "unit_of_measure",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('unit_of_measure_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Container to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Unit of Measure into DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"container_type"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['AllowZeroQty']"
													},
													"sink": {
														"name": "AllowZeroQty",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['CODPortalDescription']"
													},
													"sink": {
														"name": "CODPortalDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImage']"
													},
													"sink": {
														"name": "CODPortalImage",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImageURL']"
													},
													"sink": {
														"name": "CODPortalImageURL",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['component']"
													},
													"sink": {
														"name": "component",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['cont_brws_desc']"
													},
													"sink": {
														"name": "cont_brws_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cont_inv_desc']"
													},
													"sink": {
														"name": "cont_inv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cont_MDT_desc']"
													},
													"sink": {
														"name": "cont_MDT_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_movement']"
													},
													"sink": {
														"name": "container_movement",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['container_type']"
													},
													"sink": {
														"name": "container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contwt_uom']"
													},
													"sink": {
														"name": "contwt_uom",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['daily_rental']"
													},
													"sink": {
														"name": "daily_rental",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['description']"
													},
													"sink": {
														"name": "description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['height']"
													},
													"sink": {
														"name": "height",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['inventory_item']"
													},
													"sink": {
														"name": "inventory_item",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account_RI']"
													},
													"sink": {
														"name": "ledger_account_RI",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['length']"
													},
													"sink": {
														"name": "length",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['master_container_type']"
													},
													"sink": {
														"name": "master_container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['price_by']"
													},
													"sink": {
														"name": "price_by",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serial_tracking']"
													},
													"sink": {
														"name": "serial_tracking",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['size']"
													},
													"sink": {
														"name": "size",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_weight']"
													},
													"sink": {
														"name": "tare_weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['width']"
													},
													"sink": {
														"name": "width",
														"type": "Int32"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "container",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "container",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('container_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Waste Type to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Container to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"waste_type"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['billing_unit']"
													},
													"sink": {
														"name": "billing_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['class']"
													},
													"sink": {
														"name": "class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalDescription']"
													},
													"sink": {
														"name": "CODPortalDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImage']"
													},
													"sink": {
														"name": "CODPortalImage",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImageURL']"
													},
													"sink": {
														"name": "CODPortalImageURL",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['density']"
													},
													"sink": {
														"name": "density",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['density_uom']"
													},
													"sink": {
														"name": "density_uom",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['epa_code']"
													},
													"sink": {
														"name": "epa_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['hazchem_code']"
													},
													"sink": {
														"name": "hazchem_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['InstructionsServFunc']"
													},
													"sink": {
														"name": "InstructionsServFunc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['landfill_tax_cd']"
													},
													"sink": {
														"name": "landfill_tax_cd",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account_RI']"
													},
													"sink": {
														"name": "ledger_account_RI",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['module_list']"
													},
													"sink": {
														"name": "module_list",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['packing_group']"
													},
													"sink": {
														"name": "packing_group",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['special_instructions']"
													},
													"sink": {
														"name": "special_instructions",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['un_number']"
													},
													"sink": {
														"name": "un_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['uom']"
													},
													"sink": {
														"name": "uom",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_appearance']"
													},
													"sink": {
														"name": "waste_appearance",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_brws_desc']"
													},
													"sink": {
														"name": "waste_brws_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_comp_percent_1']"
													},
													"sink": {
														"name": "waste_comp_percent_1",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['waste_comp_percent_2']"
													},
													"sink": {
														"name": "waste_comp_percent_2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['waste_comp_percent_3']"
													},
													"sink": {
														"name": "waste_comp_percent_3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['waste_comp_percent_4']"
													},
													"sink": {
														"name": "waste_comp_percent_4",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['waste_comp_percent_5']"
													},
													"sink": {
														"name": "waste_comp_percent_5",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['waste_description']"
													},
													"sink": {
														"name": "waste_description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_inv_desc']"
													},
													"sink": {
														"name": "waste_inv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_MDT_desc']"
													},
													"sink": {
														"name": "waste_MDT_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "wastetype",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "waste_type",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('Waste_Type_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Service code into DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Waste Type to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"serv_code"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['billing_qty']"
													},
													"sink": {
														"name": "billing_qty",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bin_count_incremental']"
													},
													"sink": {
														"name": "bin_count_incremental",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['booking_RFID']"
													},
													"sink": {
														"name": "booking_RFID",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Code_Type']"
													},
													"sink": {
														"name": "Code_Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalDescription']"
													},
													"sink": {
														"name": "CODPortalDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImage']"
													},
													"sink": {
														"name": "CODPortalImage",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImageURL']"
													},
													"sink": {
														"name": "CODPortalImageURL",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['colour_default']"
													},
													"sink": {
														"name": "colour_default",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['com_serviced_by_res']"
													},
													"sink": {
														"name": "com_serviced_by_res",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_1']"
													},
													"sink": {
														"name": "DayPlanCount_1",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_2']"
													},
													"sink": {
														"name": "DayPlanCount_2",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_3']"
													},
													"sink": {
														"name": "DayPlanCount_3",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_4']"
													},
													"sink": {
														"name": "DayPlanCount_4",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_5']"
													},
													"sink": {
														"name": "DayPlanCount_5",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_6']"
													},
													"sink": {
														"name": "DayPlanCount_6",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_7']"
													},
													"sink": {
														"name": "DayPlanCount_7",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_8']"
													},
													"sink": {
														"name": "DayPlanCount_8",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_9']"
													},
													"sink": {
														"name": "DayPlanCount_9",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_10']"
													},
													"sink": {
														"name": "DayPlanCount_10",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_1']"
													},
													"sink": {
														"name": "DayPlanRtType_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_2']"
													},
													"sink": {
														"name": "DayPlanRtType_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_3']"
													},
													"sink": {
														"name": "DayPlanRtType_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_4']"
													},
													"sink": {
														"name": "DayPlanRtType_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_5']"
													},
													"sink": {
														"name": "DayPlanRtType_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_6']"
													},
													"sink": {
														"name": "DayPlanRtType_6",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_7']"
													},
													"sink": {
														"name": "DayPlanRtType_7",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_8']"
													},
													"sink": {
														"name": "DayPlanRtType_8",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_9']"
													},
													"sink": {
														"name": "DayPlanRtType_9",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_10']"
													},
													"sink": {
														"name": "DayPlanRtType_10",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DefaultNewBookingStatus']"
													},
													"sink": {
														"name": "DefaultNewBookingStatus",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['description']"
													},
													"sink": {
														"name": "description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['dispatch_future_bkgs']"
													},
													"sink": {
														"name": "dispatch_future_bkgs",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['display_order']"
													},
													"sink": {
														"name": "display_order",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DuplicateBookingWarning']"
													},
													"sink": {
														"name": "DuplicateBookingWarning",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Invoice_cycle']"
													},
													"sink": {
														"name": "Invoice_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['lead_days']"
													},
													"sink": {
														"name": "lead_days",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account_RI']"
													},
													"sink": {
														"name": "ledger_account_RI",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['max_bkgs_per_zone']"
													},
													"sink": {
														"name": "max_bkgs_per_zone",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['serv_brws_desc']"
													},
													"sink": {
														"name": "serv_brws_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_inv_desc']"
													},
													"sink": {
														"name": "serv_inv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_MDT_desc']"
													},
													"sink": {
														"name": "serv_MDT_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Service_Type']"
													},
													"sink": {
														"name": "Service_Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TipSeperateExcess']"
													},
													"sink": {
														"name": "TipSeperateExcess",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WarnForAvailableSchedService']"
													},
													"sink": {
														"name": "WarnForAvailableSchedService",
														"type": "Boolean"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "service_code",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('service_code_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Service Type to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Service code into DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"serv_type"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['colour']"
													},
													"sink": {
														"name": "colour",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['display_order']"
													},
													"sink": {
														"name": "display_order",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['incl_tipping']"
													},
													"sink": {
														"name": "incl_tipping",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['inventory_effect']"
													},
													"sink": {
														"name": "inventory_effect",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MoveLinkedPickup']"
													},
													"sink": {
														"name": "MoveLinkedPickup",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['roll_option']"
													},
													"sink": {
														"name": "roll_option",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_brws_desc']"
													},
													"sink": {
														"name": "serv_brws_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc']"
													},
													"sink": {
														"name": "serv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_inv_desc']"
													},
													"sink": {
														"name": "serv_inv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_MDT_desc']"
													},
													"sink": {
														"name": "serv_MDT_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_type']"
													},
													"sink": {
														"name": "serv_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['skip_weekend']"
													},
													"sink": {
														"name": "skip_weekend",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "service_type",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('service_type_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Branch to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Service Type to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"org"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['default_transporter']"
													},
													"sink": {
														"name": "default_transporter",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Department']"
													},
													"sink": {
														"name": "Department",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Description']"
													},
													"sink": {
														"name": "Description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ExternalBranchCode']"
													},
													"sink": {
														"name": "ExternalBranchCode",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ExternalCompanyCode']"
													},
													"sink": {
														"name": "ExternalCompanyCode",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['org_title']"
													},
													"sink": {
														"name": "org_title",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['parent_org']"
													},
													"sink": {
														"name": "parent_org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Type']"
													},
													"sink": {
														"name": "Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "branch",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('branch_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Employee to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Branch to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['address_1']"
													},
													"sink": {
														"name": "address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_2']"
													},
													"sink": {
														"name": "address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['birth_date']"
													},
													"sink": {
														"name": "birth_date",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Branches']"
													},
													"sink": {
														"name": "Branches",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['car_phone']"
													},
													"sink": {
														"name": "car_phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['childrenRestricted']"
													},
													"sink": {
														"name": "childrenRestricted",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['city']"
													},
													"sink": {
														"name": "city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification']"
													},
													"sink": {
														"name": "classification",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Country']"
													},
													"sink": {
														"name": "Country",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['css_tab_button_size']"
													},
													"sink": {
														"name": "css_tab_button_size",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['css_tab_fillin_size']"
													},
													"sink": {
														"name": "css_tab_fillin_size",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['css_tab_mnu_font_size']"
													},
													"sink": {
														"name": "css_tab_mnu_font_size",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['date_hired']"
													},
													"sink": {
														"name": "date_hired",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_cert1']"
													},
													"sink": {
														"name": "driver_cert1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_cert1_exp_date']"
													},
													"sink": {
														"name": "driver_cert1_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_cert2']"
													},
													"sink": {
														"name": "driver_cert2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_cert2_exp_date']"
													},
													"sink": {
														"name": "driver_cert2_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_cert3']"
													},
													"sink": {
														"name": "driver_cert3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_cert3_exp_date']"
													},
													"sink": {
														"name": "driver_cert3_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_cert4']"
													},
													"sink": {
														"name": "driver_cert4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_cert4_exp_date']"
													},
													"sink": {
														"name": "driver_cert4_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_danger_cert']"
													},
													"sink": {
														"name": "driver_danger_cert",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_emp_type']"
													},
													"sink": {
														"name": "driver_emp_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_ins_exp_date']"
													},
													"sink": {
														"name": "driver_ins_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_lic_class']"
													},
													"sink": {
														"name": "driver_lic_class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_lic_exp_date']"
													},
													"sink": {
														"name": "driver_lic_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_lic_number']"
													},
													"sink": {
														"name": "driver_lic_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_lic_region']"
													},
													"sink": {
														"name": "driver_lic_region",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_ops_type']"
													},
													"sink": {
														"name": "driver_ops_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Driver_status']"
													},
													"sink": {
														"name": "Driver_status",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['email_address']"
													},
													"sink": {
														"name": "email_address",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Fatigue_Type']"
													},
													"sink": {
														"name": "Fatigue_Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['id']"
													},
													"sink": {
														"name": "id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['LastLogin']"
													},
													"sink": {
														"name": "LastLogin",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['name']"
													},
													"sink": {
														"name": "name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['phone']"
													},
													"sink": {
														"name": "phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['RecAdminEmails']"
													},
													"sink": {
														"name": "RecAdminEmails",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['RecAdvertEmails']"
													},
													"sink": {
														"name": "RecAdvertEmails",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['spouse']"
													},
													"sink": {
														"name": "spouse",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['state']"
													},
													"sink": {
														"name": "state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SupportAccount']"
													},
													"sink": {
														"name": "SupportAccount",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['type']"
													},
													"sink": {
														"name": "type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['username']"
													},
													"sink": {
														"name": "username",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zip']"
													},
													"sink": {
														"name": "zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zone_id']"
													},
													"sink": {
														"name": "zone_id",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "employee",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('employee_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Vendor to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Employee to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['address_1']"
													},
													"sink": {
														"name": "address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_1_alt']"
													},
													"sink": {
														"name": "address_1_alt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_2']"
													},
													"sink": {
														"name": "address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_2_alt']"
													},
													"sink": {
														"name": "address_2_alt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch_name']"
													},
													"sink": {
														"name": "branch_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BranchList']"
													},
													"sink": {
														"name": "BranchList",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['city']"
													},
													"sink": {
														"name": "city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification']"
													},
													"sink": {
														"name": "classification",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['depot_list']"
													},
													"sink": {
														"name": "depot_list",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disc_perc']"
													},
													"sink": {
														"name": "disc_perc",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['ea_permit_number']"
													},
													"sink": {
														"name": "ea_permit_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['email_address']"
													},
													"sink": {
														"name": "email_address",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['fax_no']"
													},
													"sink": {
														"name": "fax_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account_RI']"
													},
													"sink": {
														"name": "ledger_account_RI",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['name']"
													},
													"sink": {
														"name": "name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['name_alt']"
													},
													"sink": {
														"name": "name_alt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['phone']"
													},
													"sink": {
														"name": "phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['state']"
													},
													"sink": {
														"name": "state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Time_allowance']"
													},
													"sink": {
														"name": "Time_allowance",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['vendor_no']"
													},
													"sink": {
														"name": "vendor_no",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['vendor_type']"
													},
													"sink": {
														"name": "vendor_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zip']"
													},
													"sink": {
														"name": "zip",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "vendor",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('vendor_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Route to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Vendor to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['area_type']"
													},
													"sink": {
														"name": "area_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['display_order']"
													},
													"sink": {
														"name": "display_order",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['driver_list']"
													},
													"sink": {
														"name": "driver_list",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['equipment_set']"
													},
													"sink": {
														"name": "equipment_set",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Friday']"
													},
													"sink": {
														"name": "Friday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['G_Cal_ID']"
													},
													"sink": {
														"name": "G_Cal_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['G_Event_ID']"
													},
													"sink": {
														"name": "G_Event_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['InvoiceCustomer']"
													},
													"sink": {
														"name": "InvoiceCustomer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['InvoiceService']"
													},
													"sink": {
														"name": "InvoiceService",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['labour_rate_per_hour']"
													},
													"sink": {
														"name": "labour_rate_per_hour",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['mdt_enabled']"
													},
													"sink": {
														"name": "mdt_enabled",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Monday']"
													},
													"sink": {
														"name": "Monday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['next_service_date']"
													},
													"sink": {
														"name": "next_service_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['num_employees']"
													},
													"sink": {
														"name": "num_employees",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ReSequenceType']"
													},
													"sink": {
														"name": "ReSequenceType",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_brws_desc']"
													},
													"sink": {
														"name": "route_brws_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_cycle']"
													},
													"sink": {
														"name": "route_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_description']"
													},
													"sink": {
														"name": "route_description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_inv_desc']"
													},
													"sink": {
														"name": "route_inv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_MDT_desc']"
													},
													"sink": {
														"name": "route_MDT_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_type']"
													},
													"sink": {
														"name": "route_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Saturday']"
													},
													"sink": {
														"name": "Saturday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Sunday']"
													},
													"sink": {
														"name": "Sunday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['supervisor_no']"
													},
													"sink": {
														"name": "supervisor_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['team_no']"
													},
													"sink": {
														"name": "team_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Thursday']"
													},
													"sink": {
														"name": "Thursday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['truck_no']"
													},
													"sink": {
														"name": "truck_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Tuesday']"
													},
													"sink": {
														"name": "Tuesday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Wednesday']"
													},
													"sink": {
														"name": "Wednesday",
														"type": "Boolean"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "route",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "route",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('route_',item())",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"Entity": {
						"type": "Array",
						"defaultValue": [
							"system.system/vendor",
							"system.system/unit_of_measure",
							"system.system/branch",
							"system.system/service_code",
							"system.system/service_type",
							"system.system/employee",
							"system.system/unit_of_measure",
							"wastetype.waste_type/waste_type",
							"vehicle.vehicle/vehicle",
							"invoiceperiod.invoicing/invoice_period",
							"container.container/container",
							"route.vehicle/route"
						]
					},
					"Instance": {
						"type": "Array",
						"defaultValue": [
							"wflex"
						]
					}
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/WFLEX')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_WSG_query_wsgnsw')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "For Each Entity",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('Entity')",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 3,
							"activities": [
								{
									"name": "Copy to DataLake WSGNSW",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"paginationRules": {
												"supportRFC5988": "true",
												"EndCondition:$.has_more": "Const:false",
												"QueryParameters.$start": "$.next_result"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "WSGNSW",
											"type": "DatasetReference",
											"parameters": {
												"Dataset": {
													"value": "@split(item(),'.')[1]",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "@split(item(),'.')[0]",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "@split(item(),'/')[1]",
													"type": "Expression"
												},
												"Instance": {
													"value": "wsgnsw",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "For Each Instance",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "For Each Entity",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('Instance')",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Vehicle to DB",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"truck_no"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['authoristation_no']"
													},
													"sink": {
														"name": "authoristation_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CallSign']"
													},
													"sink": {
														"name": "CallSign",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cert_waste_type']"
													},
													"sink": {
														"name": "cert_waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['class']"
													},
													"sink": {
														"name": "class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_type']"
													},
													"sink": {
														"name": "container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['current_hour_meter']"
													},
													"sink": {
														"name": "current_hour_meter",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['current_odometer']"
													},
													"sink": {
														"name": "current_odometer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['current_reading_date']"
													},
													"sink": {
														"name": "current_reading_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['cust_number']"
													},
													"sink": {
														"name": "cust_number",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['customer_truck']"
													},
													"sink": {
														"name": "customer_truck",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Disabled']"
													},
													"sink": {
														"name": "Disabled",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['last_pm_code']"
													},
													"sink": {
														"name": "last_pm_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['last_pm_date']"
													},
													"sink": {
														"name": "last_pm_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['last_pm_hour_meter']"
													},
													"sink": {
														"name": "last_pm_hour_meter",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['last_pm_odometer']"
													},
													"sink": {
														"name": "last_pm_odometer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['last_pm_order_no']"
													},
													"sink": {
														"name": "last_pm_order_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['last_waste_type']"
													},
													"sink": {
														"name": "last_waste_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account_RI']"
													},
													"sink": {
														"name": "ledger_account_RI",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MaximumWeight']"
													},
													"sink": {
														"name": "MaximumWeight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['MDTserial']"
													},
													"sink": {
														"name": "MDTserial",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['min_tonnage']"
													},
													"sink": {
														"name": "min_tonnage",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['plate_no']"
													},
													"sink": {
														"name": "plate_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['registered_gross_mass']"
													},
													"sink": {
														"name": "registered_gross_mass",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_average']"
													},
													"sink": {
														"name": "tare_average",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_date_1']"
													},
													"sink": {
														"name": "tare_date_1",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_2']"
													},
													"sink": {
														"name": "tare_date_2",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_3']"
													},
													"sink": {
														"name": "tare_date_3",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_4']"
													},
													"sink": {
														"name": "tare_date_4",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_5']"
													},
													"sink": {
														"name": "tare_date_5",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_6']"
													},
													"sink": {
														"name": "tare_date_6",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_7']"
													},
													"sink": {
														"name": "tare_date_7",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_8']"
													},
													"sink": {
														"name": "tare_date_8",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_9']"
													},
													"sink": {
														"name": "tare_date_9",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_date_10']"
													},
													"sink": {
														"name": "tare_date_10",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_expiry']"
													},
													"sink": {
														"name": "tare_expiry",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_1']"
													},
													"sink": {
														"name": "tare_wgt_1",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_2']"
													},
													"sink": {
														"name": "tare_wgt_2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_3']"
													},
													"sink": {
														"name": "tare_wgt_3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_4']"
													},
													"sink": {
														"name": "tare_wgt_4",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_5']"
													},
													"sink": {
														"name": "tare_wgt_5",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_6']"
													},
													"sink": {
														"name": "tare_wgt_6",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_7']"
													},
													"sink": {
														"name": "tare_wgt_7",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_8']"
													},
													"sink": {
														"name": "tare_wgt_8",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_9']"
													},
													"sink": {
														"name": "tare_wgt_9",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_wgt_10']"
													},
													"sink": {
														"name": "tare_wgt_10",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['truck_no']"
													},
													"sink": {
														"name": "truck_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['valid_from_date']"
													},
													"sink": {
														"name": "valid_from_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['valid_to_date']"
													},
													"sink": {
														"name": "valid_to_date",
														"type": "DateTime"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "vehicle",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "vehicle",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('vehicle_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Invoice Period to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Vehicle to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"org",
													"period_end_date"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['ar_balances_1']"
													},
													"sink": {
														"name": "ar_balances_1",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['ar_balances_2']"
													},
													"sink": {
														"name": "ar_balances_2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['ar_balances_3']"
													},
													"sink": {
														"name": "ar_balances_3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['ar_balances_4']"
													},
													"sink": {
														"name": "ar_balances_4",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['ar_balances_5']"
													},
													"sink": {
														"name": "ar_balances_5",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['current_period']"
													},
													"sink": {
														"name": "current_period",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['os_code']"
													},
													"sink": {
														"name": "os_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['period_end_date']"
													},
													"sink": {
														"name": "period_end_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['period_no']"
													},
													"sink": {
														"name": "period_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['total_revenue']"
													},
													"sink": {
														"name": "total_revenue",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['year_no']"
													},
													"sink": {
														"name": "year_no",
														"type": "Int32"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "invoice_period",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('invoice_period_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Unit of Measure into DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Invoice Period to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"uom"
												]
											},
											"sqlWriterUseTableLock": false,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['Conversion']"
													},
													"sink": {
														"name": "Conversion",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['descr']"
													},
													"sink": {
														"name": "descr",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['level']"
													},
													"sink": {
														"name": "level",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['metric_conversion']"
													},
													"sink": {
														"name": "metric_conversion",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['preferred']"
													},
													"sink": {
														"name": "preferred",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['reference']"
													},
													"sink": {
														"name": "reference",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['type']"
													},
													"sink": {
														"name": "type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['uom']"
													},
													"sink": {
														"name": "uom",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "unit_of_measure",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('unit_of_measure_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Container to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Unit of Measure into DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"container_type"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['AllowZeroQty']"
													},
													"sink": {
														"name": "AllowZeroQty",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['CODPortalDescription']"
													},
													"sink": {
														"name": "CODPortalDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImage']"
													},
													"sink": {
														"name": "CODPortalImage",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImageURL']"
													},
													"sink": {
														"name": "CODPortalImageURL",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['component']"
													},
													"sink": {
														"name": "component",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['cont_brws_desc']"
													},
													"sink": {
														"name": "cont_brws_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cont_inv_desc']"
													},
													"sink": {
														"name": "cont_inv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['cont_MDT_desc']"
													},
													"sink": {
														"name": "cont_MDT_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['container_movement']"
													},
													"sink": {
														"name": "container_movement",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['container_type']"
													},
													"sink": {
														"name": "container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['contwt_uom']"
													},
													"sink": {
														"name": "contwt_uom",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['daily_rental']"
													},
													"sink": {
														"name": "daily_rental",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['description']"
													},
													"sink": {
														"name": "description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['height']"
													},
													"sink": {
														"name": "height",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['inventory_item']"
													},
													"sink": {
														"name": "inventory_item",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account_RI']"
													},
													"sink": {
														"name": "ledger_account_RI",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['length']"
													},
													"sink": {
														"name": "length",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['master_container_type']"
													},
													"sink": {
														"name": "master_container_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['price_by']"
													},
													"sink": {
														"name": "price_by",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serial_tracking']"
													},
													"sink": {
														"name": "serial_tracking",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['size']"
													},
													"sink": {
														"name": "size",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['tare_weight']"
													},
													"sink": {
														"name": "tare_weight",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['width']"
													},
													"sink": {
														"name": "width",
														"type": "Int32"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "container",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('container_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Waste Type to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Container to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"waste_type"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['billing_unit']"
													},
													"sink": {
														"name": "billing_unit",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['class']"
													},
													"sink": {
														"name": "class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalDescription']"
													},
													"sink": {
														"name": "CODPortalDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImage']"
													},
													"sink": {
														"name": "CODPortalImage",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImageURL']"
													},
													"sink": {
														"name": "CODPortalImageURL",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['density']"
													},
													"sink": {
														"name": "density",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['density_uom']"
													},
													"sink": {
														"name": "density_uom",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['epa_code']"
													},
													"sink": {
														"name": "epa_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['hazchem_code']"
													},
													"sink": {
														"name": "hazchem_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['InstructionsServFunc']"
													},
													"sink": {
														"name": "InstructionsServFunc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['landfill_tax_cd']"
													},
													"sink": {
														"name": "landfill_tax_cd",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account_RI']"
													},
													"sink": {
														"name": "ledger_account_RI",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['module_list']"
													},
													"sink": {
														"name": "module_list",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['packing_group']"
													},
													"sink": {
														"name": "packing_group",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['special_instructions']"
													},
													"sink": {
														"name": "special_instructions",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['un_number']"
													},
													"sink": {
														"name": "un_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['uom']"
													},
													"sink": {
														"name": "uom",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_appearance']"
													},
													"sink": {
														"name": "waste_appearance",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_brws_desc']"
													},
													"sink": {
														"name": "waste_brws_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_comp_percent_1']"
													},
													"sink": {
														"name": "waste_comp_percent_1",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['waste_comp_percent_2']"
													},
													"sink": {
														"name": "waste_comp_percent_2",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['waste_comp_percent_3']"
													},
													"sink": {
														"name": "waste_comp_percent_3",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['waste_comp_percent_4']"
													},
													"sink": {
														"name": "waste_comp_percent_4",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['waste_comp_percent_5']"
													},
													"sink": {
														"name": "waste_comp_percent_5",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['waste_description']"
													},
													"sink": {
														"name": "waste_description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_inv_desc']"
													},
													"sink": {
														"name": "waste_inv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_MDT_desc']"
													},
													"sink": {
														"name": "waste_MDT_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['waste_type']"
													},
													"sink": {
														"name": "waste_type",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "wastetype",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "waste_type",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('Waste_Type_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Service code into DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Waste Type to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"serv_code"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['billing_qty']"
													},
													"sink": {
														"name": "billing_qty",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['bin_count_incremental']"
													},
													"sink": {
														"name": "bin_count_incremental",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['booking_RFID']"
													},
													"sink": {
														"name": "booking_RFID",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Code_Type']"
													},
													"sink": {
														"name": "Code_Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalDescription']"
													},
													"sink": {
														"name": "CODPortalDescription",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImage']"
													},
													"sink": {
														"name": "CODPortalImage",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['CODPortalImageURL']"
													},
													"sink": {
														"name": "CODPortalImageURL",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['colour_default']"
													},
													"sink": {
														"name": "colour_default",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['com_serviced_by_res']"
													},
													"sink": {
														"name": "com_serviced_by_res",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_1']"
													},
													"sink": {
														"name": "DayPlanCount_1",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_2']"
													},
													"sink": {
														"name": "DayPlanCount_2",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_3']"
													},
													"sink": {
														"name": "DayPlanCount_3",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_4']"
													},
													"sink": {
														"name": "DayPlanCount_4",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_5']"
													},
													"sink": {
														"name": "DayPlanCount_5",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_6']"
													},
													"sink": {
														"name": "DayPlanCount_6",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_7']"
													},
													"sink": {
														"name": "DayPlanCount_7",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_8']"
													},
													"sink": {
														"name": "DayPlanCount_8",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_9']"
													},
													"sink": {
														"name": "DayPlanCount_9",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanCount_10']"
													},
													"sink": {
														"name": "DayPlanCount_10",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_1']"
													},
													"sink": {
														"name": "DayPlanRtType_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_2']"
													},
													"sink": {
														"name": "DayPlanRtType_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_3']"
													},
													"sink": {
														"name": "DayPlanRtType_3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_4']"
													},
													"sink": {
														"name": "DayPlanRtType_4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_5']"
													},
													"sink": {
														"name": "DayPlanRtType_5",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_6']"
													},
													"sink": {
														"name": "DayPlanRtType_6",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_7']"
													},
													"sink": {
														"name": "DayPlanRtType_7",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_8']"
													},
													"sink": {
														"name": "DayPlanRtType_8",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_9']"
													},
													"sink": {
														"name": "DayPlanRtType_9",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DayPlanRtType_10']"
													},
													"sink": {
														"name": "DayPlanRtType_10",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['DefaultNewBookingStatus']"
													},
													"sink": {
														"name": "DefaultNewBookingStatus",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['description']"
													},
													"sink": {
														"name": "description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['dispatch_future_bkgs']"
													},
													"sink": {
														"name": "dispatch_future_bkgs",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['display_order']"
													},
													"sink": {
														"name": "display_order",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['DuplicateBookingWarning']"
													},
													"sink": {
														"name": "DuplicateBookingWarning",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Invoice_cycle']"
													},
													"sink": {
														"name": "Invoice_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['lead_days']"
													},
													"sink": {
														"name": "lead_days",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account_RI']"
													},
													"sink": {
														"name": "ledger_account_RI",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['max_bkgs_per_zone']"
													},
													"sink": {
														"name": "max_bkgs_per_zone",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['serv_brws_desc']"
													},
													"sink": {
														"name": "serv_brws_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_inv_desc']"
													},
													"sink": {
														"name": "serv_inv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_MDT_desc']"
													},
													"sink": {
														"name": "serv_MDT_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Service_Type']"
													},
													"sink": {
														"name": "Service_Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['TipSeperateExcess']"
													},
													"sink": {
														"name": "TipSeperateExcess",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['WarnForAvailableSchedService']"
													},
													"sink": {
														"name": "WarnForAvailableSchedService",
														"type": "Boolean"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "service_code",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('service_code_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Service Type to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Service code into DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"serv_type"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['colour']"
													},
													"sink": {
														"name": "colour",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['display_order']"
													},
													"sink": {
														"name": "display_order",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['incl_tipping']"
													},
													"sink": {
														"name": "incl_tipping",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['inventory_effect']"
													},
													"sink": {
														"name": "inventory_effect",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['MoveLinkedPickup']"
													},
													"sink": {
														"name": "MoveLinkedPickup",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['roll_option']"
													},
													"sink": {
														"name": "roll_option",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_brws_desc']"
													},
													"sink": {
														"name": "serv_brws_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_desc']"
													},
													"sink": {
														"name": "serv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_inv_desc']"
													},
													"sink": {
														"name": "serv_inv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_MDT_desc']"
													},
													"sink": {
														"name": "serv_MDT_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['serv_type']"
													},
													"sink": {
														"name": "serv_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['skip_weekend']"
													},
													"sink": {
														"name": "skip_weekend",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "service_type",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('service_type_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Branch to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Service Type to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"org"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['default_transporter']"
													},
													"sink": {
														"name": "default_transporter",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['Department']"
													},
													"sink": {
														"name": "Department",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Description']"
													},
													"sink": {
														"name": "Description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ExternalBranchCode']"
													},
													"sink": {
														"name": "ExternalBranchCode",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ExternalCompanyCode']"
													},
													"sink": {
														"name": "ExternalCompanyCode",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['org']"
													},
													"sink": {
														"name": "org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['org_title']"
													},
													"sink": {
														"name": "org_title",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['parent_org']"
													},
													"sink": {
														"name": "parent_org",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['Type']"
													},
													"sink": {
														"name": "Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "branch",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('branch_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Employee to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Branch to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['address_1']"
													},
													"sink": {
														"name": "address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_2']"
													},
													"sink": {
														"name": "address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['birth_date']"
													},
													"sink": {
														"name": "birth_date",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Branches']"
													},
													"sink": {
														"name": "Branches",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['car_phone']"
													},
													"sink": {
														"name": "car_phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['childrenRestricted']"
													},
													"sink": {
														"name": "childrenRestricted",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['city']"
													},
													"sink": {
														"name": "city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification']"
													},
													"sink": {
														"name": "classification",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Country']"
													},
													"sink": {
														"name": "Country",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['css_tab_button_size']"
													},
													"sink": {
														"name": "css_tab_button_size",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['css_tab_fillin_size']"
													},
													"sink": {
														"name": "css_tab_fillin_size",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['css_tab_mnu_font_size']"
													},
													"sink": {
														"name": "css_tab_mnu_font_size",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['date_hired']"
													},
													"sink": {
														"name": "date_hired",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_cert1']"
													},
													"sink": {
														"name": "driver_cert1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_cert1_exp_date']"
													},
													"sink": {
														"name": "driver_cert1_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_cert2']"
													},
													"sink": {
														"name": "driver_cert2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_cert2_exp_date']"
													},
													"sink": {
														"name": "driver_cert2_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_cert3']"
													},
													"sink": {
														"name": "driver_cert3",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_cert3_exp_date']"
													},
													"sink": {
														"name": "driver_cert3_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_cert4']"
													},
													"sink": {
														"name": "driver_cert4",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_cert4_exp_date']"
													},
													"sink": {
														"name": "driver_cert4_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_danger_cert']"
													},
													"sink": {
														"name": "driver_danger_cert",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_emp_type']"
													},
													"sink": {
														"name": "driver_emp_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_ins_exp_date']"
													},
													"sink": {
														"name": "driver_ins_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_lic_class']"
													},
													"sink": {
														"name": "driver_lic_class",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_lic_exp_date']"
													},
													"sink": {
														"name": "driver_lic_exp_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['driver_lic_number']"
													},
													"sink": {
														"name": "driver_lic_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_lic_region']"
													},
													"sink": {
														"name": "driver_lic_region",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['driver_ops_type']"
													},
													"sink": {
														"name": "driver_ops_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Driver_status']"
													},
													"sink": {
														"name": "Driver_status",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['email_address']"
													},
													"sink": {
														"name": "email_address",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Fatigue_Type']"
													},
													"sink": {
														"name": "Fatigue_Type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['id']"
													},
													"sink": {
														"name": "id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['LastLogin']"
													},
													"sink": {
														"name": "LastLogin",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['name']"
													},
													"sink": {
														"name": "name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['phone']"
													},
													"sink": {
														"name": "phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['RecAdminEmails']"
													},
													"sink": {
														"name": "RecAdminEmails",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['RecAdvertEmails']"
													},
													"sink": {
														"name": "RecAdvertEmails",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['spouse']"
													},
													"sink": {
														"name": "spouse",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['state']"
													},
													"sink": {
														"name": "state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['SupportAccount']"
													},
													"sink": {
														"name": "SupportAccount",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['type']"
													},
													"sink": {
														"name": "type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['username']"
													},
													"sink": {
														"name": "username",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zip']"
													},
													"sink": {
														"name": "zip",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zone_id']"
													},
													"sink": {
														"name": "zone_id",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "employee",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('employee_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Vendor to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Employee to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "upsert",
											"upsertSettings": {
												"useTempDB": true,
												"keys": [
													"id"
												]
											},
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['address_1']"
													},
													"sink": {
														"name": "address_1",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_1_alt']"
													},
													"sink": {
														"name": "address_1_alt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_2']"
													},
													"sink": {
														"name": "address_2",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['address_2_alt']"
													},
													"sink": {
														"name": "address_2_alt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch_name']"
													},
													"sink": {
														"name": "branch_name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['BranchList']"
													},
													"sink": {
														"name": "BranchList",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['city']"
													},
													"sink": {
														"name": "city",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['classification']"
													},
													"sink": {
														"name": "classification",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['depot_list']"
													},
													"sink": {
														"name": "depot_list",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['disc_perc']"
													},
													"sink": {
														"name": "disc_perc",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['ea_permit_number']"
													},
													"sink": {
														"name": "ea_permit_number",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['email_address']"
													},
													"sink": {
														"name": "email_address",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['fax_no']"
													},
													"sink": {
														"name": "fax_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['geocode_x']"
													},
													"sink": {
														"name": "geocode_x",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['geocode_y']"
													},
													"sink": {
														"name": "geocode_y",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ledger_account']"
													},
													"sink": {
														"name": "ledger_account",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['ledger_account_RI']"
													},
													"sink": {
														"name": "ledger_account_RI",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['name']"
													},
													"sink": {
														"name": "name",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['name_alt']"
													},
													"sink": {
														"name": "name_alt",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['phone']"
													},
													"sink": {
														"name": "phone",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['state']"
													},
													"sink": {
														"name": "state",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Time_allowance']"
													},
													"sink": {
														"name": "Time_allowance",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateUserID']"
													},
													"sink": {
														"name": "UpdateUserID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['vendor_no']"
													},
													"sink": {
														"name": "vendor_no",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['vendor_type']"
													},
													"sink": {
														"name": "vendor_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['zip']"
													},
													"sink": {
														"name": "zip",
														"type": "String"
													}
												}
											],
											"collectionReference": "$['result']",
											"mapComplexValuesToString": false
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "system",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "vendor",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('vendor_',item())",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Route to DB",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Vendor to DB",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": true,
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"path": "[['$id']"
													},
													"sink": {
														"name": "id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Active']"
													},
													"sink": {
														"name": "Active",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['area_type']"
													},
													"sink": {
														"name": "area_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['branch']"
													},
													"sink": {
														"name": "branch",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['create_timestamp']"
													},
													"sink": {
														"name": "create_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['create_user_id']"
													},
													"sink": {
														"name": "create_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['display_order']"
													},
													"sink": {
														"name": "display_order",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['driver']"
													},
													"sink": {
														"name": "driver",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['driver_list']"
													},
													"sink": {
														"name": "driver_list",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['equipment_set']"
													},
													"sink": {
														"name": "equipment_set",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Friday']"
													},
													"sink": {
														"name": "Friday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['G_Cal_ID']"
													},
													"sink": {
														"name": "G_Cal_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['G_Event_ID']"
													},
													"sink": {
														"name": "G_Event_ID",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['import_id']"
													},
													"sink": {
														"name": "import_id",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['InvoiceCustomer']"
													},
													"sink": {
														"name": "InvoiceCustomer",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['InvoiceService']"
													},
													"sink": {
														"name": "InvoiceService",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['labour_rate_per_hour']"
													},
													"sink": {
														"name": "labour_rate_per_hour",
														"type": "Decimal"
													}
												},
												{
													"source": {
														"path": "[['mdt_enabled']"
													},
													"sink": {
														"name": "mdt_enabled",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['Monday']"
													},
													"sink": {
														"name": "Monday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['next_service_date']"
													},
													"sink": {
														"name": "next_service_date",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['num_employees']"
													},
													"sink": {
														"name": "num_employees",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['ReSequenceType']"
													},
													"sink": {
														"name": "ReSequenceType",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_brws_desc']"
													},
													"sink": {
														"name": "route_brws_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_cycle']"
													},
													"sink": {
														"name": "route_cycle",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_description']"
													},
													"sink": {
														"name": "route_description",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_inv_desc']"
													},
													"sink": {
														"name": "route_inv_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_MDT_desc']"
													},
													"sink": {
														"name": "route_MDT_desc",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_no']"
													},
													"sink": {
														"name": "route_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['route_type']"
													},
													"sink": {
														"name": "route_type",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Saturday']"
													},
													"sink": {
														"name": "Saturday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['serv_code']"
													},
													"sink": {
														"name": "serv_code",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['shift_no']"
													},
													"sink": {
														"name": "shift_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Sunday']"
													},
													"sink": {
														"name": "Sunday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['supervisor_no']"
													},
													"sink": {
														"name": "supervisor_no",
														"type": "Int32"
													}
												},
												{
													"source": {
														"path": "[['team_no']"
													},
													"sink": {
														"name": "team_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Thursday']"
													},
													"sink": {
														"name": "Thursday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['truck_no']"
													},
													"sink": {
														"name": "truck_no",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Tuesday']"
													},
													"sink": {
														"name": "Tuesday",
														"type": "Boolean"
													}
												},
												{
													"source": {
														"path": "[['update_timestamp']"
													},
													"sink": {
														"name": "update_timestamp",
														"type": "DateTime"
													}
												},
												{
													"source": {
														"path": "[['update_user_id']"
													},
													"sink": {
														"name": "update_user_id",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['UpdateProgram']"
													},
													"sink": {
														"name": "UpdateProgram",
														"type": "String"
													}
												},
												{
													"source": {
														"path": "[['Wednesday']"
													},
													"sink": {
														"name": "Wednesday",
														"type": "Boolean"
													}
												}
											],
											"collectionReference": "$['result']"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake",
											"type": "DatasetReference",
											"parameters": {
												"EffectiveDate": {
													"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
													"type": "Expression"
												},
												"ContainerName": {
													"value": "route",
													"type": "Expression"
												},
												"DatasetName": {
													"value": "route",
													"type": "Expression"
												},
												"Instance": {
													"value": "@item()",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DBTable",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@concat('route_',item())",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"Entity": {
						"type": "Array",
						"defaultValue": [
							"system.system/vendor",
							"system.system/branch",
							"system.system/service_code",
							"system.system/service_type",
							"system.system/employee",
							"system.system/unit_of_measure",
							"wastetype.waste_type/waste_type",
							"vehicle.vehicle/vehicle",
							"invoiceperiod.invoicing/invoice_period",
							"container.container/container",
							"route.vehicle/route"
						]
					},
					"Instance": {
						"type": "Array",
						"defaultValue": [
							"wsgvic"
						]
					}
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/WSGNSW')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Wastedge_Generic_DateQuery')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach API Entity",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "If Refresh Data by Update Timestamp",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@pipeline().parameters.ApiEntities",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Set Api Query Relative Url",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set Api Instance",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "varRestRelativeUrl",
										"value": {
											"value": "@if(lessOrEquals(pipeline().parameters.RefreshDataDayOffset, 0)\n, concat(variables('varApiInstance'),'?$query=update_timestamp>=','''', variables('varStartDate'), ''' and update_timestamp<=','''', variables('varEndDate'), '''')\n, concat(variables('varApiInstance'),'')\n)",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set Api Instance",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "varApiInstance",
										"value": {
											"value": "@split(item(), '.')[1]",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Switch Instance - Download Wastedge Data",
									"type": "Switch",
									"dependsOn": [
										{
											"activity": "Set Api Query Relative Url",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Set DataLake FileName",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Set DataLake Directory",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"on": {
											"value": "@toLower(pipeline().parameters.Instance)",
											"type": "Expression"
										},
										"cases": [
											{
												"value": "wflex",
												"activities": [
													{
														"name": "Download Data - WFLEX",
														"type": "Copy",
														"dependsOn": [],
														"policy": {
															"timeout": "0.12:00:00",
															"retry": 2,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "RestSource",
																"httpRequestTimeout": "00:01:40",
																"requestInterval": "00.00:00:00.010",
																"requestMethod": "GET",
																"paginationRules": {
																	"supportRFC5988": "true",
																	"QueryParameters.$start": "$.next_result",
																	"EndCondition:$.has_more": "Const:false"
																}
															},
															"sink": {
																"type": "JsonSink",
																"storeSettings": {
																	"type": "AzureBlobFSWriteSettings"
																},
																"formatSettings": {
																	"type": "JsonWriteSettings"
																}
															},
															"enableStaging": false
														},
														"inputs": [
															{
																"referenceName": "RestResource_WastedgeAPI_WFLEX",
																"type": "DatasetReference",
																"parameters": {
																	"restRelativeUrl": "@variables('varApiInstance')"
																}
															}
														],
														"outputs": [
															{
																"referenceName": "DataLake_Wastedge",
																"type": "DatasetReference",
																"parameters": {
																	"pFileSystem": {
																		"value": "@variables('varDataLake_FileSystem')",
																		"type": "Expression"
																	},
																	"pDirectory": {
																		"value": "@variables('varDataLake_Diretory')",
																		"type": "Expression"
																	},
																	"pFileName": {
																		"value": "@variables('varDataLake_FileName')",
																		"type": "Expression"
																	}
																}
															}
														]
													}
												]
											},
											{
												"value": "wsgnsw",
												"activities": [
													{
														"name": "Download Data - WSGNSW",
														"type": "Copy",
														"dependsOn": [],
														"policy": {
															"timeout": "0.12:00:00",
															"retry": 2,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "RestSource",
																"httpRequestTimeout": "00:01:40",
																"requestInterval": "00.00:00:00.010",
																"requestMethod": "GET",
																"paginationRules": {
																	"supportRFC5988": "true",
																	"QueryParameters.$start": "$.next_result",
																	"EndCondition:$.has_more": "Const:false"
																}
															},
															"sink": {
																"type": "JsonSink",
																"storeSettings": {
																	"type": "AzureBlobFSWriteSettings"
																},
																"formatSettings": {
																	"type": "JsonWriteSettings"
																}
															},
															"enableStaging": false
														},
														"inputs": [
															{
																"referenceName": "RestResource_WastedgeAPI_WSGNSW",
																"type": "DatasetReference",
																"parameters": {
																	"restRelativeUrl": {
																		"value": "@variables('varApiInstance')",
																		"type": "Expression"
																	}
																}
															}
														],
														"outputs": [
															{
																"referenceName": "DataLake_Wastedge",
																"type": "DatasetReference",
																"parameters": {
																	"pFileSystem": {
																		"value": "@variables('varDataLake_FileSystem')",
																		"type": "Expression"
																	},
																	"pDirectory": {
																		"value": "@variables('varDataLake_Diretory')",
																		"type": "Expression"
																	},
																	"pFileName": {
																		"value": "@variables('varDataLake_FileName')",
																		"type": "Expression"
																	}
																}
															}
														]
													}
												]
											},
											{
												"value": "wsgvic",
												"activities": [
													{
														"name": "Download Data - WSGVIC",
														"type": "Copy",
														"dependsOn": [],
														"policy": {
															"timeout": "0.12:00:00",
															"retry": 2,
															"retryIntervalInSeconds": 30,
															"secureOutput": false,
															"secureInput": false
														},
														"userProperties": [],
														"typeProperties": {
															"source": {
																"type": "RestSource",
																"httpRequestTimeout": "00:01:40",
																"requestInterval": "00.00:00:00.010",
																"requestMethod": "GET",
																"paginationRules": {
																	"supportRFC5988": "true",
																	"QueryParameters.$start": "$.next_result",
																	"EndCondition:$.has_more": "Const:false"
																}
															},
															"sink": {
																"type": "JsonSink",
																"storeSettings": {
																	"type": "AzureBlobFSWriteSettings"
																},
																"formatSettings": {
																	"type": "JsonWriteSettings"
																}
															},
															"enableStaging": false
														},
														"inputs": [
															{
																"referenceName": "RestResource_WastedgeAPI_WSGVIC",
																"type": "DatasetReference",
																"parameters": {
																	"restRelativeUrl": {
																		"value": "@variables('varRestRelativeUrl')",
																		"type": "Expression"
																	}
																}
															}
														],
														"outputs": [
															{
																"referenceName": "DataLake_Wastedge",
																"type": "DatasetReference",
																"parameters": {
																	"pFileSystem": {
																		"value": "@variables('varDataLake_FileSystem')",
																		"type": "Expression"
																	},
																	"pDirectory": {
																		"value": "@variables('varDataLake_Diretory')",
																		"type": "Expression"
																	},
																	"pFileName": {
																		"value": "@variables('varDataLake_FileName')",
																		"type": "Expression"
																	}
																}
															}
														]
													}
												]
											}
										]
									}
								},
								{
									"name": "Set DataLake FileName",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set API Object Name",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "varDataLake_FileName",
										"value": {
											"value": "@concat(variables('varApiObjectName'), '-', pipeline().parameters.Instance, '-', variables('varDataLake_FileNameSubfix'))",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set DataLake Directory",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set API Object Name",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "varDataLake_Diretory",
										"value": {
											"value": "@concat(split(item(), '.')[0], '/', variables('varApiObjectName'), '-', pipeline().parameters.Instance)",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Copy Data to Database",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Set CopyDataToDB - Sink TableName",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Set Debug - PreCopyScript",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"additionalColumns": [
												{
													"name": "etlRefreshTimestampUTC",
													"value": {
														"value": "@utcnow()",
														"type": "Expression"
													}
												}
											],
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": false,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"preCopyScript": {
												"value": "@{concat('EXECUTE ', variables('varSqlDbSink_SchemaName'), '.[Generic_CopyData_PreCopyScript] ', ' @paramObjectName=''', variables('varApiInstance'), ''' ', ' , @paramRefreshDataDate=''', variables('varStartDate'), ''' ')}",
												"type": "Expression"
											},
											"writeBehavior": {
												"value": "@string(json(string(activity('Lookup Configuration File').output)).value[0].sink.writeBehavior)",
												"type": "Expression"
											},
											"sqlWriterUseTableLock": true,
											"upsertSettings": {
												"useTempDB": true,
												"keys": {
													"value": "@json(string(activity('Lookup Configuration File').output)).value[0].sink.upsertSettings.keys",
													"type": "Expression"
												}
											},
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"parallelCopies": 4,
										"translator": {
											"value": "@json(string(activity('Lookup Configuration File').output)).value[0].translator",
											"type": "Expression"
										}
									},
									"inputs": [
										{
											"referenceName": "DataLake_Wastedge",
											"type": "DatasetReference",
											"parameters": {
												"pFileSystem": {
													"value": "@variables('varDataLake_FileSystem')",
													"type": "Expression"
												},
												"pDirectory": {
													"value": "@variables('varDataLake_Diretory')",
													"type": "Expression"
												},
												"pFileName": {
													"value": "@variables('varDataLake_FileName')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "AzureSqlTable1",
											"type": "DatasetReference",
											"parameters": {
												"TableName": {
													"value": "@variables('varSqlDbSink_TableName')",
													"type": "Expression"
												},
												"SchemaName": {
													"value": "@variables('varSqlDbSink_SchemaName')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Set CopyDataToDB - Sink TableName",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Lookup Configuration File",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "varSqlDbSink_TableName",
										"value": {
											"value": "@string(json(string(activity('Lookup Configuration File').output)).value[0].outputs[0].parameters.TableName.value)",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Lookup Configuration File",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "Switch Instance - Download Wastedge Data",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": false,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"dataset": {
											"referenceName": "DataLake_Wastedge",
											"type": "DatasetReference",
											"parameters": {
												"pFileSystem": {
													"value": "@variables('varConfigFile_CopyDataToDb_FileSystem')",
													"type": "Expression"
												},
												"pDirectory": {
													"value": "@concat(variables('varConfigFile_CopyDataToDb_Directory'), '/', split(variables('varApiInstance'), '/')[0], '')",
													"type": "Expression"
												},
												"pFileName": {
													"value": "@concat('config-', variables('varApiObjectName'), '-', pipeline().parameters.Instance, '.json')",
													"type": "Expression"
												}
											}
										},
										"firstRowOnly": false
									}
								},
								{
									"name": "Set CopyDataToDB - Sink SchemaName",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Lookup Configuration File",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "varSqlDbSink_SchemaName",
										"value": {
											"value": "@toLower(pipeline().parameters.Instance)",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set Debug - PreCopyScript",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set CopyDataToDB - Sink SchemaName",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "debugMsg",
										"value": {
											"value": "@concat('EXECUTE ', variables('varSqlDbSink_SchemaName'), '.[Generic_CopyData_PreCopyScript] ', ' @paramObjectName=''', variables('varApiInstance'), ''' ', ' , @paramRefreshDataDate=''', variables('varStartDate'), ''' ')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set API Object Name",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set Api Instance",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "varApiObjectName",
										"value": {
											"value": "@split(split(item(), '/')[1], '?')[0]",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "If Refresh Data by Update Timestamp",
						"type": "IfCondition",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@lessOrEquals(pipeline().parameters.RefreshDataDayOffset, 0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Set Start Date As Current Date",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "varStartDate",
										"value": {
											"value": "@formatDateTime(convertTimeZone(pipeline().TriggerTime, 'UTC', pipeline().globalParameters.gparmSystemTimezone), 'yyyy-MM-dd')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set File Name Subfix As Current DateTime",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set Start Date As Current Date",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Set End Date As Current Date",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "varDataLake_FileNameSubfix",
										"value": {
											"value": "@concat(replace(variables('varEndDate'), ':', ''), '')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set End Date As Current Date",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "varEndDate",
										"value": {
											"value": "@formatDateTime(convertTimeZone(pipeline().TriggerTime, 'UTC', pipeline().globalParameters.gparmSystemTimezone) , 'yyyy-MM-ddTHH:mm:00')",
											"type": "Expression"
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Set Start Date",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "varStartDate",
										"value": {
											"value": "@formatDateTime(addDays(convertTimeZone(pipeline().TriggerTime, 'UTC', pipeline().globalParameters.gparmSystemTimezone), pipeline().parameters.RefreshDataDayOffset), 'yyyy-MM-dd')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set File Name Subfix",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set Start Date",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Set End Date",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "varDataLake_FileNameSubfix",
										"value": {
											"value": "@concat(variables('varStartDate'), '_', replace(variables('varEndDate'), ':', ''))",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set End Date",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "varEndDate",
										"value": {
											"value": "@formatDateTime(convertTimeZone(pipeline().TriggerTime, 'UTC', pipeline().globalParameters.gparmSystemTimezone) , 'yyyy-MM-ddTHH:mm:00')",
											"type": "Expression"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"RefreshDataDayOffset": {
						"type": "int",
						"defaultValue": 0
					},
					"Instance": {
						"type": "string",
						"defaultValue": "wsgvic"
					},
					"ApiEntities": {
						"type": "array",
						"defaultValue": [
							"customer.customer/customer",
							"booking.booking/booking",
							"routetipfee.vehicle/route_tip_fee",
							"tipfee.vehicle/tip_fee",
							"servicecustomprice.customer/service_custom_price",
							"scheduledservice.customer/scheduled_service",
							"routesummary.vehicle/route_summary",
							"service.customer/service"
						]
					}
				},
				"variables": {
					"varStartDate": {
						"type": "String"
					},
					"varApiInstance": {
						"type": "String"
					},
					"debugMsg": {
						"type": "String"
					},
					"varRestRelativeUrl": {
						"type": "String"
					},
					"varDataLake_FileName": {
						"type": "String"
					},
					"varDataLake_FileSystem": {
						"type": "String",
						"defaultValue": "sara-full-refresh"
					},
					"varDataLake_Diretory": {
						"type": "String"
					},
					"varDataLake_FileNameSubfix": {
						"type": "String"
					},
					"varSqlDbSink_WriteBehavior": {
						"type": "String"
					},
					"varSqlDbSink_Translator": {
						"type": "String"
					},
					"varSqlDbSink_UpsertSettings": {
						"type": "String"
					},
					"varSqlDbSink_TableName": {
						"type": "String"
					},
					"varSqlDbSink_SchemaName": {
						"type": "String"
					},
					"varConfigFile_CopyDataToDb_FileSystem": {
						"type": "String",
						"defaultValue": "adf-configurations"
					},
					"varConfigFile_CopyDataToDb_Directory": {
						"type": "String",
						"defaultValue": "wastedge-pipeline-copy-data-sink-mappings"
					},
					"varEndDate": {
						"type": "String"
					},
					"varApiObjectName": {
						"type": "String"
					}
				},
				"folder": {
					"name": "SaraHe"
				},
				"annotations": [],
				"lastPublishTime": "2024-03-24T23:53:21Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/DataLake_Wastedge')]",
				"[concat(variables('factoryId'), '/datasets/AzureSqlTable1')]",
				"[concat(variables('factoryId'), '/datasets/RestResource_WastedgeAPI_WFLEX')]",
				"[concat(variables('factoryId'), '/datasets/RestResource_WastedgeAPI_WSGNSW')]",
				"[concat(variables('factoryId'), '/datasets/RestResource_WastedgeAPI_WSGVIC')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_booking')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy booking to DataLake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set StartDate",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set End Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Debug",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI_Date",
								"type": "DatasetReference",
								"parameters": {
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "booking/booking",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "booking",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "booking",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy booking to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"id"
									]
								},
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['add_chg_changed']"
										},
										"sink": {
											"name": "add_chg_changed",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['admin_status']"
										},
										"sink": {
											"name": "admin_status",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['alt_ref_1']"
										},
										"sink": {
											"name": "alt_ref_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['alt_ref_2']"
										},
										"sink": {
											"name": "alt_ref_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['alt_ref_serv_1']"
										},
										"sink": {
											"name": "alt_ref_serv_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['alt_ref_serv_2']"
										},
										"sink": {
											"name": "alt_ref_serv_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['application_id']"
										},
										"sink": {
											"name": "application_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_address_1']"
										},
										"sink": {
											"name": "bill_address_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_address_2']"
										},
										"sink": {
											"name": "bill_address_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_city']"
										},
										"sink": {
											"name": "bill_city",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_name']"
										},
										"sink": {
											"name": "bill_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_property_name']"
										},
										"sink": {
											"name": "bill_property_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_state']"
										},
										"sink": {
											"name": "bill_state",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_to_swt']"
										},
										"sink": {
											"name": "bill_to_swt",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_zip']"
										},
										"sink": {
											"name": "bill_zip",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bin_attributes']"
										},
										"sink": {
											"name": "bin_attributes",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bins_collected']"
										},
										"sink": {
											"name": "bins_collected",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['booking_custom_price']"
										},
										"sink": {
											"name": "booking_custom_price",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['booking_id']"
										},
										"sink": {
											"name": "booking_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['booking_update_flag']"
										},
										"sink": {
											"name": "booking_update_flag",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['chargeable']"
										},
										"sink": {
											"name": "chargeable",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['cont_id']"
										},
										"sink": {
											"name": "cont_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['container_id']"
										},
										"sink": {
											"name": "container_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['container_size']"
										},
										"sink": {
											"name": "container_size",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['container_type']"
										},
										"sink": {
											"name": "container_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['container_weight']"
										},
										"sink": {
											"name": "container_weight",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['containers']"
										},
										"sink": {
											"name": "containers",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['coord_date']"
										},
										"sink": {
											"name": "coord_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['coord_time']"
										},
										"sink": {
											"name": "coord_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['coord_type']"
										},
										"sink": {
											"name": "coord_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['create_timestamp']"
										},
										"sink": {
											"name": "create_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['create_user_id']"
										},
										"sink": {
											"name": "create_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency_code']"
										},
										"sink": {
											"name": "currency_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cust_cust_ref']"
										},
										"sink": {
											"name": "cust_cust_ref",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['customer']"
										},
										"sink": {
											"name": "customer",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['customer_class']"
										},
										"sink": {
											"name": "customer_class",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['customer_service_line_no']"
										},
										"sink": {
											"name": "customer_service_line_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['default_weight']"
										},
										"sink": {
											"name": "default_weight",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['delivery_serial_no']"
										},
										"sink": {
											"name": "delivery_serial_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['delivery_site_number']"
										},
										"sink": {
											"name": "delivery_site_number",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['delivery_site_type']"
										},
										"sink": {
											"name": "delivery_site_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Department']"
										},
										"sink": {
											"name": "Department",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['destruction_batch_no']"
										},
										"sink": {
											"name": "destruction_batch_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['destruction_certificate_required']"
										},
										"sink": {
											"name": "destruction_certificate_required",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type']"
										},
										"sink": {
											"name": "disposal_charge_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_incl_charge']"
										},
										"sink": {
											"name": "disposal_incl_charge",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['disposal_ticket']"
										},
										"sink": {
											"name": "disposal_ticket",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['driver']"
										},
										"sink": {
											"name": "driver",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['driver_comments']"
										},
										"sink": {
											"name": "driver_comments",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['driver_docket_no']"
										},
										"sink": {
											"name": "driver_docket_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['driver_seq_no']"
										},
										"sink": {
											"name": "driver_seq_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['eba_codes']"
										},
										"sink": {
											"name": "eba_codes",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['email_address']"
										},
										"sink": {
											"name": "email_address",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Exported']"
										},
										"sink": {
											"name": "Exported",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['fax_no']"
										},
										"sink": {
											"name": "fax_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['geocode_x']"
										},
										"sink": {
											"name": "geocode_x",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['geocode_y']"
										},
										"sink": {
											"name": "geocode_y",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['GetLastestPrice']"
										},
										"sink": {
											"name": "GetLastestPrice",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['HasAttachment']"
										},
										"sink": {
											"name": "HasAttachment",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['invoice_no']"
										},
										"sink": {
											"name": "invoice_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['InvoiceDescription']"
										},
										"sink": {
											"name": "InvoiceDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['job_end_time']"
										},
										"sink": {
											"name": "job_end_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['job_hours']"
										},
										"sink": {
											"name": "job_hours",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['job_serviced_date']"
										},
										"sink": {
											"name": "job_serviced_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['job_start_time']"
										},
										"sink": {
											"name": "job_start_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jrl_no']"
										},
										"sink": {
											"name": "jrl_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['ledger_account']"
										},
										"sink": {
											"name": "ledger_account",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['linked_trans_no']"
										},
										"sink": {
											"name": "linked_trans_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['linked_trans_seq_no']"
										},
										"sink": {
											"name": "linked_trans_seq_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['map_reference']"
										},
										"sink": {
											"name": "map_reference",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mdt_cash_payment']"
										},
										"sink": {
											"name": "mdt_cash_payment",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['meters_collected']"
										},
										"sink": {
											"name": "meters_collected",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['multi_total_price']"
										},
										"sink": {
											"name": "multi_total_price",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['multi_total_price_ex_tax']"
										},
										"sink": {
											"name": "multi_total_price_ex_tax",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['multi_total_tax']"
										},
										"sink": {
											"name": "multi_total_tax",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['OldServType']"
										},
										"sink": {
											"name": "OldServType",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['open_flag']"
										},
										"sink": {
											"name": "open_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['order_no']"
										},
										"sink": {
											"name": "order_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['org']"
										},
										"sink": {
											"name": "org",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['p_year']"
										},
										"sink": {
											"name": "p_year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['paid']"
										},
										"sink": {
											"name": "paid",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['period']"
										},
										"sink": {
											"name": "period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['phone_2']"
										},
										"sink": {
											"name": "phone_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['PlannedEndTime']"
										},
										"sink": {
											"name": "PlannedEndTime",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['PlannedStartTime']"
										},
										"sink": {
											"name": "PlannedStartTime",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['po_no']"
										},
										"sink": {
											"name": "po_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['prev_trans_status']"
										},
										"sink": {
											"name": "prev_trans_status",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['price_line_no']"
										},
										"sink": {
											"name": "price_line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['price_rate']"
										},
										"sink": {
											"name": "price_rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Priority']"
										},
										"sink": {
											"name": "Priority",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['ProfitCentre']"
										},
										"sink": {
											"name": "ProfitCentre",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['prorated_tip_cost']"
										},
										"sink": {
											"name": "prorated_tip_cost",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['rcti_batch']"
										},
										"sink": {
											"name": "rcti_batch",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['rcti_no']"
										},
										"sink": {
											"name": "rcti_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reason_code']"
										},
										"sink": {
											"name": "reason_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['removal_serial_no']"
										},
										"sink": {
											"name": "removal_serial_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['removal_site_number']"
										},
										"sink": {
											"name": "removal_site_number",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['removal_site_type']"
										},
										"sink": {
											"name": "removal_site_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_directions_1']"
										},
										"sink": {
											"name": "route_directions_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_directions_2']"
										},
										"sink": {
											"name": "route_directions_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_directions_3']"
										},
										"sink": {
											"name": "route_directions_3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_directions_4']"
										},
										"sink": {
											"name": "route_directions_4",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_no']"
										},
										"sink": {
											"name": "route_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['run_gen_batch']"
										},
										"sink": {
											"name": "run_gen_batch",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['SendTipFeeAttachments']"
										},
										"sink": {
											"name": "SendTipFeeAttachments",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['sent_flag']"
										},
										"sink": {
											"name": "sent_flag",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_addr_1']"
										},
										"sink": {
											"name": "serv_addr_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_addr_2']"
										},
										"sink": {
											"name": "serv_addr_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_city']"
										},
										"sink": {
											"name": "serv_city",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_code']"
										},
										"sink": {
											"name": "serv_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_contact']"
										},
										"sink": {
											"name": "serv_contact",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_country']"
										},
										"sink": {
											"name": "serv_country",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_desc_1']"
										},
										"sink": {
											"name": "serv_desc_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_desc_2']"
										},
										"sink": {
											"name": "serv_desc_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_desc_3']"
										},
										"sink": {
											"name": "serv_desc_3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_desc_4']"
										},
										"sink": {
											"name": "serv_desc_4",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_name']"
										},
										"sink": {
											"name": "serv_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_no']"
										},
										"sink": {
											"name": "serv_no",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['serv_phone']"
										},
										"sink": {
											"name": "serv_phone",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_property_name']"
										},
										"sink": {
											"name": "serv_property_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_state']"
										},
										"sink": {
											"name": "serv_state",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_time_code']"
										},
										"sink": {
											"name": "serv_time_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_type']"
										},
										"sink": {
											"name": "serv_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_zip']"
										},
										"sink": {
											"name": "serv_zip",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['service_line_no']"
										},
										"sink": {
											"name": "service_line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['site_number']"
										},
										"sink": {
											"name": "site_number",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['status']"
										},
										"sink": {
											"name": "status",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['temp_code']"
										},
										"sink": {
											"name": "temp_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['TempLedgerAccount']"
										},
										"sink": {
											"name": "TempLedgerAccount",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ticket_required']"
										},
										"sink": {
											"name": "ticket_required",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['tip_fee']"
										},
										"sink": {
											"name": "tip_fee",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total_price']"
										},
										"sink": {
											"name": "total_price",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['total_price_ex_tax']"
										},
										"sink": {
											"name": "total_price_ex_tax",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['trans_date']"
										},
										"sink": {
											"name": "trans_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['trans_entry_date']"
										},
										"sink": {
											"name": "trans_entry_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['trans_entry_id']"
										},
										"sink": {
											"name": "trans_entry_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['trans_entry_time']"
										},
										"sink": {
											"name": "trans_entry_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['trans_no']"
										},
										"sink": {
											"name": "trans_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['trans_seq_no']"
										},
										"sink": {
											"name": "trans_seq_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['trans_update_date']"
										},
										"sink": {
											"name": "trans_update_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['trans_update_id']"
										},
										"sink": {
											"name": "trans_update_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['trans_update_time']"
										},
										"sink": {
											"name": "trans_update_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['truck_no']"
										},
										"sink": {
											"name": "truck_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['update_user_id']"
										},
										"sink": {
											"name": "update_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['updated']"
										},
										"sink": {
											"name": "updated",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['UpdateProgram']"
										},
										"sink": {
											"name": "UpdateProgram",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['usePriceCode']"
										},
										"sink": {
											"name": "usePriceCode",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['user_id']"
										},
										"sink": {
											"name": "user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['vehicle_class']"
										},
										"sink": {
											"name": "vehicle_class",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['waste_type']"
										},
										"sink": {
											"name": "waste_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['WasteOutcome']"
										},
										"sink": {
											"name": "WasteOutcome",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['we_equip_codes']"
										},
										"sink": {
											"name": "we_equip_codes",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['we_helpers']"
										},
										"sink": {
											"name": "we_helpers",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['we_price']"
										},
										"sink": {
											"name": "we_price",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['we_price_code']"
										},
										"sink": {
											"name": "we_price_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['we_price_discount_label']"
										},
										"sink": {
											"name": "we_price_discount_label",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['we_tax']"
										},
										"sink": {
											"name": "we_tax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['zone_no']"
										},
										"sink": {
											"name": "zone_no",
											"type": "Int32"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "booking",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "booking",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "booking_wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Set StartDate",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "StartDate",
							"value": {
								"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set End Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "EndDate",
							"value": {
								"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'YYYY-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Debug",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "Debug",
							"value": {
								"value": "@concat('booking/booking$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"StartDate": {
						"type": "String"
					},
					"EndDate": {
						"type": "String"
					},
					"Debug": {
						"type": "String"
					}
				},
				"folder": {
					"name": "customer"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_invoice_batch2')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set period",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "Period",
							"value": {
								"value": "@pipeline().parameters.Period",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Debug",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "DEBUG",
							"value": {
								"value": "@concat('invoicing/invoice_batch?$query=period=','''',pipeline().parameters.Period,'''','and p_year=','''',pipeline().parameters.P_year,'''')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set period",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Debug",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "Period_Query",
								"type": "DatasetReference",
								"parameters": {
									"Period": {
										"value": "@pipeline().parameters.Period",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "invoicing/invoice_batch",
										"type": "Expression"
									},
									"P_year": {
										"value": "@pipeline().parameters.P_year",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@concat('period-',pipeline().parameters.Period,' Year=',pipeline().parameters.P_year)",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "invoicebatch",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "invoice_batch",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgnsw",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"U_ID"
									]
								},
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"parallelCopies": 4,
							"enableSkipIncompatibleRow": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "U_ID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['BatchComplete']"
										},
										"sink": {
											"name": "BatchComplete",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['BatchStamp']"
										},
										"sink": {
											"name": "BatchStamp",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['BatchStatus']"
										},
										"sink": {
											"name": "BatchStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['BillingFrom']"
										},
										"sink": {
											"name": "BillingFrom",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['BillingTo']"
										},
										"sink": {
											"name": "BillingTo",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['CustomerTypes']"
										},
										"sink": {
											"name": "CustomerTypes",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['DateCreated']"
										},
										"sink": {
											"name": "DateCreated",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['DateFrom']"
										},
										"sink": {
											"name": "DateFrom",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['DateInvoiced']"
										},
										"sink": {
											"name": "DateInvoiced",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['DateTo']"
										},
										"sink": {
											"name": "DateTo",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['Description']"
										},
										"sink": {
											"name": "Description",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['EmpID']"
										},
										"sink": {
											"name": "EmpID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Exported']"
										},
										"sink": {
											"name": "Exported",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['ExportedDate']"
										},
										"sink": {
											"name": "ExportedDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['ExportedResult']"
										},
										"sink": {
											"name": "ExportedResult",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ExportedTime']"
										},
										"sink": {
											"name": "ExportedTime",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Instructions']"
										},
										"sink": {
											"name": "Instructions",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['InvoiceCycles']"
										},
										"sink": {
											"name": "InvoiceCycles",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jrl_no']"
										},
										"sink": {
											"name": "jrl_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['p_year']"
										},
										"sink": {
											"name": "p_year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Params']"
										},
										"sink": {
											"name": "Params",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['period']"
										},
										"sink": {
											"name": "period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Summary']"
										},
										"sink": {
											"name": "Summary",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['TimeCreated']"
										},
										"sink": {
											"name": "TimeCreated",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['TotalInvoiced']"
										},
										"sink": {
											"name": "TotalInvoiced",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['TotalInvoices']"
										},
										"sink": {
											"name": "TotalInvoices",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@concat('period-',pipeline().parameters.Period,' Year=',pipeline().parameters.P_year)",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "invoicebatch",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "invoice_batch",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgnsw",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "invoice_batch_wsgnsw",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Period": {
						"type": "string"
					},
					"P_year": {
						"type": "string"
					}
				},
				"variables": {
					"DEBUG": {
						"type": "String"
					},
					"Period": {
						"type": "String"
					}
				},
				"folder": {
					"name": "Invoice"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Period_Query')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_scheduled_service')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set StartDate",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set End Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Debug",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI_Date",
								"type": "DatasetReference",
								"parameters": {
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "customer/scheduled_service",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "scheduledservice",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "scheduled_service",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "delete from scheduled_service_wsgvic",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Active']"
										},
										"sink": {
											"name": "Active",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['cont_number']"
										},
										"sink": {
											"name": "cont_number",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['create_timestamp']"
										},
										"sink": {
											"name": "create_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['create_user_id']"
										},
										"sink": {
											"name": "create_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['customer']"
										},
										"sink": {
											"name": "customer",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['display_order']"
										},
										"sink": {
											"name": "display_order",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['EndDate']"
										},
										"sink": {
											"name": "EndDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['ending_house']"
										},
										"sink": {
											"name": "ending_house",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['expected_metres']"
										},
										"sink": {
											"name": "expected_metres",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['first_service_date']"
										},
										"sink": {
											"name": "first_service_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['last_mdt_seq']"
										},
										"sink": {
											"name": "last_mdt_seq",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['line_no']"
										},
										"sink": {
											"name": "line_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['line_type']"
										},
										"sink": {
											"name": "line_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['navigation']"
										},
										"sink": {
											"name": "navigation",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['next_service_date']"
										},
										"sink": {
											"name": "next_service_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['route_line']"
										},
										"sink": {
											"name": "route_line",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['route_msg']"
										},
										"sink": {
											"name": "route_msg",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_no']"
										},
										"sink": {
											"name": "route_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['schedule_no']"
										},
										"sink": {
											"name": "schedule_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['section']"
										},
										"sink": {
											"name": "section",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['segment_length']"
										},
										"sink": {
											"name": "segment_length",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['shift_no']"
										},
										"sink": {
											"name": "shift_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['StartDate']"
										},
										"sink": {
											"name": "StartDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['street_code']"
										},
										"sink": {
											"name": "street_code",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['update_user_id']"
										},
										"sink": {
											"name": "update_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UpdateProgram']"
										},
										"sink": {
											"name": "UpdateProgram",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "scheduledservice",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "scheduled_service",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "scheduled_service_wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Set StartDate",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "StartDate",
							"value": {
								"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set End Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "EndDate",
							"value": {
								"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'YYYY-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Debug",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "Debug",
							"value": {
								"value": "@concat('customer/scheduled_service$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"StartDate": {
						"type": "String"
					},
					"EndDate": {
						"type": "String"
					},
					"Debug": {
						"type": "String"
					}
				},
				"folder": {
					"name": "customer"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_service')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set StartDate",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set End Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Debug",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestAPI_Date",
								"type": "DatasetReference",
								"parameters": {
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									},
									"API_Instance": {
										"value": "customer/service",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "service",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "service",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['alt_ref_serv_1']"
										},
										"sink": {
											"name": "alt_ref_serv_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['alt_ref_serv_2']"
										},
										"sink": {
											"name": "alt_ref_serv_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['application_id']"
										},
										"sink": {
											"name": "application_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ApplyMinimumBookingPriceTo']"
										},
										"sink": {
											"name": "ApplyMinimumBookingPriceTo",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_cycle']"
										},
										"sink": {
											"name": "bill_cycle",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['BillingQtySwitch']"
										},
										"sink": {
											"name": "BillingQtySwitch",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['budget_lifts']"
										},
										"sink": {
											"name": "budget_lifts",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['cancel_serv_date']"
										},
										"sink": {
											"name": "cancel_serv_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['chargeable']"
										},
										"sink": {
											"name": "chargeable",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['container_type']"
										},
										"sink": {
											"name": "container_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['containers']"
										},
										"sink": {
											"name": "containers",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['contract_desc_1']"
										},
										"sink": {
											"name": "contract_desc_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['contract_desc_2']"
										},
										"sink": {
											"name": "contract_desc_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['contract_desc_3']"
										},
										"sink": {
											"name": "contract_desc_3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['contract_desc_4']"
										},
										"sink": {
											"name": "contract_desc_4",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['contract_end_date']"
										},
										"sink": {
											"name": "contract_end_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['contract_no']"
										},
										"sink": {
											"name": "contract_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['contract_str_date']"
										},
										"sink": {
											"name": "contract_str_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['contractor_no']"
										},
										"sink": {
											"name": "contractor_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['create_timestamp']"
										},
										"sink": {
											"name": "create_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['create_user_id']"
										},
										"sink": {
											"name": "create_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency_code']"
										},
										"sink": {
											"name": "currency_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['customer']"
										},
										"sink": {
											"name": "customer",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['destruction_certificate_required']"
										},
										"sink": {
											"name": "destruction_certificate_required",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_desc']"
										},
										"sink": {
											"name": "disposal_charge_desc",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_desc2']"
										},
										"sink": {
											"name": "disposal_charge_desc2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_desc3']"
										},
										"sink": {
											"name": "disposal_charge_desc3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_desc_ex']"
										},
										"sink": {
											"name": "disposal_charge_desc_ex",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate']"
										},
										"sink": {
											"name": "disposal_charge_rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate2']"
										},
										"sink": {
											"name": "disposal_charge_rate2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate3']"
										},
										"sink": {
											"name": "disposal_charge_rate3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate_ex']"
										},
										"sink": {
											"name": "disposal_charge_rate_ex",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate_ex2']"
										},
										"sink": {
											"name": "disposal_charge_rate_ex2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_rate_ex3']"
										},
										"sink": {
											"name": "disposal_charge_rate_ex3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type']"
										},
										"sink": {
											"name": "disposal_charge_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type2']"
										},
										"sink": {
											"name": "disposal_charge_type2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type3']"
										},
										"sink": {
											"name": "disposal_charge_type3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type_ex']"
										},
										"sink": {
											"name": "disposal_charge_type_ex",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type_ex2']"
										},
										"sink": {
											"name": "disposal_charge_type_ex2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_charge_type_ex3']"
										},
										"sink": {
											"name": "disposal_charge_type_ex3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_default_weight']"
										},
										"sink": {
											"name": "disposal_default_weight",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_default_weight_max']"
										},
										"sink": {
											"name": "disposal_default_weight_max",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_default_weight_min']"
										},
										"sink": {
											"name": "disposal_default_weight_min",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_incl_charge']"
										},
										"sink": {
											"name": "disposal_incl_charge",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['Disposal_Levy1Desc']"
										},
										"sink": {
											"name": "Disposal_Levy1Desc",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Disposal_Levy1Rate']"
										},
										"sink": {
											"name": "Disposal_Levy1Rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Disposal_Levy1Type']"
										},
										"sink": {
											"name": "Disposal_Levy1Type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_site']"
										},
										"sink": {
											"name": "disposal_site",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_unit_meas']"
										},
										"sink": {
											"name": "disposal_unit_meas",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['disposal_weight_limit_ex']"
										},
										"sink": {
											"name": "disposal_weight_limit_ex",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['disposal_weight_limit_ex2']"
										},
										"sink": {
											"name": "disposal_weight_limit_ex2",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['disposal_weight_limit_ex3']"
										},
										"sink": {
											"name": "disposal_weight_limit_ex3",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Disposal_weight_min']"
										},
										"sink": {
											"name": "Disposal_weight_min",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['facility_code']"
										},
										"sink": {
											"name": "facility_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['facility_number']"
										},
										"sink": {
											"name": "facility_number",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['float_next_date']"
										},
										"sink": {
											"name": "float_next_date",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['frequency']"
										},
										"sink": {
											"name": "frequency",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['indemnification_on_file']"
										},
										"sink": {
											"name": "indemnification_on_file",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['initial_serv_date']"
										},
										"sink": {
											"name": "initial_serv_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['InvoiceDescription']"
										},
										"sink": {
											"name": "InvoiceDescription",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['last_bill_date']"
										},
										"sink": {
											"name": "last_bill_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['line_no']"
										},
										"sink": {
											"name": "line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['line_notes_1']"
										},
										"sink": {
											"name": "line_notes_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['line_notes_2']"
										},
										"sink": {
											"name": "line_notes_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['line_notes_3']"
										},
										"sink": {
											"name": "line_notes_3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['line_notes_4']"
										},
										"sink": {
											"name": "line_notes_4",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['next_bill_date']"
										},
										"sink": {
											"name": "next_bill_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['next_care_cert_due']"
										},
										"sink": {
											"name": "next_care_cert_due",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['org']"
										},
										"sink": {
											"name": "org",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['owned_flag']"
										},
										"sink": {
											"name": "owned_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['ParentService']"
										},
										"sink": {
											"name": "ParentService",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['pickup_days']"
										},
										"sink": {
											"name": "pickup_days",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['po_no']"
										},
										"sink": {
											"name": "po_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['POChain']"
										},
										"sink": {
											"name": "POChain",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['pref_serv_time']"
										},
										"sink": {
											"name": "pref_serv_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['price_increase_exempt_date']"
										},
										"sink": {
											"name": "price_increase_exempt_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['rate_exempt']"
										},
										"sink": {
											"name": "rate_exempt",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['rent_days']"
										},
										"sink": {
											"name": "rent_days",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['rent_free_days']"
										},
										"sink": {
											"name": "rent_free_days",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['repeating_loads']"
										},
										"sink": {
											"name": "repeating_loads",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['route']"
										},
										"sink": {
											"name": "route",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_collection']"
										},
										"sink": {
											"name": "route_collection",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['route_cycle']"
										},
										"sink": {
											"name": "route_cycle",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_directions_1']"
										},
										"sink": {
											"name": "route_directions_1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_directions_2']"
										},
										"sink": {
											"name": "route_directions_2",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_directions_3']"
										},
										"sink": {
											"name": "route_directions_3",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['route_directions_4']"
										},
										"sink": {
											"name": "route_directions_4",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sales_id_1']"
										},
										"sink": {
											"name": "sales_id_1",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['sch_end_time']"
										},
										"sink": {
											"name": "sch_end_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sch_start_time']"
										},
										"sink": {
											"name": "sch_start_time",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['SendTipFeeAttachments']"
										},
										"sink": {
											"name": "SendTipFeeAttachments",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['serv_code']"
										},
										"sink": {
											"name": "serv_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['serv_type']"
										},
										"sink": {
											"name": "serv_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['SharedService']"
										},
										"sink": {
											"name": "SharedService",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['site_location_ref_no']"
										},
										"sink": {
											"name": "site_location_ref_no",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['subcontractor_line_no']"
										},
										"sink": {
											"name": "subcontractor_line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['temp_code']"
										},
										"sink": {
											"name": "temp_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ticket_required']"
										},
										"sink": {
											"name": "ticket_required",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['Time_at_site']"
										},
										"sink": {
											"name": "Time_at_site",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['update_user_id']"
										},
										"sink": {
											"name": "update_user_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UpdateProgram']"
										},
										"sink": {
											"name": "UpdateProgram",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UseForAllSites']"
										},
										"sink": {
											"name": "UseForAllSites",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['UsePOChain']"
										},
										"sink": {
											"name": "UsePOChain",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['waste_type']"
										},
										"sink": {
											"name": "waste_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['we_price_code']"
										},
										"sink": {
											"name": "we_price_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['WeightLimitSwitch']"
										},
										"sink": {
											"name": "WeightLimitSwitch",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "service",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "service",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "service_wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Set StartDate",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "StartDate",
							"value": {
								"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set End Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "EndDate",
							"value": {
								"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'YYYY-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Debug",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "Debug",
							"value": {
								"value": "@concat('customer/service$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"StartDate": {
						"type": "String"
					},
					"EndDate": {
						"type": "String"
					},
					"Debug": {
						"type": "String"
					}
				},
				"folder": {
					"name": "customer"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/RestAPI_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_service_additional_charge')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_Service_Additional_Charge",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@formatDateTime(utcNow(),'yyyy-MM-dd')",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "serviceaddcharge",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "service_additional_charge",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "delete from service_additional_charge_wsgvic",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": true,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ChargeType']"
										},
										"sink": {
											"name": "ChargeType",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Condense']"
										},
										"sink": {
											"name": "Condense",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['cust_number']"
										},
										"sink": {
											"name": "cust_number",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['DateFrom']"
										},
										"sink": {
											"name": "DateFrom",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['DateTo']"
										},
										"sink": {
											"name": "DateTo",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['DefaultQty']"
										},
										"sink": {
											"name": "DefaultQty",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Description']"
										},
										"sink": {
											"name": "Description",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['displayOrder']"
										},
										"sink": {
											"name": "displayOrder",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['import_id_old']"
										},
										"sink": {
											"name": "import_id_old",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['ledger_account']"
										},
										"sink": {
											"name": "ledger_account",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['line_no']"
										},
										"sink": {
											"name": "line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['Linked_Charge_Condense']"
										},
										"sink": {
											"name": "Linked_Charge_Condense",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['Linked_Charge_Default_Quantity']"
										},
										"sink": {
											"name": "Linked_Charge_Default_Quantity",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Linked_Charge_Description']"
										},
										"sink": {
											"name": "Linked_Charge_Description",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Linked_Charge_Name']"
										},
										"sink": {
											"name": "Linked_Charge_Name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Linked_Charge_Price']"
										},
										"sink": {
											"name": "Linked_Charge_Price",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Linked_Charge_Price_Type']"
										},
										"sink": {
											"name": "Linked_Charge_Price_Type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Linked_Charge_Rate']"
										},
										"sink": {
											"name": "Linked_Charge_Rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Linked_Charge_Tax']"
										},
										"sink": {
											"name": "Linked_Charge_Tax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Linked_Charge_UOM']"
										},
										"sink": {
											"name": "Linked_Charge_UOM",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Name']"
										},
										"sink": {
											"name": "Name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Price']"
										},
										"sink": {
											"name": "Price",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Price_code']"
										},
										"sink": {
											"name": "Price_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['price_line_no']"
										},
										"sink": {
											"name": "price_line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['price_type']"
										},
										"sink": {
											"name": "price_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Rate']"
										},
										"sink": {
											"name": "Rate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Table_name']"
										},
										"sink": {
											"name": "Table_name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Tax']"
										},
										"sink": {
											"name": "Tax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['UOM']"
										},
										"sink": {
											"name": "UOM",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UpdateProgram']"
										},
										"sink": {
											"name": "UpdateProgram",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UpdateUserID']"
										},
										"sink": {
											"name": "UpdateUserID",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "serviceaddcharge",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "service_additional_charge",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgvic",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "service_additional_charge_wsgvic",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "customer"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/DS_Service_Additional_Charge')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_service_custom_price')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy route to DataLake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set StartDate",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set End Date",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Debug",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true",
									"EndCondition:$.has_more": "Const:false",
									"QueryParameters.$start": "$.next_result"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "WSGNSW_Date",
								"type": "DatasetReference",
								"parameters": {
									"API_Instance": {
										"value": "customer/service_custom_price",
										"type": "Expression"
									},
									"pStartDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"pEndDate": {
										"value": "@pipeline().parameters.pEndDate",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "servicecustomprice",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "service_custom_price",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgnsw",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Service Custom Price to DB",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy route to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "upsert",
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"id"
									]
								},
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['$id']"
										},
										"sink": {
											"name": "id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['bill_cycle']"
										},
										"sink": {
											"name": "bill_cycle",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Code']"
										},
										"sink": {
											"name": "Code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['create_timestamp']"
										},
										"sink": {
											"name": "create_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['CreateUserID']"
										},
										"sink": {
											"name": "CreateUserID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['cust_number']"
										},
										"sink": {
											"name": "cust_number",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['Department']"
										},
										"sink": {
											"name": "Department",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Description']"
										},
										"sink": {
											"name": "Description",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['import_id']"
										},
										"sink": {
											"name": "import_id",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['last_bill_date']"
										},
										"sink": {
											"name": "last_bill_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['LastInvoiceDate']"
										},
										"sink": {
											"name": "LastInvoiceDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['ledger_account']"
										},
										"sink": {
											"name": "ledger_account",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Line_no']"
										},
										"sink": {
											"name": "Line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['MaxContainers']"
										},
										"sink": {
											"name": "MaxContainers",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['MinContainers']"
										},
										"sink": {
											"name": "MinContainers",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['next_bill_date']"
										},
										"sink": {
											"name": "next_bill_date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['NextInvoiceDate']"
										},
										"sink": {
											"name": "NextInvoiceDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['org']"
										},
										"sink": {
											"name": "org",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['Price']"
										},
										"sink": {
											"name": "Price",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['price_type']"
										},
										"sink": {
											"name": "price_type",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['PricePer']"
										},
										"sink": {
											"name": "PricePer",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['PriceSource']"
										},
										"sink": {
											"name": "PriceSource",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['ProfitCentre']"
										},
										"sink": {
											"name": "ProfitCentre",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['service_line_no']"
										},
										"sink": {
											"name": "service_line_no",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['Tax']"
										},
										"sink": {
											"name": "Tax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['update_timestamp']"
										},
										"sink": {
											"name": "update_timestamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['UpdateProgram']"
										},
										"sink": {
											"name": "UpdateProgram",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['UpdateUserID']"
										},
										"sink": {
											"name": "UpdateUserID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['useCustomPrice']"
										},
										"sink": {
											"name": "useCustomPrice",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['we_c_pricline_cust_F6CHAR']"
										},
										"sink": {
											"name": "we_c_pricline_cust_F6CHAR",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['we_c_pricline_cust_F6DATE']"
										},
										"sink": {
											"name": "we_c_pricline_cust_F6DATE",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "[['we_c_pricline_cust_F6INT']"
										},
										"sink": {
											"name": "we_c_pricline_cust_F6INT",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['we_c_pricline_cust_F6LOG']"
										},
										"sink": {
											"name": "we_c_pricline_cust_F6LOG",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "[['we_c_pricline_cust_F8DEC']"
										},
										"sink": {
											"name": "we_c_pricline_cust_F8DEC",
											"type": "Decimal"
										}
									}
								],
								"collectionReference": "$['result']"
							}
						},
						"inputs": [
							{
								"referenceName": "DataLake",
								"type": "DatasetReference",
								"parameters": {
									"EffectiveDate": {
										"value": "@pipeline().parameters.pStartDate",
										"type": "Expression"
									},
									"ContainerName": {
										"value": "servicecustomprice",
										"type": "Expression"
									},
									"DatasetName": {
										"value": "service_custom_price",
										"type": "Expression"
									},
									"Instance": {
										"value": "wsgnsw",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DBTable",
								"type": "DatasetReference",
								"parameters": {
									"TableName": {
										"value": "service_custom_price_wsgnsw",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Set StartDate",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "StartDate",
							"value": {
								"value": "@formatDateTime(pipeline().parameters.pStartDate,'yyyy-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set End Date",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "EndDate",
							"value": {
								"value": "@formatDateTime(adddays(pipeline().parameters.pEndDate,2),'YYYY-MM-dd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Debug",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "Debug",
							"value": {
								"value": "@concat('customer/service_custom_price$query=update_timestamp>=','''',pipeline().parameters.pStartDate,'''','and update_timestamp<=','',pipeline().parameters.pEndDate,'')",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"variables": {
					"StartDate": {
						"type": "String"
					},
					"EndDate": {
						"type": "String"
					},
					"Debug": {
						"type": "String"
					}
				},
				"folder": {
					"name": "customer"
				},
				"annotations": [],
				"lastPublishTime": "2024-02-29T22:48:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/WSGNSW_Date')]",
				"[concat(variables('factoryId'), '/datasets/DataLake')]",
				"[concat(variables('factoryId'), '/datasets/DBTable')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"wildcardFolderPath": "I*",
									"wildcardFileName": "*",
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings",
									"skipLineCount": 1
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": true,
							"logSettings": {
								"enableCopyActivityLog": true,
								"copyActivityLogSettings": {
									"logLevel": "Warning",
									"enableReliableLogging": false
								},
								"logLocationSettings": {
									"linkedServiceName": {
										"referenceName": "gjrblob",
										"type": "LinkedServiceReference"
									},
									"path": "out"
								}
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"type": "Boolean",
											"ordinal": 1
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 1
										}
									},
									{
										"source": {
											"type": "String",
											"ordinal": 2
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 2
										}
									},
									{
										"source": {
											"type": "String",
											"ordinal": 3
										},
										"sink": {
											"type": "String",
											"physicalType": "String",
											"ordinal": 3
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DelimitedText1",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DelimitedText2",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Fail1",
						"type": "Fail",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"message": {
								"value": "@pipeline().Pipeline",
								"type": "Expression"
							},
							"errorCode": {
								"value": "@pipeline().RunId",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2023-04-27T06:42:38Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/DelimitedText1')]",
				"[concat(variables('factoryId'), '/datasets/DelimitedText2')]",
				"[concat(variables('factoryId'), '/linkedServices/gjrblob')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlTable1')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSqlDatabase1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"TableName": {
						"type": "string"
					},
					"SchemaName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().SchemaName",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabase1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DBTable')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSqlDatabase1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"TableName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "Active",
						"type": "bit"
					},
					{
						"name": "BranchList",
						"type": "nvarchar"
					},
					{
						"name": "Time_allowance",
						"type": "int",
						"precision": 10
					},
					{
						"name": "UpdateProgram",
						"type": "nvarchar"
					},
					{
						"name": "UpdateUserID",
						"type": "nvarchar"
					},
					{
						"name": "address_1",
						"type": "nvarchar"
					},
					{
						"name": "address_1_alt",
						"type": "nvarchar"
					},
					{
						"name": "address_2",
						"type": "nvarchar"
					},
					{
						"name": "address_2_alt",
						"type": "nvarchar"
					},
					{
						"name": "branch_name",
						"type": "nvarchar"
					},
					{
						"name": "city",
						"type": "nvarchar"
					},
					{
						"name": "classification",
						"type": "nvarchar"
					},
					{
						"name": "depot_list",
						"type": "nvarchar"
					},
					{
						"name": "disc_perc",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "ea_permit_number",
						"type": "nvarchar"
					},
					{
						"name": "email_address",
						"type": "nvarchar"
					},
					{
						"name": "fax_no",
						"type": "nvarchar"
					},
					{
						"name": "geocode_x",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "geocode_y",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "import_id",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ledger_account",
						"type": "nvarchar"
					},
					{
						"name": "ledger_account_RI",
						"type": "nvarchar"
					},
					{
						"name": "name",
						"type": "nvarchar"
					},
					{
						"name": "name_alt",
						"type": "nvarchar"
					},
					{
						"name": "phone",
						"type": "nvarchar"
					},
					{
						"name": "state",
						"type": "nvarchar"
					},
					{
						"name": "vendor_no",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "vendor_type",
						"type": "nvarchar"
					},
					{
						"name": "zip",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabase1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_Service_Additional_Charge')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "RestAPI",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "customer/service_additional_charge?$query=price_line_no=0",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/RestAPI')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DataLake')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"EffectiveDate": {
						"type": "string"
					},
					"ContainerName": {
						"type": "string"
					},
					"DatasetName": {
						"type": "string"
					},
					"Instance": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@concat(dataset().DataSetName,'-',dataset().EffectiveDate)",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@concat(dataset().DatasetName,'-',dataset().Instance)",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().ContainerName",
							"type": "Expression"
						}
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DataLake_Wastedge')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"pFileSystem": {
						"type": "string"
					},
					"pDirectory": {
						"type": "string"
					},
					"pFileName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().pFileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().pDirectory",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().pFileSystem",
							"type": "Expression"
						}
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DelimitedText1')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "gjrblob",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"container": "input"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"quoteChar": "\""
				},
				"schema": [
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/gjrblob')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DelimitedText2')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "gjrblob",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@concat(utcNow(),'.csv')",
							"type": "Expression"
						},
						"folderPath": "day",
						"container": "out"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"quoteChar": "\""
				},
				"schema": [
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/gjrblob')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Period_Query')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "WFLEX",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Period": {
						"type": "string"
					},
					"API_Instance": {
						"type": "string"
					},
					"P_year": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@concat(dataset().API_Instance,'?$query=period=','''',dataset().Period,'''','and p_year =','''',dataset().P_year,'''')",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/WFLEX')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Reference_Data')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ContainerName": {
						"type": "string"
					},
					"DatasetName": {
						"type": "string"
					},
					"Instance": {
						"type": "string"
					},
					"SheetName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": {
						"value": "@dataset().SheetName",
						"type": "Expression"
					},
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@concat(dataset().DatasetName,'_',dataset().Instance)",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().DatasetName",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().ContainerName",
							"type": "Expression"
						}
					},
					"firstRowAsHeader": true
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/RestAPI')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "RestAPI",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Dataset": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@dataset().Dataset",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/RestAPI')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/RestAPI_Date')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "RestAPI",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					},
					"API_Instance": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@concat(dataset().API_Instance,'?$query=update_timestamp>=','''',dataset().pStartDate,'''','and update_timestamp<=','''',dataset().pEndDate,'''')",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/RestAPI')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/RestResource_WastedgeAPI_WFLEX')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "RestService_Wastedge_WFLEX",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"restRelativeUrl": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@dataset().restRelativeUrl",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/RestService_Wastedge_WFLEX')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/RestResource_WastedgeAPI_WSGNSW')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "RestService_Wastedge_WSGNSW",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"restRelativeUrl": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@dataset().restRelativeUrl",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/RestService_Wastedge_WSGNSW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/RestResource_WastedgeAPI_WSGVIC')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "RestService_Wastedge_WSGVIC",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"restRelativeUrl": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@dataset().restRelativeUrl",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/RestService_Wastedge_WSGVIC')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/WFLEX')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "WFLEX",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Dataset": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@dataset().Dataset",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/WFLEX')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/WFLEX_date')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "WFLEX",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"API_Instance": {
						"type": "string"
					},
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@concat(dataset().API_Instance,'?$query=update_timestamp>=','''',dataset().pStartDate,'''','and update_timestamp<=','''',dataset().pEndDate,'''')",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/WFLEX')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/WSGNSW')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "WSGNSW",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Dataset": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@dataset().Dataset",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/WSGNSW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/WSGNSW_Date')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "WSGNSW",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"API_Instance": {
						"type": "string"
					},
					"pStartDate": {
						"type": "string"
					},
					"pEndDate": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@concat(dataset().API_Instance,'?$query=update_timestamp>=','''',dataset().pStartDate,'''','and update_timestamp<=','''',dataset().pEndDate,'''')",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/WSGNSW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureBlobStorage_sawsgdaidev')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"serviceEndpoint": "[parameters('AzureBlobStorage_sawsgdaidev_properties_typeProperties_serviceEndpoint')]",
					"accountKind": "StorageV2"
				},
				"connectVia": {
					"referenceName": "IR-WSG-DAI-DEV",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/IR-WSG-DAI-DEV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureDataLakeStorage1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('AzureDataLakeStorage1_properties_typeProperties_url')]"
				},
				"connectVia": {
					"referenceName": "IR-WSG-DAI-DEV",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/IR-WSG-DAI-DEV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlDatabase1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('AzureSqlDatabase1_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Customer')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('Customer_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('Customer_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('Customer_password')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/RestAPI')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('RestAPI_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('RestAPI_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('RestAPI_password')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/RestAPI_Date')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('RestAPI_Date_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('RestAPI_Date_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('RestAPI_Date_password')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/RestService_Wastedge_WFLEX')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('RestService_Wastedge_WFLEX_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('RestService_Wastedge_WFLEX_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('RestService_Wastedge_WFLEX_password')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/RestService_Wastedge_WSGNSW')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('RestService_Wastedge_WSGNSW_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('RestService_Wastedge_WSGNSW_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('RestService_Wastedge_WSGNSW_password')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/RestService_Wastedge_WSGVIC')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('RestService_Wastedge_WSGVIC_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('RestService_Wastedge_WSGVIC_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('RestService_Wastedge_WSGVIC_password')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/WFLEX')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('WFLEX_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('WFLEX_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('WFLEX_password')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/WSGNSW')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('WSGNSW_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('WSGNSW_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('WSGNSW_password')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/WSGVIC')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('WSGVIC_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('WSGVIC_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('WSGVIC_password')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/gjrblob')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('gjrblob_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/sqltest')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('sqltest_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Trigger_customer')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2023-01-10T06:09:00Z",
						"timeZone": "UTC",
						"schedule": {
							"minutes": [
								0
							]
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/trigger1')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "pipeline1",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "BlobEventsTrigger",
				"typeProperties": {
					"blobPathBeginsWith": "/input/blobs/",
					"ignoreEmptyBlobs": true,
					"scope": "[parameters('trigger1_properties_typeProperties_scope')]",
					"events": [
						"Microsoft.Storage.BlobCreated"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/pipeline1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/trigger2')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "PL_booking",
							"type": "PipelineReference"
						},
						"parameters": {
							"pStartDate": "[parameters('trigger2_properties_PL_booking_parameters_pStartDate')]",
							"pEndDate": "[parameters('trigger2_properties_PL_booking_parameters_pEndDate')]"
						}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2025-08-27T07:07:00",
						"timeZone": "AUS Eastern Standard Time",
						"schedule": {
							"minutes": [
								10
							],
							"hours": [
								17
							]
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/PL_booking')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/IR-WSG-DAI-DEV')]",
			"type": "Microsoft.DataFactory/factories/integrationRuntimes",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "Australia Southeast",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 16,
							"timeToLive": 10,
							"cleanup": false,
							"customProperties": []
						},
						"pipelineExternalComputeScaleProperties": {
							"timeToLive": 60,
							"numberOfPipelineNodes": 1,
							"numberOfExternalNodes": 1
						}
					}
				},
				"managedVirtualNetwork": {
					"type": "ManagedVirtualNetworkReference",
					"referenceName": "default"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/credential1')]",
			"type": "Microsoft.DataFactory/factories/credentials",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "ManagedIdentity",
				"typeProperties": {
					"resourceId": "/subscriptions/5b3ec6fc-8a2e-445b-9899-02846ac57b46/resourcegroups/RG-WSG-DAI-DEV/providers/Microsoft.ManagedIdentity/userAssignedIdentities/UA-WSG-DEV"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/default')]",
			"type": "Microsoft.DataFactory/factories/managedVirtualNetworks",
			"apiVersion": "2018-06-01",
			"properties": {},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/default/AzureBlobStorage_sawsgdaidev')]",
			"type": "Microsoft.DataFactory/factories/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2018-06-01",
			"properties": {
				"privateLinkResourceId": "[parameters('AzureBlobStorage_sawsgdaidev_properties_privateLinkResourceId')]",
				"groupId": "[parameters('AzureBlobStorage_sawsgdaidev_properties_groupId')]"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/default/pe-sawsgdaidev')]",
			"type": "Microsoft.DataFactory/factories/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2018-06-01",
			"properties": {
				"privateLinkResourceId": "[parameters('pe-sawsgdaidev_properties_privateLinkResourceId')]",
				"groupId": "[parameters('pe-sawsgdaidev_properties_groupId')]"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/managedVirtualNetworks/default')]"
			]
		}
	]
}